
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="NovelDownloader: A toolkit for downloading and processing novels.">
      
      
        <meta name="author" content="Saudade Z">
      
      
      
        <link rel="prev" href="../parse_js_iife/">
      
      
        <link rel="next" href="../qidian_web/">
      
      
        
      
      
      <link rel="icon" href="../../assets/logo.svg">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.7.0">
    
    
      
        <title>Qidian App Analysis Notes - NovelDownloader</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.618322db.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.ab4e12ef.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&amp;display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../assets/_mkdocstrings.css">
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#app" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="NovelDownloader" class="md-header__button md-logo" aria-label="NovelDownloader" data-md-component="logo">
      
  <img src="../../assets/logo.svg" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            NovelDownloader
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Qidian App Analysis Notes
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-hidden="true"  type="radio" name="__palette" id="__palette_0">
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme="slate" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-hidden="true"  type="radio" name="__palette" id="__palette_1">
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
        <div class="md-search__suggest" data-md-component="search-suggest"></div>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
      <div class="md-header__source">
        <a href="https://github.com/saudadez21/novel-downloader" title="Go to repository" class="md-source" data-md-component="source" target="_blank" rel="noopener">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg>
  </div>
  <div class="md-source__repository">
    NovelDownloader
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
            
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../.." class="md-tabs__link">
        
  
  
    
  
  Home

      </a>
    </li>
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../guide/installation/" class="md-tabs__link">
          
  
  
    
  
  Guide

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../supported-sites/" class="md-tabs__link">
          
  
  
    
  
  Supported Sites

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../reference/api-examples/" class="md-tabs__link">
          
  
  
    
  
  Reference

        </a>
      </li>
    
  

      
        
  
  
  
    
  
  
    
    
      <li class="md-tabs__item md-tabs__item--active">
        <a href="../aes/" class="md-tabs__link">
          
  
  
    
  
  Notes

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../misc/todo/" class="md-tabs__link">
          
  
  
    
  
  Misc

        </a>
      </li>
    
  

      
    </ul>
  </div>
</nav>
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="NovelDownloader" class="md-nav__button md-logo" aria-label="NovelDownloader" data-md-component="logo">
      
  <img src="../../assets/logo.svg" alt="logo">

    </a>
    NovelDownloader
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/saudadez21/novel-downloader" title="Go to repository" class="md-source" data-md-component="source" target="_blank" rel="noopener">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg>
  </div>
  <div class="md-source__repository">
    NovelDownloader
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Home
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" >
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Guide
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            
  
    Guide
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../guide/installation/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Install
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../guide/configuration/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Configuration
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../guide/settings-reference/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Settings Reference
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../guide/processors-reference/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Processors Reference
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../guide/cli-examples/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    CLI Usage
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../guide/web-examples/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Web Usage
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../guide/file-saving/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    File Saving
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../guide/copy-cookies/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Copy Cookies
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
          
        
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../supported-sites/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    
  
    Supported Sites
  

    
  </span>
  
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_3" id="__nav_3_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            
  
    Supported Sites
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../supported-sites/tags/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Tags
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" >
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Reference
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            
  
    Reference
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../reference/api-examples/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    API Examples
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../reference/plugins/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Plugins
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
        
        
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5" checked>
        
          
          <label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    
  
    Notes
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            
  
    Notes
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../aes/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    AES Notes
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../duokan_epub/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Duokan EPUB Notes
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../faloo_web/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Faloo Web Notes
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../linovelib/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Linovelib Notes
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../parse_js_iife/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    JS IIFE Parsing Notes
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    
  
    Qidian App Notes
  

    
  </span>
  
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    
  
    Qidian App Notes
  

    
  </span>
  
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#_1" class="md-nav__link">
    <span class="md-ellipsis">
      
        一、起点客户端请求逻辑
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="一、起点客户端请求逻辑">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1-header" class="md-nav__link">
    <span class="md-ellipsis">
      
        1. Header 字段
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2" class="md-nav__link">
    <span class="md-ellipsis">
      
        2. 主要接口一览
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="2. 主要接口一览">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#21" class="md-nav__link">
    <span class="md-ellipsis">
      
        2.1 获取书籍基础信息
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#22" class="md-nav__link">
    <span class="md-ellipsis">
      
        2.2 获取未购买章节列表
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#23-id" class="md-nav__link">
    <span class="md-ellipsis">
      
        2.3 获取已购买章节 ID 列表
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#24" class="md-nav__link">
    <span class="md-ellipsis">
      
        2.4 获取彩蛋章节列表
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#25" class="md-nav__link">
    <span class="md-ellipsis">
      
        2.5 获取彩蛋章节内容
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#26" class="md-nav__link">
    <span class="md-ellipsis">
      
        2.6 下载章节内容
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="2.6 下载章节内容">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#vip" class="md-nav__link">
    <span class="md-ellipsis">
      
        VIP 章节下载
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_2" class="md-nav__link">
    <span class="md-ellipsis">
      
        安全下载
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_3" class="md-nav__link">
    <span class="md-ellipsis">
      
        批量下载
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#27" class="md-nav__link">
    <span class="md-ellipsis">
      
        2.7 获取书籍封面
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="2.7 获取书籍封面">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_4" class="md-nav__link">
    <span class="md-ellipsis">
      
        使用示例
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#qd" class="md-nav__link">
    <span class="md-ellipsis">
      
        二、*.qd 文件结构与内容解析
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="二、*.qd 文件结构与内容解析">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1" class="md-nav__link">
    <span class="md-ellipsis">
      
        1. 文件目录结构
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2-book_idqd" class="md-nav__link">
    <span class="md-ellipsis">
      
        2. {book_id}.qd 内容解析
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="2. {book_id}.qd 内容解析">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#21-header" class="md-nav__link">
    <span class="md-ellipsis">
      
        2.1 文件标头识别 (Header)
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#22_1" class="md-nav__link">
    <span class="md-ellipsis">
      
        2.2 数据库结构查看
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#23" class="md-nav__link">
    <span class="md-ellipsis">
      
        2.3 表数据采样
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3-chap_idqd" class="md-nav__link">
    <span class="md-ellipsis">
      
        3. {chap_id}.qd 内容解析
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="3. {chap_id}.qd 内容解析">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_5" class="md-nav__link">
    <span class="md-ellipsis">
      
        所用工具与依赖
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="所用工具与依赖">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_6" class="md-nav__link">
    <span class="md-ellipsis">
      
        逆向分析工具
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#python" class="md-nav__link">
    <span class="md-ellipsis">
      
        Python 依赖
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#31-adb" class="md-nav__link">
    <span class="md-ellipsis">
      
        3.1 ADB 连接设备
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#32-frida" class="md-nav__link">
    <span class="md-ellipsis">
      
        3.2 配置 Frida
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="3.2 配置 Frida">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_7" class="md-nav__link">
    <span class="md-ellipsis">
      
        检查设备架构
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_8" class="md-nav__link">
    <span class="md-ellipsis">
      
        安装与授权
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_9" class="md-nav__link">
    <span class="md-ellipsis">
      
        验证连接
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#33" class="md-nav__link">
    <span class="md-ellipsis">
      
        3.3 获取原生日志
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#34-frida-hook" class="md-nav__link">
    <span class="md-ellipsis">
      
        3.4 使用 Frida Hook 日志函数
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#35" class="md-nav__link">
    <span class="md-ellipsis">
      
        3.5 解密逻辑分析
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="3.5 解密逻辑分析">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#351-w-" class="md-nav__link">
    <span class="md-ellipsis">
      
        3.5.1 W 函数 -- 分段读取逻辑
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#python_1" class="md-nav__link">
    <span class="md-ellipsis">
      
        Python 等价实现
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#352-x-native" class="md-nav__link">
    <span class="md-ellipsis">
      
        3.5.2 x 函数 -- Native 解密流程
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#353-fockutilunlock" class="md-nav__link">
    <span class="md-ellipsis">
      
        3.5.3 fockUtil.unlock 函数
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../qidian_web/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Qidian Web Notes
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../xiguashuwu/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Xiguashuwu Notes
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6" >
        
          
          <label class="md-nav__link" for="__nav_6" id="__nav_6_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Misc
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6">
            <span class="md-nav__icon md-icon"></span>
            
  
    Misc
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../misc/todo/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    TODO
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#_1" class="md-nav__link">
    <span class="md-ellipsis">
      
        一、起点客户端请求逻辑
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="一、起点客户端请求逻辑">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1-header" class="md-nav__link">
    <span class="md-ellipsis">
      
        1. Header 字段
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2" class="md-nav__link">
    <span class="md-ellipsis">
      
        2. 主要接口一览
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="2. 主要接口一览">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#21" class="md-nav__link">
    <span class="md-ellipsis">
      
        2.1 获取书籍基础信息
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#22" class="md-nav__link">
    <span class="md-ellipsis">
      
        2.2 获取未购买章节列表
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#23-id" class="md-nav__link">
    <span class="md-ellipsis">
      
        2.3 获取已购买章节 ID 列表
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#24" class="md-nav__link">
    <span class="md-ellipsis">
      
        2.4 获取彩蛋章节列表
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#25" class="md-nav__link">
    <span class="md-ellipsis">
      
        2.5 获取彩蛋章节内容
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#26" class="md-nav__link">
    <span class="md-ellipsis">
      
        2.6 下载章节内容
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="2.6 下载章节内容">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#vip" class="md-nav__link">
    <span class="md-ellipsis">
      
        VIP 章节下载
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_2" class="md-nav__link">
    <span class="md-ellipsis">
      
        安全下载
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_3" class="md-nav__link">
    <span class="md-ellipsis">
      
        批量下载
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#27" class="md-nav__link">
    <span class="md-ellipsis">
      
        2.7 获取书籍封面
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="2.7 获取书籍封面">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_4" class="md-nav__link">
    <span class="md-ellipsis">
      
        使用示例
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#qd" class="md-nav__link">
    <span class="md-ellipsis">
      
        二、*.qd 文件结构与内容解析
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="二、*.qd 文件结构与内容解析">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1" class="md-nav__link">
    <span class="md-ellipsis">
      
        1. 文件目录结构
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2-book_idqd" class="md-nav__link">
    <span class="md-ellipsis">
      
        2. {book_id}.qd 内容解析
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="2. {book_id}.qd 内容解析">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#21-header" class="md-nav__link">
    <span class="md-ellipsis">
      
        2.1 文件标头识别 (Header)
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#22_1" class="md-nav__link">
    <span class="md-ellipsis">
      
        2.2 数据库结构查看
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#23" class="md-nav__link">
    <span class="md-ellipsis">
      
        2.3 表数据采样
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3-chap_idqd" class="md-nav__link">
    <span class="md-ellipsis">
      
        3. {chap_id}.qd 内容解析
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="3. {chap_id}.qd 内容解析">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_5" class="md-nav__link">
    <span class="md-ellipsis">
      
        所用工具与依赖
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="所用工具与依赖">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_6" class="md-nav__link">
    <span class="md-ellipsis">
      
        逆向分析工具
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#python" class="md-nav__link">
    <span class="md-ellipsis">
      
        Python 依赖
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#31-adb" class="md-nav__link">
    <span class="md-ellipsis">
      
        3.1 ADB 连接设备
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#32-frida" class="md-nav__link">
    <span class="md-ellipsis">
      
        3.2 配置 Frida
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="3.2 配置 Frida">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_7" class="md-nav__link">
    <span class="md-ellipsis">
      
        检查设备架构
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_8" class="md-nav__link">
    <span class="md-ellipsis">
      
        安装与授权
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_9" class="md-nav__link">
    <span class="md-ellipsis">
      
        验证连接
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#33" class="md-nav__link">
    <span class="md-ellipsis">
      
        3.3 获取原生日志
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#34-frida-hook" class="md-nav__link">
    <span class="md-ellipsis">
      
        3.4 使用 Frida Hook 日志函数
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#35" class="md-nav__link">
    <span class="md-ellipsis">
      
        3.5 解密逻辑分析
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="3.5 解密逻辑分析">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#351-w-" class="md-nav__link">
    <span class="md-ellipsis">
      
        3.5.1 W 函数 -- 分段读取逻辑
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#python_1" class="md-nav__link">
    <span class="md-ellipsis">
      
        Python 等价实现
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#352-x-native" class="md-nav__link">
    <span class="md-ellipsis">
      
        3.5.2 x 函数 -- Native 解密流程
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#353-fockutilunlock" class="md-nav__link">
    <span class="md-ellipsis">
      
        3.5.3 fockUtil.unlock 函数
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              
              <article class="md-content__inner md-typeset">
                
                  


  
    <a href="https://github.com/saudadez21/novel-downloader/edit/main/docs/notes/qidian_app.md" title="Edit this page" class="md-content__button md-icon" rel="edit noopener" target="_blank">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M10 20H6V4h7v5h5v3.1l2-2V8l-6-6H6c-1.1 0-2 .9-2 2v16c0 1.1.9 2 2 2h4zm10.2-7c.1 0 .3.1.4.2l1.3 1.3c.2.2.2.6 0 .8l-1 1-2.1-2.1 1-1c.1-.1.2-.2.4-.2m0 3.9L14.1 23H12v-2.1l6.1-6.1z"/></svg>
    </a>
  
  


<h1 id="app">起点小说 App 端分析笔记<a class="headerlink" href="#app" title="Permanent link">&para;</a></h1>
<p>创建日期: 2025/06/17</p>
<h2 id="_1">一、起点客户端请求逻辑<a class="headerlink" href="#_1" title="Permanent link">&para;</a></h2>
<h3 id="1-header">1. Header 字段<a class="headerlink" href="#1-header" title="Permanent link">&para;</a></h3>
<p>字段:</p>
<ul>
<li><code>borgus</code></li>
<li><code>cecelia</code></li>
<li><code>cookie</code><ul>
<li><code>ywguid</code></li>
<li><code>appId</code></li>
<li>...</li>
<li><code>QDInfo</code></li>
</ul>
</li>
<li><code>gorgon</code></li>
<li><code>ibex</code></li>
<li><code>qdinfo</code></li>
<li><code>qdsign</code></li>
<li><code>tstamp</code></li>
</ul>
<p>其中每次请求改变的值有:</p>
<ul>
<li><code>borgus</code></li>
<li><code>cecelia</code></li>
<li><code>cookie</code><ul>
<li><code>QDInfo</code></li>
</ul>
</li>
<li><code>ibex</code></li>
<li><code>qdinfo</code></li>
<li><code>qdsign</code></li>
<li><code>tstamp</code></li>
</ul>
<p>具体暂时不分析, 可能有用的参考资料:</p>
<ul>
<li><a href="https://blog.csdn.net/weixin_44110940/article/details/141091917" target="_blank" rel="noopener">iOS逆向记录</a><ul>
<li>没有详细过程</li>
</ul>
</li>
<li><a href="https://www.cnblogs.com/HugJun/p/13503215.html" target="_blank" rel="noopener">起点 App 字段加密破解_java</a><ul>
<li>2020-08-14</li>
<li>Java 版本</li>
<li>包含: <code>QDInfo</code>, <code>QDSign</code>, <code>AegisSign</code></li>
</ul>
</li>
<li><a href="https://www.jianshu.com/p/025bd308e857" target="_blank" rel="noopener">Android逆向入门: 某点中文app网络请求参数分析</a><ul>
<li>2020-08-05</li>
<li>包含: <code>QDInfo</code>, <code>QDSign</code>, <code>AegisSign</code></li>
<li><a href="https://www.52pojie.cn/thread-1239814-1-1.html" target="_blank" rel="noopener">备用连接</a></li>
</ul>
</li>
<li><a href="https://github.com/rwz657026189/QiDianHook" target="_blank" rel="noopener">QiDianHook</a><ul>
<li>2019-01-03</li>
<li>没试过</li>
</ul>
</li>
<li><a href="https://github.com/madking177/appspiderHook" target="_blank" rel="noopener">appspiderHook</a><ul>
<li>2023-12-11</li>
<li>包含一些 hook 函数</li>
</ul>
</li>
<li><a href="https://www.wangan.com/p/11v71355c0c48670" target="_blank" rel="noopener">frida复现某app算法</a><ul>
<li>2023-01-11</li>
<li>含过程</li>
</ul>
</li>
<li><a href="https://bbs.kanxue.com/thread-271070.htm" target="_blank" rel="noopener">某应用sign签名算法还原</a><ul>
<li>2022-1-7</li>
<li>含过程</li>
<li>包含: <code>QDSign</code></li>
</ul>
</li>
<li><a href="https://www.jianshu.com/p/58ec69e04983" target="_blank" rel="noopener">起点QDSign AegisSign逆向</a><ul>
<li>2022-01-12</li>
</ul>
</li>
<li><a href="https://bbs.125.la/forum.php?mod=viewthread&amp;tid=14053235" target="_blank" rel="noopener">起点中文网安卓APP超详细算法分析过程</a><ul>
<li>2017-8-8</li>
</ul>
</li>
</ul>
<p>注: 经过分析, 这些 header 字段应该主要是 <code>com.qidian.QDReader.component.util.FockUtil</code> 的 <code>addRetrofitH</code> 函数添加的</p>
<h3 id="2">2. 主要接口一览<a class="headerlink" href="#2" title="Permanent link">&para;</a></h3>
<h4 id="21">2.1 获取书籍基础信息<a class="headerlink" href="#21" title="Permanent link">&para;</a></h4>
<p><strong>功能</strong>: 查询某本书的详情。</p>
<p><strong>URL</strong></p>
<div class="highlight"><pre><span></span><code>GET https://druidv6.if.qidian.com/argus/api/v3/bookdetail/lookfor
</code></pre></div>
<p><strong>Query 参数</strong>:</p>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>含义</th>
</tr>
</thead>
<tbody>
<tr>
<td>bookId</td>
<td>int</td>
<td>是</td>
<td>起点书籍唯一 ID</td>
</tr>
<tr>
<td>isOutBook</td>
<td>int</td>
<td>否</td>
<td>是否为外部导入的书 (0/1)</td>
</tr>
</tbody>
</table>
<p><strong>示例 param</strong>:</p>
<div class="highlight"><pre><span></span><code><span class="p">{</span>
<span class="w">    </span><span class="nt">&quot;bookId&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">1234567</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;isOutBook&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span>
<span class="p">}</span>
</code></pre></div>
<h4 id="22">2.2 获取未购买章节列表<a class="headerlink" href="#22" title="Permanent link">&para;</a></h4>
<p><strong>功能</strong>: 拉取当前用户未购买章节及章节卡信息。</p>
<p><strong>URL</strong></p>
<div class="highlight"><pre><span></span><code>POST https://druidv6.if.qidian.com/argus/api/v2/subscription/getunboughtchapterlist
</code></pre></div>
<p><strong>Body 参数</strong>:</p>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>含义</th>
</tr>
</thead>
<tbody>
<tr>
<td>bookId</td>
<td>int</td>
<td>是</td>
<td>书籍 ID</td>
</tr>
<tr>
<td>pageSize</td>
<td>int</td>
<td>是</td>
<td>每页大小, 默认 99999</td>
</tr>
<tr>
<td>pageIndex</td>
<td>int</td>
<td>是</td>
<td>页码, 从 1 开始</td>
</tr>
</tbody>
</table>
<p><strong>示例 Body</strong>:</p>
<div class="highlight"><pre><span></span><code><span class="p">{</span>
<span class="w">    </span><span class="nt">&quot;bookId&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">1234567</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;pageSize&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">99999</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;pageIndex&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span>
<span class="p">}</span>
</code></pre></div>
<h4 id="23-id">2.3 获取已购买章节 ID 列表<a class="headerlink" href="#23-id" title="Permanent link">&para;</a></h4>
<p><strong>功能</strong>: 获取用户已购买的所有章节 ID, 便于本地校验缓存。</p>
<p><strong>URL</strong></p>
<div class="highlight"><pre><span></span><code>GET https://druidv6.if.qidian.com/argus/api/v3/chapterlist/chapterlist
</code></pre></div>
<p><strong>Query 参数</strong>:</p>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>含义</th>
</tr>
</thead>
<tbody>
<tr>
<td>bookId</td>
<td>int</td>
<td>是</td>
<td>书籍 ID</td>
</tr>
<tr>
<td>timeStamp</td>
<td>long</td>
<td>是</td>
<td>毫秒时间戳</td>
</tr>
<tr>
<td>requestSource</td>
<td>int</td>
<td>是</td>
<td>来源标识, 0=App 等</td>
</tr>
<tr>
<td>md5Signature</td>
<td>string</td>
<td>是</td>
<td>MD5</td>
</tr>
<tr>
<td>extendchapterIds</td>
<td>string</td>
<td>否</td>
<td>扩展查询章节 ID 列表</td>
</tr>
</tbody>
</table>
<p><strong><code>md5Signature</code> 计算说明</strong>:</p>
<p>将本地已存在的章节 ID 与对应的卷 ID 按阅读顺序用竖线拼接, 得到形如:</p>
<div class="highlight"><pre><span></span><code>cid1|vcode1|cid2|vcode2|...|cidN|vcodeN
</code></pre></div>
<p>对该字符串取 <code>MD5</code>, 结果即为 <code>md5Signature</code>。</p>
<p><strong>示例 param</strong>:</p>
<div class="highlight"><pre><span></span><code><span class="p">{</span>
<span class="w">    </span><span class="nt">&quot;bookId&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">1234567</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;timeStamp&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">1750000000000</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;requestSource&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;md5Signature&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;5f4dcc3b5aa765d61d8327deb882cf99&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;extendchapterIds&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;2345678,3456789&quot;</span>
<span class="p">}</span>
</code></pre></div>
<h4 id="24">2.4 获取彩蛋章节列表<a class="headerlink" href="#24" title="Permanent link">&para;</a></h4>
<p><strong>功能</strong>: 获取主线章节后面附带的「彩蛋」章节列表。</p>
<p><strong>URL</strong></p>
<div class="highlight"><pre><span></span><code>GET https://druidv6.if.qidian.com/argus/api/v1/midpage/book/chapters
</code></pre></div>
<p><strong>Query 参数</strong>: <code>bookId</code></p>
<p><strong>示例 param</strong>:</p>
<div class="highlight"><pre><span></span><code><span class="p">{</span>
<span class="w">    </span><span class="nt">&quot;bookId&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">1234567</span><span class="p">,</span>
<span class="p">}</span>
</code></pre></div>
<p><strong>示例返回</strong>:</p>
<div class="highlight"><pre><span></span><code><span class="p">{</span>
<span class="w">    </span><span class="nt">&quot;Data&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nt">&quot;Chapters&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span>
<span class="w">            </span><span class="p">{</span>
<span class="w">                </span><span class="nt">&quot;ChapterId&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">12345678</span><span class="p">,</span>
<span class="w">                </span><span class="nt">&quot;MidpageList&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span>
<span class="w">                    </span><span class="p">{</span><span class="nt">&quot;MidpageId&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">8888</span><span class="p">,</span><span class="w"> </span><span class="nt">&quot;MidpageName&quot;</span><span class="p">:</span><span class="s2">&quot;彩蛋1&quot;</span><span class="p">,</span><span class="nt">&quot;UpdateTime&quot;</span><span class="p">:</span><span class="mi">1686868686868</span><span class="p">},</span>
<span class="w">                    </span><span class="p">{</span><span class="nt">&quot;MidpageId&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">9999</span><span class="p">,</span><span class="w"> </span><span class="nt">&quot;MidpageName&quot;</span><span class="p">:</span><span class="s2">&quot;彩蛋2&quot;</span><span class="p">,</span><span class="nt">&quot;UpdateTime&quot;</span><span class="p">:</span><span class="mi">1686868687878</span><span class="p">}</span>
<span class="w">                </span><span class="p">]</span>
<span class="w">            </span><span class="p">}</span>
<span class="w">        </span><span class="p">]</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div>
<p><strong>字段说明</strong></p>
<ul>
<li><code>MidpageList</code> 中 <code>UpdateTime</code> 为 UTC 毫秒。</li>
<li>可据此在本地拼接阅读顺序。</li>
</ul>
<h4 id="25">2.5 获取彩蛋章节内容<a class="headerlink" href="#25" title="Permanent link">&para;</a></h4>
<p><strong>功能</strong>: 获取「彩蛋」章节内容。</p>
<p><strong>URL</strong></p>
<div class="highlight"><pre><span></span><code>GET https://druidv6.if.qidian.com/argus/api/v3/midpage/pageinfo
</code></pre></div>
<p><strong>Query 参数</strong>:</p>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>必选</th>
<th>含义</th>
</tr>
</thead>
<tbody>
<tr>
<td>bookId</td>
<td>int</td>
<td>是</td>
<td>书籍 ID</td>
</tr>
<tr>
<td>chapterId</td>
<td>int</td>
<td>是</td>
<td>章节 ID</td>
</tr>
<tr>
<td>needAdv</td>
<td>int</td>
<td>是</td>
<td>默认 0</td>
</tr>
</tbody>
</table>
<p><strong>示例 param</strong>:</p>
<div class="highlight"><pre><span></span><code><span class="p">{</span>
<span class="w">    </span><span class="nt">&quot;bookId&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">1234567</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;chapterId&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">12345678</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;needAdv&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span>
<span class="p">}</span>
</code></pre></div>
<h4 id="26">2.6 下载章节内容<a class="headerlink" href="#26" title="Permanent link">&para;</a></h4>
<h5 id="vip">VIP 章节下载<a class="headerlink" href="#vip" title="Permanent link">&para;</a></h5>
<p><strong>URL</strong></p>
<div class="highlight"><pre><span></span><code>POST https://druidv6.if.qidian.com/argus/api/v4/bookcontent/getvipcontent
</code></pre></div>
<p><strong>Body</strong>:</p>
<table>
<thead>
<tr>
<th>字段</th>
<th>含义</th>
</tr>
</thead>
<tbody>
<tr>
<td>b</td>
<td>bookId</td>
</tr>
<tr>
<td>c</td>
<td>chapterId</td>
</tr>
<tr>
<td>ui</td>
<td>不确定</td>
</tr>
<tr>
<td>b-string</td>
<td>加密包标识</td>
</tr>
</tbody>
</table>
<p><strong>示例 Body</strong>:</p>
<div class="highlight"><pre><span></span><code><span class="p">{</span>
<span class="w">    </span><span class="nt">&quot;b-string&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;b&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">1234567</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;c&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">555555</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;ui&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span>
<span class="p">}</span>
</code></pre></div>
<h5 id="_2">安全下载<a class="headerlink" href="#_2" title="Permanent link">&para;</a></h5>
<p><strong>URL</strong></p>
<div class="highlight"><pre><span></span><code>GET https://druidv6.if.qidian.com/argus/api/v2/bookcontent/safegetcontent
</code></pre></div>
<p><strong>Query</strong>: <code>bookId</code>, <code>chapterId</code></p>
<p><strong>示例 param</strong>:</p>
<div class="highlight"><pre><span></span><code><span class="p">{</span>
<span class="w">    </span><span class="nt">&quot;bookId&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">1234567</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;chapterId&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">555555</span><span class="p">,</span>
<span class="p">}</span>
</code></pre></div>
<h5 id="_3">批量下载<a class="headerlink" href="#_3" title="Permanent link">&para;</a></h5>
<p><strong>URL</strong></p>
<div class="highlight"><pre><span></span><code>POST https://druidv6.if.qidian.com/argus/newapi/v1/bookcontent/getcontentbatch
</code></pre></div>
<p><strong>Body</strong>:</p>
<div class="highlight"><pre><span></span><code><span class="p">{</span>
<span class="w">    </span><span class="nt">&quot;b&quot;</span><span class="p">:</span><span class="mi">1234567</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;c&quot;</span><span class="p">:</span><span class="s2">&quot;555,222,333,444,666,888&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;useImei&quot;</span><span class="p">:</span><span class="mi">0</span>
<span class="p">}</span>
</code></pre></div>
<p><strong>返回</strong>包含 <code>DownloadUrl</code>、<code>Key</code>、<code>Md5</code>、<code>Size</code>, 需后续 GET COS 链接下载 ZIP, 然后解包。</p>
<p>注意: <code>DownloadUrl</code> 是加密状态需要使用 <code>Fock</code> 的 <code>unlock</code> 进行解密</p>
<details>
<summary>相关函数 (点击展开)</summary>

<div class="highlight"><pre><span></span><code><span class="c1">// 调用:</span>
<span class="n">unLockContent</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">qDChapterBatchDownloadLoader</span><span class="p">.</span><span class="na">unLockContent</span><span class="p">(</span><span class="n">qDChapterBatchDownloadLoader</span><span class="p">.</span><span class="na">getBookId</span><span class="p">(),</span><span class="w"> </span><span class="n">key</span><span class="p">,</span><span class="w"> </span><span class="n">downloadUrl</span><span class="p">);</span>
</code></pre></div>

`qDChapterBatchDownloadLoader.unLockContent`:

<div class="highlight"><pre><span></span><code><span class="kd">public</span><span class="w"> </span><span class="kd">final</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="nf">unLockContent</span><span class="p">(</span><span class="kt">long</span><span class="w"> </span><span class="n">j10</span><span class="p">,</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="n">str</span><span class="p">,</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="n">str2</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">str2</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="kc">null</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="n">str2</span><span class="p">.</span><span class="na">length</span><span class="p">()</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="s">&quot;&quot;</span><span class="p">;</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">    </span><span class="n">String</span><span class="w"> </span><span class="n">valueOf</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">String</span><span class="p">.</span><span class="na">valueOf</span><span class="p">(</span><span class="n">j10</span><span class="p">);</span>
<span class="w">    </span><span class="n">String</span><span class="w"> </span><span class="n">str3</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;BatchChapterCos_&quot;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">j10</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s">&quot;_&quot;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">str</span><span class="p">;</span>
<span class="w">    </span><span class="n">FockUtil</span><span class="w"> </span><span class="n">fockUtil</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">FockUtil</span><span class="p">.</span><span class="na">INSTANCE</span><span class="p">;</span>
<span class="w">    </span><span class="n">Fock</span><span class="p">.</span><span class="na">FockResult</span><span class="w"> </span><span class="n">unlock</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">fockUtil</span><span class="p">.</span><span class="na">unlock</span><span class="p">(</span><span class="n">str2</span><span class="p">,</span><span class="w"> </span><span class="n">valueOf</span><span class="p">,</span><span class="w"> </span><span class="n">str3</span><span class="p">);</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">unlock</span><span class="p">.</span><span class="na">status</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">Fock</span><span class="p">.</span><span class="na">FockResult</span><span class="p">.</span><span class="na">STATUS_EMPTY_USER_KEY</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">Fock</span><span class="p">.</span><span class="na">setup</span><span class="p">(</span><span class="n">we</span><span class="p">.</span><span class="na">d</span><span class="p">.</span><span class="na">X</span><span class="p">());</span>
<span class="w">        </span><span class="n">unlock</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">fockUtil</span><span class="p">.</span><span class="na">unlock</span><span class="p">(</span><span class="n">str2</span><span class="p">,</span><span class="w"> </span><span class="n">valueOf</span><span class="p">,</span><span class="w"> </span><span class="n">str3</span><span class="p">);</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">unlock</span><span class="p">.</span><span class="na">status</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="s">&quot;&quot;</span><span class="p">;</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">    </span><span class="kt">byte</span><span class="o">[]</span><span class="w"> </span><span class="n">bArr</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">unlock</span><span class="p">.</span><span class="na">data</span><span class="p">;</span>
<span class="w">    </span><span class="n">kotlin</span><span class="p">.</span><span class="na">jvm</span><span class="p">.</span><span class="na">internal</span><span class="p">.</span><span class="na">o</span><span class="p">.</span><span class="na">d</span><span class="p">(</span><span class="n">bArr</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;unlockResult.data&quot;</span><span class="p">);</span>
<span class="w">    </span><span class="n">Charset</span><span class="w"> </span><span class="n">UTF_8</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">StandardCharsets</span><span class="p">.</span><span class="na">UTF_8</span><span class="p">;</span>
<span class="w">    </span><span class="n">kotlin</span><span class="p">.</span><span class="na">jvm</span><span class="p">.</span><span class="na">internal</span><span class="p">.</span><span class="na">o</span><span class="p">.</span><span class="na">d</span><span class="p">(</span><span class="n">UTF_8</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;UTF_8&quot;</span><span class="p">);</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">String</span><span class="p">(</span><span class="n">bArr</span><span class="p">,</span><span class="w"> </span><span class="n">UTF_8</span><span class="p">);</span>
<span class="p">}</span>
</code></pre></div>

</details>

<h4 id="27">2.7 获取书籍封面<a class="headerlink" href="#27" title="Permanent link">&para;</a></h4>
<p>支持两种图片格式: WebP 和 JPEG。</p>
<p>请将以下 URL 中的占位符替换为实际值:</p>
<ul>
<li><strong><code>{book_id}</code></strong>: 书籍的唯一 ID</li>
<li><strong><code>{width}</code></strong>: 封面宽度, 单位为像素, 可选值: <code>90</code>、<code>150</code>、<code>180</code>、<code>300</code>、<code>600</code></li>
</ul>
<p><strong>WebP 格式</strong></p>
<div class="highlight"><pre><span></span><code>https://bookcover.yuewen.com/qdbimg/349573/{book_id}/{width}.webp
</code></pre></div>
<p><strong>JPEG 格式</strong></p>
<div class="highlight"><pre><span></span><code>https://bookcover.yuewen.com/qdbimg/349573/{book_id}/{width}
</code></pre></div>
<h5 id="_4">使用示例<a class="headerlink" href="#_4" title="Permanent link">&para;</a></h5>
<p>获取 <code>book_id = 123456</code>, 宽度为 <code>300px</code> 的 WebP 封面:</p>
<div class="highlight"><pre><span></span><code>https://bookcover.yuewen.com/qdbimg/349573/123456/300.webp
</code></pre></div>
<p>获取同一书籍的 JPEG 封面:</p>
<div class="highlight"><pre><span></span><code>https://bookcover.yuewen.com/qdbimg/349573/123456/300
</code></pre></div>
<hr />
<h2 id="qd">二、<code>*.qd</code> 文件结构与内容解析<a class="headerlink" href="#qd" title="Permanent link">&para;</a></h2>
<h3 id="1">1. 文件目录结构<a class="headerlink" href="#1" title="Permanent link">&para;</a></h3>
<p><code>*.qd</code> 文件主要用于存储起点 App 的本地缓存数据, 安卓端位于以下路径:</p>
<div class="highlight"><pre><span></span><code>/data/media/0/Android/data/com.qidian.QDReader/files/QDReader/book/<span class="o">{</span>user_id<span class="o">}</span>/
</code></pre></div>
<p>或</p>
<div class="highlight"><pre><span></span><code>/sdcard/Android/data/com.qidian.QDReader/files/QDReader/book/<span class="o">{</span>user_id<span class="o">}</span>/
</code></pre></div>
<p>或</p>
<div class="highlight"><pre><span></span><code>/storage/emulated/0/Android/data/com.qidian.QDReader/files/QDReader/book/<span class="o">{</span>user_id<span class="o">}</span>/
</code></pre></div>
<p>该目录结构如下所示:</p>
<div class="highlight"><pre><span></span><code><span class="o">{</span>user_id<span class="o">}</span>/
│
├──<span class="w"> </span><span class="o">{</span>book_id<span class="o">}</span>.qd<span class="w">               </span><span class="c1"># 书籍的元信息</span>
│
└──<span class="w"> </span><span class="o">{</span>book_id<span class="o">}</span>/<span class="w">                 </span><span class="c1"># 子目录, 按章节存储内容</span>
<span class="w">    </span>├──<span class="w"> </span><span class="o">{</span>chap_id<span class="o">}</span>.qd<span class="w">           </span><span class="c1"># 章节的数据文件</span>
<span class="w">    </span>├──<span class="w"> </span><span class="o">{</span>chap_id<span class="o">}</span>.qd
<span class="w">    </span>└──<span class="w"> </span>...
</code></pre></div>
<p>以下分析基于示例代码:</p>
<div class="highlight"><pre><span></span><code><span class="kn">from</span><span class="w"> </span><span class="nn">pathlib</span><span class="w"> </span><span class="kn">import</span> <span class="n">Path</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">pprint</span><span class="w"> </span><span class="kn">import</span> <span class="n">pprint</span>

<span class="n">book_id</span> <span class="o">=</span> <span class="s2">&quot;123456&quot;</span>
<span class="n">metadata_path</span> <span class="o">=</span> <span class="n">Path</span><span class="o">.</span><span class="n">cwd</span><span class="p">()</span> <span class="o">/</span> <span class="s2">&quot;data&quot;</span> <span class="o">/</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">book_id</span><span class="si">}</span><span class="s2">.qd&quot;</span>
<span class="n">chap_dir</span> <span class="o">=</span> <span class="n">Path</span><span class="o">.</span><span class="n">cwd</span><span class="p">()</span> <span class="o">/</span> <span class="s2">&quot;data&quot;</span> <span class="o">/</span> <span class="n">book_id</span>
</code></pre></div>
<h3 id="2-book_idqd">2. <code>{book_id}.qd</code> 内容解析<a class="headerlink" href="#2-book_idqd" title="Permanent link">&para;</a></h3>
<h4 id="21-header">2.1 文件标头识别 (Header)<a class="headerlink" href="#21-header" title="Permanent link">&para;</a></h4>
<p>读取前 16 个字节用于识别文件格式:</p>
<div class="highlight"><pre><span></span><code><span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">metadata_path</span><span class="p">,</span> <span class="s2">&quot;rb&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
    <span class="n">header</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="mi">16</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">header</span><span class="p">)</span>
</code></pre></div>
<p>输出:</p>
<div class="highlight"><pre><span></span><code>b<span class="s1">&#39;SQLite format 3\x00&#39;</span>
</code></pre></div>
<p>文件为 SQLite 3 格式数据库</p>
<h4 id="22_1">2.2 数据库结构查看<a class="headerlink" href="#22_1" title="Permanent link">&para;</a></h4>
<p>通过 SQLite3 库查询数据库中包含的表:</p>
<div class="highlight"><pre><span></span><code><span class="kn">import</span><span class="w"> </span><span class="nn">sqlite3</span>

<span class="n">conn</span> <span class="o">=</span> <span class="n">sqlite3</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">metadata_path</span><span class="p">)</span>
<span class="n">query</span> <span class="o">=</span> <span class="s2">&quot;SELECT name FROM sqlite_master WHERE type=&#39;table&#39;;&quot;</span>

<span class="n">cursor</span> <span class="o">=</span> <span class="n">conn</span><span class="o">.</span><span class="n">cursor</span><span class="p">()</span>
<span class="n">cursor</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">query</span><span class="p">)</span>
<span class="n">tables</span> <span class="o">=</span> <span class="n">cursor</span><span class="o">.</span><span class="n">fetchall</span><span class="p">()</span>
<span class="n">pprint</span><span class="p">(</span><span class="n">tables</span><span class="p">)</span>

<span class="n">conn</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</code></pre></div>
<p>输出示例:</p>
<div class="highlight"><pre><span></span><code><span class="o">[(</span><span class="s1">&#39;chapter&#39;</span>,<span class="o">)</span>,
<span class="w"> </span><span class="o">(</span><span class="s1">&#39;volume&#39;</span>,<span class="o">)</span>,
<span class="w"> </span><span class="o">(</span><span class="s1">&#39;bookmark&#39;</span>,<span class="o">)</span>,
<span class="w"> </span><span class="o">(</span><span class="s1">&#39;sqlite_sequence&#39;</span>,<span class="o">)</span>,
<span class="w"> </span><span class="o">(</span><span class="s1">&#39;new_markline&#39;</span>,<span class="o">)</span>,
<span class="w"> </span><span class="o">(</span><span class="s1">&#39;chapterExtraInfo&#39;</span>,<span class="o">)]</span>
</code></pre></div>
<h4 id="23">2.3 表数据采样<a class="headerlink" href="#23" title="Permanent link">&para;</a></h4>
<p>获取各表中前几条数据作为示例:</p>
<div class="highlight"><pre><span></span><code><span class="n">conn</span> <span class="o">=</span> <span class="n">sqlite3</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">metadata_path</span><span class="p">)</span>
<span class="n">cursor</span> <span class="o">=</span> <span class="n">conn</span><span class="o">.</span><span class="n">cursor</span><span class="p">()</span>

<span class="n">table_previews</span> <span class="o">=</span> <span class="p">{}</span>

<span class="k">for</span> <span class="p">(</span><span class="n">table_name</span><span class="p">,)</span> <span class="ow">in</span> <span class="n">tables</span><span class="p">:</span>
    <span class="n">cursor</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;SELECT * FROM </span><span class="si">{</span><span class="n">table_name</span><span class="si">}</span><span class="s2"> LIMIT 2;&quot;</span><span class="p">)</span>
    <span class="n">rows</span> <span class="o">=</span> <span class="n">cursor</span><span class="o">.</span><span class="n">fetchall</span><span class="p">()</span>
    <span class="n">table_previews</span><span class="p">[</span><span class="n">table_name</span><span class="p">]</span> <span class="o">=</span> <span class="n">rows</span>

<span class="n">conn</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>

<span class="n">pprint</span><span class="p">(</span><span class="n">table_previews</span><span class="p">)</span>
</code></pre></div>
<hr />
<h3 id="3-chap_idqd">3. <code>{chap_id}.qd</code> 内容解析<a class="headerlink" href="#3-chap_idqd" title="Permanent link">&para;</a></h3>
<blockquote>
<p>声明: 本文为笔者首次尝试进行 Android 应用的逆向分析, 相关方法和思路均基于个人现阶段理解, 主要目的在于探索学习。部分手段可能存在更优或更规范的实现方式, 欢迎指正与交流。</p>
</blockquote>
<h4 id="_5">所用工具与依赖<a class="headerlink" href="#_5" title="Permanent link">&para;</a></h4>
<p>用于分析和提取章节 <code>.qd</code> 文件内容, 涉及以下工具与库:</p>
<h5 id="_6">逆向分析工具<a class="headerlink" href="#_6" title="Permanent link">&para;</a></h5>
<ul>
<li><a href="https://github.com/skylot/jadx/releases" target="_blank" rel="noopener"><code>jadx</code></a>: 用于反编译 APK, 提取 Java 层逻辑</li>
<li><a href="https://github.com/NationalSecurityAgency/ghidra/releases" target="_blank" rel="noopener"><code>Ghidra</code></a>: 静态分析原生库 (如 <code>.so</code> 文件)</li>
<li><a href="https://hex-rays.com/ida-pro/" target="_blank" rel="noopener"><code>IDA Pro</code></a>: 反汇编工具, 用于静态分析本地代码</li>
<li><a href="https://developer.android.com/tools/releases/platform-tools" target="_blank" rel="noopener"><code>Android Platform Tools (adb)</code></a>: 用于连接调试设备</li>
<li><a href="https://github.com/frida/frida" target="_blank" rel="noopener"><code>Frida</code></a>: 动态插桩与函数 Hook, 辅助定位或调用加密逻辑</li>
</ul>
<h5 id="python">Python 依赖<a class="headerlink" href="#python" title="Permanent link">&para;</a></h5>
<ul>
<li><code>frida==16.7.19</code> 与 <code>frida-tools==13.7.1</code><ul>
<li>版本 17.x 及以上目前暂时存在 Java 环境问题, 需要手动处理</li>
<li>相关讨论见: <a href="https://github.com/frida/frida/issues/3473" target="_blank" rel="noopener">Java is not defiend</a></li>
</ul>
</li>
<li><code>pycryptodome</code><ul>
<li>加解密算法库</li>
</ul>
</li>
</ul>
<h4 id="31-adb">3.1 ADB 连接设备<a class="headerlink" href="#31-adb" title="Permanent link">&para;</a></h4>
<p>通过 ADB 与目标设备建立连接:</p>
<div class="highlight"><pre><span></span><code>adb<span class="w"> </span>connect<span class="w"> </span>&lt;device-ip&gt;
</code></pre></div>
<p>可使用 <code>adb devices</code> 验证连接状态</p>
<h4 id="32-frida">3.2 配置 <code>Frida</code><a class="headerlink" href="#32-frida" title="Permanent link">&para;</a></h4>
<h5 id="_7">检查设备架构<a class="headerlink" href="#_7" title="Permanent link">&para;</a></h5>
<p>使用以下命令确认设备架构:</p>
<div class="highlight"><pre><span></span><code>adb<span class="w"> </span>shell<span class="w"> </span>getprop<span class="w"> </span>ro.product.cpu.abi
</code></pre></div>
<p>常见返回值包括:</p>
<ul>
<li><code>x86</code></li>
<li><code>x86_64</code></li>
<li><code>arm64-v8a</code></li>
</ul>
<p>根据架构与所用 Frida Python 版本, 从 <a href="https://github.com/frida/frida/releases" target="_blank" rel="noopener">Frida Releases</a> 下载对应的 <code>frida-server</code>, 例如:</p>
<div class="highlight"><pre><span></span><code>frida-server-16.7.19-android-x86.xz
</code></pre></div>
<h5 id="_8">安装与授权<a class="headerlink" href="#_8" title="Permanent link">&para;</a></h5>
<p>解压后将可执行文件推送到设备 (这里解压后重命名为 <code>frida-server-16.7.19</code>)</p>
<div class="highlight"><pre><span></span><code>adb<span class="w"> </span>push<span class="w"> </span>frida-server-16.7.19<span class="w"> </span>/data/local/tmp/
adb<span class="w"> </span>shell<span class="w"> </span><span class="s2">&quot;chmod 755 /data/local/tmp/frida-server-16.7.19&quot;</span>
</code></pre></div>
<p>启动服务 (需要 <code>root</code> 权限):</p>
<div class="highlight"><pre><span></span><code>adb<span class="w"> </span>shell
su
/data/local/tmp/frida-server-16.7.19<span class="w"> </span><span class="p">&amp;</span>
</code></pre></div>
<h5 id="_9">验证连接<a class="headerlink" href="#_9" title="Permanent link">&para;</a></h5>
<p>在电脑终端使用以下命令列出设备进程, 确认 Frida 服务启动成功:</p>
<div class="highlight"><pre><span></span><code>frida-ps<span class="w"> </span>-U
</code></pre></div>
<p>若成功, 可看到设备进程列表, 其中起点对应为:</p>
<ul>
<li><code>起点读书</code></li>
<li><code>com.qidian.QDReader</code></li>
</ul>
<h4 id="33">3.3 获取原生日志<a class="headerlink" href="#33" title="Permanent link">&para;</a></h4>
<p>为便于后续排查信息, 这里全量导出 <code>logcat</code> 日志:</p>
<div class="highlight"><pre><span></span><code>adb<span class="w"> </span>logcat<span class="w"> </span>&gt;<span class="w"> </span>logs.txt
</code></pre></div>
<p>后续配合关键字筛查</p>
<h4 id="34-frida-hook">3.4 使用 Frida Hook 日志函数<a class="headerlink" href="#34-frida-hook" title="Permanent link">&para;</a></h4>
<blockquote>
<p><strong>说明</strong>:</p>
<p>下述方法仅用于演示如何通过 Hook 日志接口来获取 <strong>App 的原始日志</strong>。</p>
<p><strong>在后续的实际分析流程中并未使用到该方法</strong>, 这里只是提出一种可选的调试手段, 便于在必要时辅助排查部分流程。</p>
</blockquote>
<p>在后续分析中, 通过 <code>jadx</code> 反编译发现该应用采用了腾讯开源的 <a href="https://github.com/Tencent/Mars" target="_blank" rel="noopener">Mars</a> 框架中的 <code>xlog</code> 模块进行日志输出。</p>
<p>为了捕获应用在加密前输出的原始调试信息, 可使用 Frida 编写脚本, Hook <code>Xlog</code> 类中的日志打印方法, 实现实时日志拦截:</p>
<details>
<summary>`hook_xlog.js` (点击展开)</summary>

<div class="highlight"><pre><span></span><code><span class="nx">Java</span><span class="p">.</span><span class="nx">perform</span><span class="p">(</span><span class="kd">function</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">Xlog</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">Java</span><span class="p">.</span><span class="nx">use</span><span class="p">(</span><span class="s2">&quot;com.tencent.mars.xlog.Xlog&quot;</span><span class="p">);</span>

<span class="w">    </span><span class="kd">function</span><span class="w"> </span><span class="nx">hookLog</span><span class="p">(</span><span class="nx">level</span><span class="p">,</span><span class="w"> </span><span class="nx">method</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="nx">Xlog</span><span class="p">[</span><span class="nx">method</span><span class="p">])</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">&quot;Method not found:&quot;</span><span class="p">,</span><span class="w"> </span><span class="nx">method</span><span class="p">);</span>
<span class="w">            </span><span class="k">return</span><span class="p">;</span>
<span class="w">        </span><span class="p">}</span>

<span class="w">        </span><span class="nx">Xlog</span><span class="p">[</span><span class="nx">method</span><span class="p">].</span><span class="nx">overload</span><span class="p">(</span><span class="s1">&#39;java.lang.String&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;java.lang.String&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;java.lang.String&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;int&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;int&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;long&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;long&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;java.lang.String&#39;</span><span class="p">)</span>
<span class="w">            </span><span class="p">.</span><span class="nx">implementation</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kd">function</span><span class="w"> </span><span class="p">(</span><span class="nx">tag</span><span class="p">,</span><span class="w"> </span><span class="nx">filename</span><span class="p">,</span><span class="w"> </span><span class="nx">funcname</span><span class="p">,</span><span class="w"> </span><span class="nx">line</span><span class="p">,</span><span class="w"> </span><span class="nx">pid</span><span class="p">,</span><span class="w"> </span><span class="nx">tid</span><span class="p">,</span><span class="w"> </span><span class="nx">maintid</span><span class="p">,</span><span class="w"> </span><span class="nx">msg</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">                </span><span class="kd">const</span><span class="w"> </span><span class="nx">fullMsg</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="sb">`[</span><span class="si">${</span><span class="nx">level</span><span class="si">}</span><span class="sb">][</span><span class="si">${</span><span class="nx">tag</span><span class="si">}</span><span class="sb">] </span><span class="si">${</span><span class="nx">msg</span><span class="si">}</span><span class="sb">`</span><span class="p">;</span>
<span class="w">                </span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">fullMsg</span><span class="p">);</span>
<span class="w">                </span><span class="k">return</span><span class="w"> </span><span class="k">this</span><span class="p">[</span><span class="nx">method</span><span class="p">](</span><span class="nx">tag</span><span class="p">,</span><span class="w"> </span><span class="nx">filename</span><span class="p">,</span><span class="w"> </span><span class="nx">funcname</span><span class="p">,</span><span class="w"> </span><span class="nx">line</span><span class="p">,</span><span class="w"> </span><span class="nx">pid</span><span class="p">,</span><span class="w"> </span><span class="nx">tid</span><span class="p">,</span><span class="w"> </span><span class="nx">maintid</span><span class="p">,</span><span class="w"> </span><span class="nx">msg</span><span class="p">);</span>
<span class="w">            </span><span class="p">};</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="nx">hookLog</span><span class="p">(</span><span class="s2">&quot;V&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;logV&quot;</span><span class="p">);</span>
<span class="w">    </span><span class="nx">hookLog</span><span class="p">(</span><span class="s2">&quot;D&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;logD&quot;</span><span class="p">);</span>
<span class="w">    </span><span class="nx">hookLog</span><span class="p">(</span><span class="s2">&quot;I&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;logI&quot;</span><span class="p">);</span>
<span class="w">    </span><span class="nx">hookLog</span><span class="p">(</span><span class="s2">&quot;W&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;logW&quot;</span><span class="p">);</span>
<span class="w">    </span><span class="nx">hookLog</span><span class="p">(</span><span class="s2">&quot;E&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;logE&quot;</span><span class="p">);</span>
<span class="p">});</span>
</code></pre></div>
</details>

<p>执行 Hook:</p>
<div class="highlight"><pre><span></span><code>frida<span class="w"> </span>-U<span class="w"> </span>-n<span class="w"> </span>起点读书<span class="w"> </span>-l<span class="w"> </span>hook_xlog.js
</code></pre></div>
<h4 id="35">3.5 解密逻辑分析<a class="headerlink" href="#35" title="Permanent link">&para;</a></h4>
<p>APK 解包后, 可使用 <code>jadx</code> 反编译并定位到 <code>com/qidian/QDReader/component/bll</code> 包中的核心方法</p>
<details class="note">
<summary>核心解密函数 (点击展开)</summary>
<div class="highlight"><pre><span></span><code><span class="kd">public</span><span class="w"> </span><span class="kd">static</span><span class="w"> </span><span class="n">ChapterContentItem</span><span class="w"> </span><span class="nf">H</span><span class="p">(</span><span class="kt">long</span><span class="w"> </span><span class="n">j10</span><span class="p">,</span><span class="w"> </span><span class="n">ChapterItem</span><span class="w"> </span><span class="n">chapterItem</span><span class="p">)</span><span class="w"> </span><span class="kd">throws</span><span class="w"> </span><span class="n">Throwable</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kt">long</span><span class="w"> </span><span class="n">j11</span><span class="p">;</span>
<span class="w">    </span><span class="kt">byte</span><span class="o">[]</span><span class="w"> </span><span class="n">bArr</span><span class="p">;</span>
<span class="w">    </span><span class="n">JSONObject</span><span class="w"> </span><span class="n">jSONObject</span><span class="p">;</span>
<span class="w">    </span><span class="n">String</span><span class="w"> </span><span class="n">strEncode</span><span class="p">;</span>
<span class="w">    </span><span class="kt">long</span><span class="w"> </span><span class="n">jCurrentTimeMillis</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">System</span><span class="p">.</span><span class="na">currentTimeMillis</span><span class="p">();</span>
<span class="w">    </span><span class="n">ChapterContentItem</span><span class="w"> </span><span class="n">chapterContentItem</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">ChapterContentItem</span><span class="p">();</span>
<span class="w">    </span><span class="n">String</span><span class="w"> </span><span class="n">strF</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">F</span><span class="p">(</span><span class="n">j10</span><span class="p">,</span><span class="w"> </span><span class="n">chapterItem</span><span class="p">);</span>
<span class="w">    </span><span class="n">File</span><span class="w"> </span><span class="n">file</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">File</span><span class="p">(</span><span class="n">strF</span><span class="p">);</span>
<span class="w">    </span><span class="n">d</span><span class="w"> </span><span class="n">dVarW</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">W</span><span class="p">(</span><span class="n">file</span><span class="p">,</span><span class="w"> </span><span class="n">chapterItem</span><span class="p">);</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">dVarW</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="kc">null</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">h0</span><span class="p">(</span><span class="s">&quot;OKR_chapter_vip_null&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">String</span><span class="p">.</span><span class="na">valueOf</span><span class="p">(</span><span class="n">j10</span><span class="p">),</span><span class="w"> </span><span class="n">String</span><span class="p">.</span><span class="na">valueOf</span><span class="p">(</span><span class="n">chapterItem</span><span class="p">.</span><span class="na">ChapterId</span><span class="p">),</span><span class="w"> </span><span class="n">String</span><span class="p">.</span><span class="na">valueOf</span><span class="p">(</span><span class="o">-</span><span class="mi">20076</span><span class="p">),</span><span class="w"> </span><span class="s">&quot;chapter data is null&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;&quot;</span><span class="p">);</span>
<span class="w">        </span><span class="n">chapterContentItem</span><span class="p">.</span><span class="na">setErrorCode</span><span class="p">(</span><span class="o">-</span><span class="mi">20076</span><span class="p">);</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">chapterContentItem</span><span class="p">;</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">    </span><span class="kt">byte</span><span class="o">[][]</span><span class="w"> </span><span class="n">bArr2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dVarW</span><span class="p">.</span><span class="na">f18975search</span><span class="p">;</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">bArr2</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="kc">null</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="n">bArr2</span><span class="p">.</span><span class="na">length</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">2</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">g0</span><span class="p">(</span><span class="s">&quot;OKR_chapter_vip_empty&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">j10</span><span class="p">,</span><span class="w"> </span><span class="n">chapterItem</span><span class="p">,</span><span class="w"> </span><span class="n">dVarW</span><span class="p">);</span>
<span class="w">        </span><span class="n">chapterContentItem</span><span class="p">.</span><span class="na">setErrorCode</span><span class="p">(</span><span class="o">-</span><span class="mi">20076</span><span class="p">);</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">chapterContentItem</span><span class="p">;</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">    </span><span class="kt">byte</span><span class="o">[]</span><span class="w"> </span><span class="n">bArr3</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bArr2</span><span class="o">[</span><span class="mi">0</span><span class="o">]</span><span class="p">;</span>
<span class="w">    </span><span class="kt">byte</span><span class="o">[]</span><span class="w"> </span><span class="n">bArr4</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bArr2</span><span class="o">[</span><span class="mi">1</span><span class="o">]</span><span class="p">;</span>
<span class="w">    </span><span class="kt">byte</span><span class="o">[]</span><span class="w"> </span><span class="n">bArr5</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bArr2</span><span class="o">[</span><span class="mi">2</span><span class="o">]</span><span class="p">;</span>
<span class="w">    </span><span class="kt">byte</span><span class="o">[]</span><span class="w"> </span><span class="n">bArr6</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bArr2</span><span class="o">[</span><span class="mi">3</span><span class="o">]</span><span class="p">;</span>
<span class="w">    </span><span class="kt">byte</span><span class="o">[]</span><span class="w"> </span><span class="n">bArr7</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bArr2</span><span class="o">[</span><span class="mi">4</span><span class="o">]</span><span class="p">;</span>
<span class="w">    </span><span class="kt">long</span><span class="w"> </span><span class="n">J</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">J</span><span class="p">(</span><span class="n">bArr3</span><span class="p">);</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">J</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">J</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">vi</span><span class="p">.</span><span class="na">judian</span><span class="p">.</span><span class="na">e</span><span class="p">().</span><span class="na">f</span><span class="p">())</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">chapterContentItem</span><span class="p">.</span><span class="na">setErrorCode</span><span class="p">(</span><span class="o">-</span><span class="mi">20067</span><span class="p">);</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">chapterContentItem</span><span class="p">;</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">    </span><span class="kt">byte</span><span class="o">[]</span><span class="w"> </span><span class="n">bArrX</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">x</span><span class="p">(</span><span class="n">bArr4</span><span class="p">,</span><span class="w"> </span><span class="n">j10</span><span class="p">,</span><span class="w"> </span><span class="n">chapterItem</span><span class="p">.</span><span class="na">ChapterId</span><span class="p">);</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">bArrX</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="kc">null</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">file</span><span class="p">.</span><span class="na">exists</span><span class="p">())</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="n">String</span><span class="w"> </span><span class="n">strM</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">com</span><span class="p">.</span><span class="na">qidian</span><span class="p">.</span><span class="na">common</span><span class="p">.</span><span class="na">lib</span><span class="p">.</span><span class="na">util</span><span class="p">.</span><span class="na">m</span><span class="p">.</span><span class="na">m</span><span class="p">(</span><span class="n">file</span><span class="p">);</span>
<span class="w">            </span><span class="n">strEncode</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">!</span><span class="n">TextUtils</span><span class="p">.</span><span class="na">isEmpty</span><span class="p">(</span><span class="n">strM</span><span class="p">)</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="n">URLEncoder</span><span class="p">.</span><span class="na">encode</span><span class="p">(</span><span class="n">strM</span><span class="p">)</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s">&quot;&quot;</span><span class="p">;</span>
<span class="w">        </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="n">strEncode</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;file_not_found_&quot;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">strF</span><span class="p">;</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">        </span><span class="n">d5</span><span class="p">.</span><span class="na">cihai</span><span class="p">.</span><span class="na">p</span><span class="p">(</span><span class="k">new</span><span class="w"> </span><span class="n">AutoTrackerItem</span><span class="p">.</span><span class="na">Builder</span><span class="p">().</span><span class="na">setPn</span><span class="p">(</span><span class="s">&quot;OKR_chapter_vip_error&quot;</span><span class="p">).</span><span class="na">setDt</span><span class="p">(</span><span class="s">&quot;1103&quot;</span><span class="p">).</span><span class="na">setPdid</span><span class="p">(</span><span class="n">String</span><span class="p">.</span><span class="na">valueOf</span><span class="p">(</span><span class="n">j10</span><span class="p">)).</span><span class="na">setDid</span><span class="p">(</span><span class="n">String</span><span class="p">.</span><span class="na">valueOf</span><span class="p">(</span><span class="n">chapterItem</span><span class="p">.</span><span class="na">ChapterId</span><span class="p">)).</span><span class="na">setPdt</span><span class="p">(</span><span class="n">String</span><span class="p">.</span><span class="na">valueOf</span><span class="p">(</span><span class="n">strEncode</span><span class="p">.</span><span class="na">length</span><span class="p">())).</span><span class="na">setEx1</span><span class="p">(</span><span class="n">String</span><span class="p">.</span><span class="na">valueOf</span><span class="p">(</span><span class="n">QDUserManager</span><span class="p">.</span><span class="na">getInstance</span><span class="p">().</span><span class="na">k</span><span class="p">())).</span><span class="na">setEx2</span><span class="p">(</span><span class="n">QDUserManager</span><span class="p">.</span><span class="na">getInstance</span><span class="p">().</span><span class="na">s</span><span class="p">()).</span><span class="na">setEx3</span><span class="p">(</span><span class="n">QDUserManager</span><span class="p">.</span><span class="na">getInstance</span><span class="p">().</span><span class="na">t</span><span class="p">()).</span><span class="na">setEx4</span><span class="p">(</span><span class="n">we</span><span class="p">.</span><span class="na">d</span><span class="p">.</span><span class="na">I</span><span class="p">().</span><span class="na">d</span><span class="p">()).</span><span class="na">setEx5</span><span class="p">(</span><span class="n">strEncode</span><span class="p">).</span><span class="na">setAbtest</span><span class="p">(</span><span class="s">&quot;true&quot;</span><span class="p">).</span><span class="na">setKeyword</span><span class="p">(</span><span class="s">&quot;v2&quot;</span><span class="p">).</span><span class="na">buildCol</span><span class="p">());</span>
<span class="w">        </span><span class="n">chapterContentItem</span><span class="p">.</span><span class="na">setErrorCode</span><span class="p">(</span><span class="o">-</span><span class="mi">20068</span><span class="p">);</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">chapterContentItem</span><span class="p">;</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">    </span><span class="n">String</span><span class="w"> </span><span class="n">strW</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">w</span><span class="p">(</span><span class="n">bArrX</span><span class="p">);</span>
<span class="w">    </span><span class="n">JSONObject</span><span class="w"> </span><span class="n">jSONObjectQ</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Q</span><span class="p">(</span><span class="n">strW</span><span class="p">);</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">jSONObjectQ</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="kc">null</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">strW</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">jSONObjectQ</span><span class="p">.</span><span class="na">optString</span><span class="p">(</span><span class="s">&quot;content&quot;</span><span class="p">);</span>
<span class="w">        </span><span class="kt">int</span><span class="w"> </span><span class="n">iOptInt</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">jSONObjectQ</span><span class="p">.</span><span class="na">optInt</span><span class="p">(</span><span class="s">&quot;type&quot;</span><span class="p">);</span>
<span class="w">        </span><span class="kt">int</span><span class="w"> </span><span class="n">iOptInt2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">jSONObjectQ</span><span class="p">.</span><span class="na">optInt</span><span class="p">(</span><span class="s">&quot;code&quot;</span><span class="p">);</span>
<span class="w">        </span><span class="n">String</span><span class="w"> </span><span class="n">strOptString</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">jSONObjectQ</span><span class="p">.</span><span class="na">optString</span><span class="p">(</span><span class="s">&quot;msg&quot;</span><span class="p">);</span>
<span class="w">        </span><span class="n">j11</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">jCurrentTimeMillis</span><span class="p">;</span>
<span class="w">        </span><span class="n">bArr</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bArr7</span><span class="p">;</span>
<span class="w">        </span><span class="n">e0</span><span class="p">.</span><span class="na">f18516search</span><span class="p">.</span><span class="na">a</span><span class="p">(</span><span class="n">j10</span><span class="p">,</span><span class="w"> </span><span class="n">chapterItem</span><span class="p">.</span><span class="na">ChapterId</span><span class="p">,</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">e0</span><span class="p">.</span><span class="na">search</span><span class="p">(</span><span class="n">jSONObjectQ</span><span class="p">.</span><span class="na">optLong</span><span class="p">(</span><span class="s">&quot;idExpire&quot;</span><span class="p">),</span><span class="w"> </span><span class="n">jSONObjectQ</span><span class="p">.</span><span class="na">optInt</span><span class="p">(</span><span class="s">&quot;wt&quot;</span><span class="p">)));</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">iOptInt2</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="n">chapterContentItem</span><span class="p">.</span><span class="na">setErrorCode</span><span class="p">(</span><span class="n">iOptInt2</span><span class="p">);</span>
<span class="w">            </span><span class="n">chapterContentItem</span><span class="p">.</span><span class="na">setErrorMessage</span><span class="p">(</span><span class="n">strOptString</span><span class="p">);</span>
<span class="w">            </span><span class="k">return</span><span class="w"> </span><span class="n">chapterContentItem</span><span class="p">;</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">TextUtils</span><span class="p">.</span><span class="na">isEmpty</span><span class="p">(</span><span class="n">strW</span><span class="p">))</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="n">chapterContentItem</span><span class="p">.</span><span class="na">setErrorCode</span><span class="p">(</span><span class="o">-</span><span class="mi">20088</span><span class="p">);</span>
<span class="w">            </span><span class="k">return</span><span class="w"> </span><span class="n">chapterContentItem</span><span class="p">;</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">        </span><span class="n">String</span><span class="w"> </span><span class="n">str</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">j10</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s">&quot;_&quot;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">chapterItem</span><span class="p">.</span><span class="na">ChapterId</span><span class="p">;</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">iOptInt</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">LockType</span><span class="p">.</span><span class="na">FOCK</span><span class="p">.</span><span class="na">getType</span><span class="p">())</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="n">String</span><span class="w"> </span><span class="n">strValueOf</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">String</span><span class="p">.</span><span class="na">valueOf</span><span class="p">(</span><span class="n">chapterItem</span><span class="p">.</span><span class="na">ChapterId</span><span class="p">);</span>
<span class="w">            </span><span class="n">FockUtil</span><span class="w"> </span><span class="n">fockUtil</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">FockUtil</span><span class="p">.</span><span class="na">INSTANCE</span><span class="p">;</span>
<span class="w">            </span><span class="kt">boolean</span><span class="w"> </span><span class="n">zIsHasKey</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">fockUtil</span><span class="p">.</span><span class="na">isHasKey</span><span class="p">();</span>
<span class="w">            </span><span class="n">Fock</span><span class="p">.</span><span class="na">FockResult</span><span class="w"> </span><span class="n">fockResultUnlock</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">fockUtil</span><span class="p">.</span><span class="na">unlock</span><span class="p">(</span><span class="n">strW</span><span class="p">,</span><span class="w"> </span><span class="n">strValueOf</span><span class="p">,</span><span class="w"> </span><span class="n">str</span><span class="p">);</span>
<span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">fockResultUnlock</span><span class="p">.</span><span class="na">status</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">Fock</span><span class="p">.</span><span class="na">FockResult</span><span class="p">.</span><span class="na">STATUS_EMPTY_USER_KEY</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">                </span><span class="n">Fock</span><span class="p">.</span><span class="na">setup</span><span class="p">(</span><span class="n">we</span><span class="p">.</span><span class="na">d</span><span class="p">.</span><span class="na">X</span><span class="p">());</span>
<span class="w">                </span><span class="n">fockResultUnlock</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">fockUtil</span><span class="p">.</span><span class="na">unlock</span><span class="p">(</span><span class="n">strW</span><span class="p">,</span><span class="w"> </span><span class="n">strValueOf</span><span class="p">,</span><span class="w"> </span><span class="n">str</span><span class="p">);</span>
<span class="w">            </span><span class="p">}</span>
<span class="w">            </span><span class="n">Fock</span><span class="p">.</span><span class="na">FockResult</span><span class="w"> </span><span class="n">fockResult</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">fockResultUnlock</span><span class="p">;</span>
<span class="w">            </span><span class="n">Logger</span><span class="p">.</span><span class="na">e</span><span class="p">(</span><span class="s">&quot;FockUtil: chapter_id:&quot;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">chapterItem</span><span class="p">.</span><span class="na">ChapterId</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s">&quot;,result:&quot;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">fockResult</span><span class="p">.</span><span class="na">status</span><span class="p">);</span>
<span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">fockResult</span><span class="p">.</span><span class="na">status</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">                </span><span class="n">fockUtil</span><span class="p">.</span><span class="na">report</span><span class="p">(</span><span class="n">j10</span><span class="p">,</span><span class="w"> </span><span class="n">chapterItem</span><span class="p">,</span><span class="w"> </span><span class="n">fockResult</span><span class="p">,</span><span class="w"> </span><span class="n">zIsHasKey</span><span class="p">);</span>
<span class="w">            </span><span class="p">}</span>
<span class="w">            </span><span class="kt">int</span><span class="w"> </span><span class="n">i10</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">fockResult</span><span class="p">.</span><span class="na">status</span><span class="p">;</span>
<span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">i10</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">                </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">i10</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="o">-</span><span class="mi">2</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">                    </span><span class="n">chapterContentItem</span><span class="p">.</span><span class="na">setErrorCode</span><span class="p">(</span><span class="o">-</span><span class="mi">20079</span><span class="p">);</span>
<span class="w">                    </span><span class="n">d5</span><span class="p">.</span><span class="na">cihai</span><span class="p">.</span><span class="na">p</span><span class="p">(</span><span class="k">new</span><span class="w"> </span><span class="n">AutoTrackerItem</span><span class="p">.</span><span class="na">Builder</span><span class="p">().</span><span class="na">setPn</span><span class="p">(</span><span class="s">&quot;OKR_LoadChapterFailed_qimeiChanged&quot;</span><span class="p">).</span><span class="na">setEx1</span><span class="p">(</span><span class="n">String</span><span class="p">.</span><span class="na">valueOf</span><span class="p">(</span><span class="n">j10</span><span class="p">)).</span><span class="na">setEx2</span><span class="p">(</span><span class="n">String</span><span class="p">.</span><span class="na">valueOf</span><span class="p">(</span><span class="n">chapterItem</span><span class="p">.</span><span class="na">ChapterId</span><span class="p">)).</span><span class="na">buildCol</span><span class="p">());</span>
<span class="w">                    </span><span class="k">return</span><span class="w"> </span><span class="n">chapterContentItem</span><span class="p">;</span>
<span class="w">                </span><span class="p">}</span>
<span class="w">                </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">i10</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">Fock</span><span class="p">.</span><span class="na">FockResult</span><span class="p">.</span><span class="na">STATUS_EMPTY_USER_KEY</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">                    </span><span class="n">chapterContentItem</span><span class="p">.</span><span class="na">setErrorCode</span><span class="p">(</span><span class="o">-</span><span class="mi">20082</span><span class="p">);</span>
<span class="w">                    </span><span class="k">return</span><span class="w"> </span><span class="n">chapterContentItem</span><span class="p">;</span>
<span class="w">                </span><span class="p">}</span>
<span class="w">                </span><span class="n">chapterContentItem</span><span class="p">.</span><span class="na">setErrorCode</span><span class="p">(</span><span class="o">-</span><span class="mi">20080</span><span class="p">);</span>
<span class="w">                </span><span class="k">return</span><span class="w"> </span><span class="n">chapterContentItem</span><span class="p">;</span>
<span class="w">            </span><span class="p">}</span>
<span class="w">            </span><span class="n">strW</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">String</span><span class="p">(</span><span class="n">fockResult</span><span class="p">.</span><span class="na">data</span><span class="p">,</span><span class="w"> </span><span class="n">StandardCharsets</span><span class="p">.</span><span class="na">UTF_8</span><span class="p">);</span>
<span class="w">        </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">iOptInt</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="n">LockType</span><span class="p">.</span><span class="na">DEFAULT</span><span class="p">.</span><span class="na">getType</span><span class="p">())</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="n">chapterContentItem</span><span class="p">.</span><span class="na">setErrorCode</span><span class="p">(</span><span class="o">-</span><span class="mi">20081</span><span class="p">);</span>
<span class="w">            </span><span class="k">return</span><span class="w"> </span><span class="n">chapterContentItem</span><span class="p">;</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">j11</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">jCurrentTimeMillis</span><span class="p">;</span>
<span class="w">        </span><span class="n">bArr</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bArr7</span><span class="p">;</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">    </span><span class="n">String</span><span class="w"> </span><span class="n">str2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">strW</span><span class="p">;</span>
<span class="w">    </span><span class="n">ArrayList</span><span class="o">&lt;</span><span class="n">BlockInfo</span><span class="o">&gt;</span><span class="w"> </span><span class="n">arrayList</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">null</span><span class="p">;</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">bArr5</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="kc">null</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">try</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="n">jSONObject</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">JSONObject</span><span class="p">(</span><span class="n">w</span><span class="p">(</span><span class="n">bArr5</span><span class="p">));</span>
<span class="w">        </span><span class="p">}</span><span class="w"> </span><span class="k">catch</span><span class="w"> </span><span class="p">(</span><span class="n">Exception</span><span class="w"> </span><span class="n">e10</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="n">e10</span><span class="p">.</span><span class="na">printStackTrace</span><span class="p">();</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">jSONObject</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">null</span><span class="p">;</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">    </span><span class="n">chapterContentItem</span><span class="p">.</span><span class="na">setChapterContent</span><span class="p">(</span><span class="n">str2</span><span class="p">);</span>
<span class="w">    </span><span class="n">chapterContentItem</span><span class="p">.</span><span class="na">setOriginalChapterContent</span><span class="p">(</span><span class="n">str2</span><span class="p">);</span>
<span class="w">    </span><span class="n">chapterContentItem</span><span class="p">.</span><span class="na">setAuthorContent</span><span class="p">(</span><span class="n">jSONObject</span><span class="p">);</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">bArr</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="kc">null</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">try</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="n">String</span><span class="w"> </span><span class="n">strW2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">w</span><span class="p">(</span><span class="n">bArr</span><span class="p">);</span>
<span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">strW2</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="kc">null</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">                </span><span class="n">arrayList</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">ArrayList</span><span class="p">)</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">Gson</span><span class="p">().</span><span class="na">j</span><span class="p">(</span><span class="n">strW2</span><span class="p">,</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">b</span><span class="p">().</span><span class="na">getType</span><span class="p">());</span>
<span class="w">            </span><span class="p">}</span>
<span class="w">        </span><span class="p">}</span><span class="w"> </span><span class="k">catch</span><span class="w"> </span><span class="p">(</span><span class="n">Exception</span><span class="w"> </span><span class="n">e11</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="n">e11</span><span class="p">.</span><span class="na">printStackTrace</span><span class="p">();</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">        </span><span class="n">chapterContentItem</span><span class="p">.</span><span class="na">setBlockInfos</span><span class="p">(</span><span class="n">arrayList</span><span class="p">);</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">we</span><span class="p">.</span><span class="na">d</span><span class="p">.</span><span class="na">k0</span><span class="p">())</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">StringBuffer</span><span class="w"> </span><span class="n">stringBuffer</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">StringBuffer</span><span class="p">();</span>
<span class="w">        </span><span class="n">stringBuffer</span><span class="p">.</span><span class="na">append</span><span class="p">(</span><span class="s">&quot;Vip章节 内容读取 chapterId:&quot;</span><span class="p">);</span>
<span class="w">        </span><span class="n">stringBuffer</span><span class="p">.</span><span class="na">append</span><span class="p">(</span><span class="n">chapterItem</span><span class="p">.</span><span class="na">ChapterId</span><span class="p">);</span>
<span class="w">        </span><span class="n">stringBuffer</span><span class="p">.</span><span class="na">append</span><span class="p">(</span><span class="s">&quot; chapterName:&quot;</span><span class="p">);</span>
<span class="w">        </span><span class="n">stringBuffer</span><span class="p">.</span><span class="na">append</span><span class="p">(</span><span class="n">chapterItem</span><span class="p">.</span><span class="na">ChapterName</span><span class="p">);</span>
<span class="w">        </span><span class="n">stringBuffer</span><span class="p">.</span><span class="na">append</span><span class="p">(</span><span class="s">&quot; 读取, 耗时:&quot;</span><span class="p">);</span>
<span class="w">        </span><span class="n">stringBuffer</span><span class="p">.</span><span class="na">append</span><span class="p">(</span><span class="n">System</span><span class="p">.</span><span class="na">currentTimeMillis</span><span class="p">()</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">j11</span><span class="p">);</span>
<span class="w">        </span><span class="n">stringBuffer</span><span class="p">.</span><span class="na">append</span><span class="p">(</span><span class="s">&quot;毫秒&quot;</span><span class="p">);</span>
<span class="w">        </span><span class="n">Logger</span><span class="p">.</span><span class="na">d</span><span class="p">(</span><span class="s">&quot;QDReader&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">stringBuffer</span><span class="p">.</span><span class="na">toString</span><span class="p">());</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">chapterContentItem</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div>
</details>
<p>解密流程可概括为:</p>
<ol>
<li><strong>文件分段读取</strong>: 使用 <code>W(file, ...)</code> 按小端格式读取 5 段数据</li>
<li><strong>第一阶段解密</strong>: 将 <code>part1</code> 传入 <code>x(...)</code> 调用 native 接口 <code>a.b.b(...)</code>, 返回 JSON 字符串</li>
<li><strong>JSON 解析</strong>: 提取 <code>content</code>、<code>type</code>、<code>code</code>、<code>msg</code> 等字段</li>
<li><strong>VIP 章节二次解密</strong>: <code>type == FOCK</code> 时, 调用 <code>FockUtil.unlock(...)</code> 解密</li>
<li><strong>附加数据块处理</strong></li>
</ol>
<h5 id="351-w-">3.5.1 <code>W</code> 函数 -- 分段读取逻辑<a class="headerlink" href="#351-w-" title="Permanent link">&para;</a></h5>
<p><code>W</code> 函数的核心思路是在文件输入流上依次读取 5 段数据, 每段前 4 字节表示该段的长度 (little-endian), 随后读取对应长度的原始字节。</p>
<div class="highlight"><pre><span></span><code><span class="n">FileInputStream</span><span class="w"> </span><span class="n">fileInputStream</span><span class="p">;</span>
<span class="kt">byte</span><span class="o">[]</span><span class="w"> </span><span class="n">bArr</span><span class="p">;</span>
<span class="kt">byte</span><span class="o">[]</span><span class="w"> </span><span class="n">bArr2</span><span class="p">;</span>
<span class="kt">byte</span><span class="o">[]</span><span class="w"> </span><span class="n">bArr3</span><span class="p">;</span>
<span class="kt">byte</span><span class="o">[]</span><span class="w"> </span><span class="n">bArr4</span><span class="p">;</span>
<span class="kt">byte</span><span class="o">[]</span><span class="w"> </span><span class="n">bArr5</span><span class="p">;</span>
<span class="n">fileInputStream</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">FileInputStream</span><span class="p">(</span><span class="n">file</span><span class="p">);</span>
<span class="kt">int</span><span class="w"> </span><span class="n">iR</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">com</span><span class="p">.</span><span class="na">qidian</span><span class="p">.</span><span class="na">common</span><span class="p">.</span><span class="na">lib</span><span class="p">.</span><span class="na">util</span><span class="p">.</span><span class="na">m</span><span class="p">.</span><span class="na">r</span><span class="p">(</span><span class="n">fileInputStream</span><span class="p">);</span>
<span class="n">bArr2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="kt">byte</span><span class="o">[</span><span class="n">iR</span><span class="o">]</span><span class="p">;</span>
<span class="n">fileInputStream</span><span class="p">.</span><span class="na">read</span><span class="p">(</span><span class="n">bArr2</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="n">iR</span><span class="p">);</span>
<span class="kt">int</span><span class="w"> </span><span class="n">iR2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">com</span><span class="p">.</span><span class="na">qidian</span><span class="p">.</span><span class="na">common</span><span class="p">.</span><span class="na">lib</span><span class="p">.</span><span class="na">util</span><span class="p">.</span><span class="na">m</span><span class="p">.</span><span class="na">r</span><span class="p">(</span><span class="n">fileInputStream</span><span class="p">);</span>
<span class="n">bArr3</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="kt">byte</span><span class="o">[</span><span class="n">iR2</span><span class="o">]</span><span class="p">;</span>
<span class="n">fileInputStream</span><span class="p">.</span><span class="na">read</span><span class="p">(</span><span class="n">bArr3</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="n">iR2</span><span class="p">);</span>
<span class="kt">int</span><span class="w"> </span><span class="n">iR3</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">com</span><span class="p">.</span><span class="na">qidian</span><span class="p">.</span><span class="na">common</span><span class="p">.</span><span class="na">lib</span><span class="p">.</span><span class="na">util</span><span class="p">.</span><span class="na">m</span><span class="p">.</span><span class="na">r</span><span class="p">(</span><span class="n">fileInputStream</span><span class="p">);</span>
<span class="n">bArr4</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="kt">byte</span><span class="o">[</span><span class="n">iR3</span><span class="o">]</span><span class="p">;</span>
<span class="n">fileInputStream</span><span class="p">.</span><span class="na">read</span><span class="p">(</span><span class="n">bArr4</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="n">iR3</span><span class="p">);</span>
<span class="kt">int</span><span class="w"> </span><span class="n">iR4</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">com</span><span class="p">.</span><span class="na">qidian</span><span class="p">.</span><span class="na">common</span><span class="p">.</span><span class="na">lib</span><span class="p">.</span><span class="na">util</span><span class="p">.</span><span class="na">m</span><span class="p">.</span><span class="na">r</span><span class="p">(</span><span class="n">fileInputStream</span><span class="p">);</span>
<span class="n">bArr</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="kt">byte</span><span class="o">[</span><span class="n">iR4</span><span class="o">]</span><span class="p">;</span>
<span class="n">fileInputStream</span><span class="p">.</span><span class="na">read</span><span class="p">(</span><span class="n">bArr</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="n">iR4</span><span class="p">);</span>
<span class="kt">int</span><span class="w"> </span><span class="n">iR5</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">com</span><span class="p">.</span><span class="na">qidian</span><span class="p">.</span><span class="na">common</span><span class="p">.</span><span class="na">lib</span><span class="p">.</span><span class="na">util</span><span class="p">.</span><span class="na">m</span><span class="p">.</span><span class="na">r</span><span class="p">(</span><span class="n">fileInputStream</span><span class="p">);</span>
<span class="n">bArr5</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="kt">byte</span><span class="o">[</span><span class="n">iR5</span><span class="o">]</span><span class="p">;</span>
<span class="n">fileInputStream</span><span class="p">.</span><span class="na">read</span><span class="p">(</span><span class="n">bArr5</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="n">iR5</span><span class="p">);</span>
<span class="n">dVar</span><span class="p">.</span><span class="na">f18975search</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="kt">byte</span><span class="o">[][]</span><span class="p">{</span><span class="n">bArr2</span><span class="p">,</span><span class="w"> </span><span class="n">bArr3</span><span class="p">,</span><span class="w"> </span><span class="n">bArr4</span><span class="p">,</span><span class="w"> </span><span class="n">bArr</span><span class="p">,</span><span class="w"> </span><span class="n">bArr5</span><span class="p">};</span>
</code></pre></div>
<p>其中, <code>com.qidian.common.lib.util.m.r</code> 用于读取 4 字节长度并转换为 <code>int</code>:</p>
<div class="highlight"><pre><span></span><code><span class="kd">public</span><span class="w"> </span><span class="kd">static</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="nf">r</span><span class="p">(</span><span class="n">InputStream</span><span class="w"> </span><span class="n">inputStream</span><span class="p">)</span><span class="w"> </span><span class="kd">throws</span><span class="w"> </span><span class="n">IOException</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kt">byte</span><span class="o">[]</span><span class="w"> </span><span class="n">bArr</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="kt">byte</span><span class="o">[</span><span class="mi">4</span><span class="o">]</span><span class="p">;</span>
<span class="w">    </span><span class="n">inputStream</span><span class="p">.</span><span class="na">read</span><span class="p">(</span><span class="n">bArr</span><span class="p">);</span>
<span class="w">    </span><span class="n">ByteBuffer</span><span class="w"> </span><span class="n">byteBufferWrap</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ByteBuffer</span><span class="p">.</span><span class="na">wrap</span><span class="p">(</span><span class="n">bArr</span><span class="p">);</span>
<span class="w">    </span><span class="n">byteBufferWrap</span><span class="p">.</span><span class="na">order</span><span class="p">(</span><span class="n">ByteOrder</span><span class="p">.</span><span class="na">LITTLE_ENDIAN</span><span class="p">);</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">byteBufferWrap</span><span class="p">.</span><span class="na">getInt</span><span class="p">();</span>
<span class="p">}</span>
</code></pre></div>
<p>由此可得文件整体格式:</p>
<div class="highlight"><pre><span></span><code>[len0][data0]
[len1][data1]
[len2][data2]
[len3][data3]
[len4][data4]
</code></pre></div>
<h5 id="python_1">Python 等价实现<a class="headerlink" href="#python_1" title="Permanent link">&para;</a></h5>
<p>在 Python 中可用 <code>BytesIO</code> 对相同逻辑进行复现:</p>
<div class="highlight"><pre><span></span><code><span class="kn">from</span><span class="w"> </span><span class="nn">io</span><span class="w"> </span><span class="kn">import</span> <span class="n">BytesIO</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">pathlib</span><span class="w"> </span><span class="kn">import</span> <span class="n">Path</span>

<span class="n">path</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="s2">&quot;xxx.qd&quot;</span><span class="p">)</span>
<span class="k">with</span> <span class="n">path</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s1">&#39;rb&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
    <span class="n">buf</span> <span class="o">=</span> <span class="n">BytesIO</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">read</span><span class="p">())</span>

<span class="k">def</span><span class="w"> </span><span class="nf">read_chunk</span><span class="p">():</span>
    <span class="c1"># 先读 4 字节 little-endian length</span>
    <span class="n">raw</span> <span class="o">=</span> <span class="n">buf</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">raw</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">4</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">IOError</span><span class="p">(</span><span class="s2">&quot;文件结构不完整&quot;</span><span class="p">)</span>
    <span class="n">length</span> <span class="o">=</span> <span class="nb">int</span><span class="o">.</span><span class="n">from_bytes</span><span class="p">(</span><span class="n">raw</span><span class="p">,</span> <span class="n">byteorder</span><span class="o">=</span><span class="s1">&#39;little&#39;</span><span class="p">)</span>
    <span class="c1"># 再读对应长度</span>
    <span class="k">return</span> <span class="n">buf</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="n">length</span><span class="p">)</span>

<span class="n">chunk0</span> <span class="o">=</span> <span class="n">read_chunk</span><span class="p">()</span>
<span class="n">chunk1</span> <span class="o">=</span> <span class="n">read_chunk</span><span class="p">()</span>
<span class="n">chunk2</span> <span class="o">=</span> <span class="n">read_chunk</span><span class="p">()</span>
<span class="n">chunk3</span> <span class="o">=</span> <span class="n">read_chunk</span><span class="p">()</span>
<span class="n">chunk4</span> <span class="o">=</span> <span class="n">read_chunk</span><span class="p">()</span>
</code></pre></div>
<h5 id="352-x-native">3.5.2 <code>x</code> 函数 -- Native 解密流程<a class="headerlink" href="#352-x-native" title="Permanent link">&para;</a></h5>
<p>点击查看 <code>x</code> 函数, 发现该方法主要调用本地 JNI 接口完成解密, 例如:</p>
<div class="highlight"><pre><span></span><code><span class="c1">// private static byte[] x(byte[] bArr, long j10, long j11)</span>
<span class="c1">// ...</span>
<span class="kt">byte</span><span class="o">[]</span><span class="w"> </span><span class="n">bArrB2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">a</span><span class="p">.</span><span class="na">b</span><span class="p">.</span><span class="na">b</span><span class="p">(</span><span class="n">j10</span><span class="p">,</span><span class="w"> </span><span class="n">j11</span><span class="p">,</span><span class="w"> </span><span class="n">bArr</span><span class="p">,</span><span class="w"> </span><span class="n">QDUserManager</span><span class="p">.</span><span class="na">getInstance</span><span class="p">().</span><span class="na">k</span><span class="p">(),</span><span class="w"> </span><span class="n">we</span><span class="p">.</span><span class="na">d</span><span class="p">.</span><span class="na">I</span><span class="p">().</span><span class="na">d</span><span class="p">());</span>
<span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">bArrB2</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="kc">null</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">bArrB2</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div>
<p>在 <code>a/b.java</code> 中发现是 native 函数:</p>
<div class="highlight"><pre><span></span><code><span class="kd">public</span><span class="w"> </span><span class="kd">class</span> <span class="nc">b</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kd">static</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">try</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="n">System</span><span class="p">.</span><span class="na">loadLibrary</span><span class="p">(</span><span class="s">&quot;load-jni&quot;</span><span class="p">);</span>
<span class="w">        </span><span class="p">}</span><span class="w"> </span><span class="k">catch</span><span class="w"> </span><span class="p">(</span><span class="n">Exception</span><span class="w"> </span><span class="n">e10</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="n">e10</span><span class="p">.</span><span class="na">printStackTrace</span><span class="p">();</span>
<span class="w">        </span><span class="p">}</span><span class="w"> </span><span class="k">catch</span><span class="w"> </span><span class="p">(</span><span class="n">UnsatisfiedLinkError</span><span class="w"> </span><span class="n">e11</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="n">e11</span><span class="p">.</span><span class="na">printStackTrace</span><span class="p">();</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kd">static</span><span class="w"> </span><span class="kd">native</span><span class="w"> </span><span class="kt">byte</span><span class="o">[]</span><span class="w"> </span><span class="nf">b</span><span class="p">(</span><span class="kt">long</span><span class="w"> </span><span class="n">j10</span><span class="p">,</span><span class="w"> </span><span class="kt">long</span><span class="w"> </span><span class="n">j11</span><span class="p">,</span><span class="w"> </span><span class="kt">byte</span><span class="o">[]</span><span class="w"> </span><span class="n">bArr</span><span class="p">,</span><span class="w"> </span><span class="kt">long</span><span class="w"> </span><span class="n">j12</span><span class="p">,</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="n">str</span><span class="p">);</span>

<span class="w">    </span><span class="c1">// ...</span>
<span class="p">}</span>
</code></pre></div>
<p>使用 Ghidra (或 IDA) 对 <code>libload-jni.so</code> 进行反汇编分析后. 可快速定位到对应的 native 方法实现 <code>Java_a_b_b</code>:</p>
<details class="note">
<summary>Java_a_b_b 实现片段 (点击展开)</summary>
<div class="highlight"><pre><span></span><code><span class="n">jobject</span><span class="w"> </span><span class="kr">__fastcall</span><span class="w"> </span><span class="n">Java_a_b_b</span><span class="p">(</span>
<span class="w">    </span><span class="n">JNIEnv</span><span class="w"> </span><span class="o">*</span><span class="n">env</span><span class="p">,</span>
<span class="w">    </span><span class="n">jobject</span><span class="w"> </span><span class="n">clazz</span><span class="p">,</span>
<span class="w">    </span><span class="n">jlong</span><span class="w"> </span><span class="n">bookIdLong</span><span class="p">,</span>
<span class="w">    </span><span class="n">jlong</span><span class="w"> </span><span class="n">chapterIdLong</span><span class="p">,</span>
<span class="w">    </span><span class="n">jbyteArray</span><span class="w"> </span><span class="n">dataArray</span><span class="p">,</span>
<span class="w">    </span><span class="n">jlong</span><span class="w"> </span><span class="n">userIdLong</span><span class="p">,</span>
<span class="w">    </span><span class="n">jstring</span><span class="w"> </span><span class="n">imei</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">  </span><span class="kt">char</span><span class="w"> </span><span class="o">*</span><span class="n">bookIdCStr</span><span class="p">;</span><span class="w"> </span><span class="c1">// x19</span>
<span class="w">  </span><span class="kt">char</span><span class="w"> </span><span class="o">*</span><span class="n">chapterIdCStr</span><span class="p">;</span><span class="w"> </span><span class="c1">// x21</span>
<span class="w">  </span><span class="k">const</span><span class="w"> </span><span class="kt">char</span><span class="w"> </span><span class="o">*</span><span class="n">userIdCStr</span><span class="p">;</span><span class="w"> </span><span class="c1">// x23</span>
<span class="w">  </span><span class="n">_OWORD</span><span class="w"> </span><span class="o">*</span><span class="n">secBuffer1</span><span class="p">;</span><span class="w"> </span><span class="c1">// x27</span>
<span class="w">  </span><span class="n">_OWORD</span><span class="w"> </span><span class="o">*</span><span class="n">secBuffer2</span><span class="p">;</span><span class="w"> </span><span class="c1">// x28</span>
<span class="w">  </span><span class="n">_OWORD</span><span class="w"> </span><span class="o">*</span><span class="n">sha2KeyBufArea</span><span class="p">;</span><span class="w"> </span><span class="c1">// x0</span>
<span class="w">  </span><span class="k">const</span><span class="w"> </span><span class="kt">char</span><span class="w"> </span><span class="o">*</span><span class="n">sha2KeyCStr</span><span class="p">;</span><span class="w"> </span><span class="c1">// x25</span>
<span class="w">  </span><span class="n">jclass</span><span class="w"> </span><span class="n">clsAB_1</span><span class="p">;</span><span class="w"> </span><span class="c1">// x0</span>
<span class="w">  </span><span class="kt">void</span><span class="w"> </span><span class="o">*</span><span class="n">clsAB_ref1</span><span class="p">;</span><span class="w"> </span><span class="c1">// x26</span>
<span class="w">  </span><span class="k">const</span><span class="w"> </span><span class="kt">char</span><span class="w"> </span><span class="o">*</span><span class="n">imeiCStr</span><span class="p">;</span><span class="w"> </span><span class="c1">// x24</span>
<span class="w">  </span><span class="kt">char</span><span class="w"> </span><span class="o">*</span><span class="n">ptrAfterFirstConcat</span><span class="p">;</span><span class="w"> </span><span class="c1">// x24</span>
<span class="w">  </span><span class="kt">char</span><span class="w"> </span><span class="o">*</span><span class="n">ptrAfterChapterConcat</span><span class="p">;</span><span class="w"> </span><span class="c1">// x0</span>
<span class="w">  </span><span class="k">struct</span><span class="w"> </span><span class="nc">_jmethodID</span><span class="w"> </span><span class="o">*</span><span class="n">mid_s</span><span class="p">;</span><span class="w"> </span><span class="c1">// x24</span>
<span class="w">  </span><span class="n">jobject</span><span class="w"> </span><span class="n">jSha1Key1</span><span class="p">;</span><span class="w"> </span><span class="c1">// x26</span>
<span class="w">  </span><span class="k">const</span><span class="w"> </span><span class="kt">char</span><span class="w"> </span><span class="o">*</span><span class="n">sha1Key1CStr</span><span class="p">;</span><span class="w"> </span><span class="c1">// x24</span>
<span class="w">  </span><span class="n">jstring</span><span class="w"> </span><span class="n">jSec2Str</span><span class="p">;</span><span class="w"> </span><span class="c1">// x24</span>
<span class="w">  </span><span class="k">struct</span><span class="w"> </span><span class="nc">_jmethodID</span><span class="w"> </span><span class="o">*</span><span class="n">mid_m</span><span class="p">;</span><span class="w"> </span><span class="c1">// x26</span>
<span class="w">  </span><span class="n">jstring</span><span class="w"> </span><span class="n">jUserIdJStr</span><span class="p">;</span><span class="w"> </span><span class="c1">// x0</span>
<span class="w">  </span><span class="kt">void</span><span class="w"> </span><span class="o">*</span><span class="n">clsAB_ref2</span><span class="p">;</span><span class="w"> </span><span class="c1">// x1</span>
<span class="w">  </span><span class="n">jobject</span><span class="w"> </span><span class="n">jSha1Key2</span><span class="p">;</span><span class="w"> </span><span class="c1">// x22</span>
<span class="w">  </span><span class="k">const</span><span class="w"> </span><span class="kt">char</span><span class="w"> </span><span class="o">*</span><span class="n">sha1Key2CStr</span><span class="p">;</span><span class="w"> </span><span class="c1">// x24</span>
<span class="w">  </span><span class="n">jstring</span><span class="w"> </span><span class="n">jSha2KeyJStr</span><span class="p">;</span><span class="w"> </span><span class="c1">// x26</span>
<span class="w">  </span><span class="k">struct</span><span class="w"> </span><span class="nc">_jmethodID</span><span class="w"> </span><span class="o">*</span><span class="n">mid_d</span><span class="p">;</span><span class="w"> </span><span class="c1">// x22</span>
<span class="w">  </span><span class="n">jobject</span><span class="w"> </span><span class="n">intermediateData1</span><span class="p">;</span><span class="w"> </span><span class="c1">// x27</span>
<span class="w">  </span><span class="n">jobject</span><span class="w"> </span><span class="n">finalData</span><span class="p">;</span><span class="w"> </span><span class="c1">// x22</span>
<span class="w">  </span><span class="n">jstring</span><span class="w"> </span><span class="n">jSec1Str</span><span class="p">;</span><span class="w"> </span><span class="c1">// [xsp+0h] [xbp-30h]</span>
<span class="w">  </span><span class="n">jstring</span><span class="w"> </span><span class="n">jSha1Key1FinalStr</span><span class="p">;</span><span class="w"> </span><span class="c1">// [xsp+0h] [xbp-30h]</span>
<span class="w">  </span><span class="k">const</span><span class="w"> </span><span class="kt">char</span><span class="w"> </span><span class="o">*</span><span class="n">imeiCStrRef</span><span class="p">;</span><span class="w"> </span><span class="c1">// [xsp+8h] [xbp-28h]</span>
<span class="w">  </span><span class="n">jclass</span><span class="w"> </span><span class="n">clsAB_3</span><span class="p">;</span><span class="w"> </span><span class="c1">// [xsp+10h] [xbp-20h]</span>
<span class="w">  </span><span class="n">jclass</span><span class="w"> </span><span class="n">clsAB_2</span><span class="p">;</span><span class="w"> </span><span class="c1">// [xsp+18h] [xbp-18h]</span>
<span class="w">  </span><span class="kt">void</span><span class="w"> </span><span class="o">*</span><span class="n">jUserIdJStrRef</span><span class="p">;</span><span class="w"> </span><span class="c1">// [xsp+18h] [xbp-18h]</span>

<span class="w">  </span><span class="n">bookIdCStr</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="kt">char</span><span class="w"> </span><span class="o">*</span><span class="p">)</span><span class="n">malloc</span><span class="p">(</span><span class="mh">0x40u</span><span class="p">);</span>
<span class="w">  </span><span class="o">*</span><span class="p">(</span><span class="n">_OWORD</span><span class="w"> </span><span class="o">*</span><span class="p">)</span><span class="n">bookIdCStr</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0u</span><span class="p">;</span>
<span class="w">  </span><span class="o">*</span><span class="p">((</span><span class="n">_OWORD</span><span class="w"> </span><span class="o">*</span><span class="p">)</span><span class="n">bookIdCStr</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0u</span><span class="p">;</span>
<span class="w">  </span><span class="o">*</span><span class="p">((</span><span class="n">_OWORD</span><span class="w"> </span><span class="o">*</span><span class="p">)</span><span class="n">bookIdCStr</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">2</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0u</span><span class="p">;</span>
<span class="w">  </span><span class="o">*</span><span class="p">((</span><span class="n">_OWORD</span><span class="w"> </span><span class="o">*</span><span class="p">)</span><span class="n">bookIdCStr</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">3</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0u</span><span class="p">;</span>
<span class="w">  </span><span class="n">sub_1230</span><span class="p">((</span><span class="kr">__int64</span><span class="p">)</span><span class="n">bookIdCStr</span><span class="p">,</span><span class="w"> </span><span class="mf">64L</span><span class="n">L</span><span class="p">,</span><span class="w"> </span><span class="p">(</span><span class="kr">__int64</span><span class="p">)</span><span class="s">&quot;%lld&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">bookIdLong</span><span class="p">);</span>

<span class="w">  </span><span class="n">chapterIdCStr</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="kt">char</span><span class="w"> </span><span class="o">*</span><span class="p">)</span><span class="n">malloc</span><span class="p">(</span><span class="mh">0x40u</span><span class="p">);</span>
<span class="w">  </span><span class="o">*</span><span class="p">(</span><span class="n">_OWORD</span><span class="w"> </span><span class="o">*</span><span class="p">)</span><span class="n">chapterIdCStr</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0u</span><span class="p">;</span>
<span class="w">  </span><span class="o">*</span><span class="p">((</span><span class="n">_OWORD</span><span class="w"> </span><span class="o">*</span><span class="p">)</span><span class="n">chapterIdCStr</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0u</span><span class="p">;</span>
<span class="w">  </span><span class="o">*</span><span class="p">((</span><span class="n">_OWORD</span><span class="w"> </span><span class="o">*</span><span class="p">)</span><span class="n">chapterIdCStr</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">2</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0u</span><span class="p">;</span>
<span class="w">  </span><span class="o">*</span><span class="p">((</span><span class="n">_OWORD</span><span class="w"> </span><span class="o">*</span><span class="p">)</span><span class="n">chapterIdCStr</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">3</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0u</span><span class="p">;</span>
<span class="w">  </span><span class="n">sub_1230</span><span class="p">((</span><span class="kr">__int64</span><span class="p">)</span><span class="n">chapterIdCStr</span><span class="p">,</span><span class="w"> </span><span class="mf">64L</span><span class="n">L</span><span class="p">,</span><span class="w"> </span><span class="p">(</span><span class="kr">__int64</span><span class="p">)</span><span class="s">&quot;%lld&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">chapterIdLong</span><span class="p">);</span>

<span class="w">  </span><span class="n">userIdCStr</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="k">const</span><span class="w"> </span><span class="kt">char</span><span class="w"> </span><span class="o">*</span><span class="p">)</span><span class="n">malloc</span><span class="p">(</span><span class="mh">0x40u</span><span class="p">);</span>
<span class="w">  </span><span class="o">*</span><span class="p">(</span><span class="n">_OWORD</span><span class="w"> </span><span class="o">*</span><span class="p">)</span><span class="n">userIdCStr</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0u</span><span class="p">;</span>
<span class="w">  </span><span class="o">*</span><span class="p">((</span><span class="n">_OWORD</span><span class="w"> </span><span class="o">*</span><span class="p">)</span><span class="n">userIdCStr</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0u</span><span class="p">;</span>
<span class="w">  </span><span class="o">*</span><span class="p">((</span><span class="n">_OWORD</span><span class="w"> </span><span class="o">*</span><span class="p">)</span><span class="n">userIdCStr</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">2</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0u</span><span class="p">;</span>
<span class="w">  </span><span class="o">*</span><span class="p">((</span><span class="n">_OWORD</span><span class="w"> </span><span class="o">*</span><span class="p">)</span><span class="n">userIdCStr</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">3</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0u</span><span class="p">;</span>
<span class="w">  </span><span class="n">sub_1230</span><span class="p">((</span><span class="kr">__int64</span><span class="p">)</span><span class="n">userIdCStr</span><span class="p">,</span><span class="w"> </span><span class="mf">64L</span><span class="n">L</span><span class="p">,</span><span class="w"> </span><span class="p">(</span><span class="kr">__int64</span><span class="p">)</span><span class="s">&quot;%lld&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">userIdLong</span><span class="p">);</span>

<span class="w">  </span><span class="n">secBuffer1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">malloc</span><span class="p">(</span><span class="mh">0xFFu</span><span class="p">);</span>
<span class="w">  </span><span class="o">*</span><span class="n">secBuffer1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0u</span><span class="p">;</span>
<span class="w">  </span><span class="n">secBuffer1</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0u</span><span class="p">;</span>
<span class="w">  </span><span class="n">secBuffer1</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0u</span><span class="p">;</span>
<span class="w">  </span><span class="n">secBuffer1</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0u</span><span class="p">;</span>
<span class="w">  </span><span class="n">secBuffer1</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0u</span><span class="p">;</span>
<span class="w">  </span><span class="n">secBuffer1</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0u</span><span class="p">;</span>
<span class="w">  </span><span class="n">secBuffer1</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0u</span><span class="p">;</span>
<span class="w">  </span><span class="n">secBuffer1</span><span class="p">[</span><span class="mi">7</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0u</span><span class="p">;</span>
<span class="w">  </span><span class="n">secBuffer1</span><span class="p">[</span><span class="mi">8</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0u</span><span class="p">;</span>
<span class="w">  </span><span class="n">secBuffer1</span><span class="p">[</span><span class="mi">9</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0u</span><span class="p">;</span>
<span class="w">  </span><span class="n">secBuffer1</span><span class="p">[</span><span class="mi">10</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0u</span><span class="p">;</span>
<span class="w">  </span><span class="n">secBuffer1</span><span class="p">[</span><span class="mi">11</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0u</span><span class="p">;</span>
<span class="w">  </span><span class="n">secBuffer1</span><span class="p">[</span><span class="mi">12</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0u</span><span class="p">;</span>
<span class="w">  </span><span class="n">secBuffer1</span><span class="p">[</span><span class="mi">13</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0u</span><span class="p">;</span>
<span class="w">  </span><span class="n">secBuffer1</span><span class="p">[</span><span class="mi">14</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0u</span><span class="p">;</span>
<span class="w">  </span><span class="o">*</span><span class="p">(</span><span class="n">_OWORD</span><span class="w"> </span><span class="o">*</span><span class="p">)((</span><span class="kt">char</span><span class="w"> </span><span class="o">*</span><span class="p">)</span><span class="n">secBuffer1</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">239</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0u</span><span class="p">;</span>

<span class="w">  </span><span class="n">secBuffer2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">malloc</span><span class="p">(</span><span class="mh">0xFFu</span><span class="p">);</span>
<span class="w">  </span><span class="o">*</span><span class="n">secBuffer2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0u</span><span class="p">;</span>
<span class="w">  </span><span class="n">secBuffer2</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0u</span><span class="p">;</span>
<span class="w">  </span><span class="n">secBuffer2</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0u</span><span class="p">;</span>
<span class="w">  </span><span class="n">secBuffer2</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0u</span><span class="p">;</span>
<span class="w">  </span><span class="n">secBuffer2</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0u</span><span class="p">;</span>
<span class="w">  </span><span class="n">secBuffer2</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0u</span><span class="p">;</span>
<span class="w">  </span><span class="n">secBuffer2</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0u</span><span class="p">;</span>
<span class="w">  </span><span class="n">secBuffer2</span><span class="p">[</span><span class="mi">7</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0u</span><span class="p">;</span>
<span class="w">  </span><span class="n">secBuffer2</span><span class="p">[</span><span class="mi">8</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0u</span><span class="p">;</span>
<span class="w">  </span><span class="n">secBuffer2</span><span class="p">[</span><span class="mi">9</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0u</span><span class="p">;</span>
<span class="w">  </span><span class="n">secBuffer2</span><span class="p">[</span><span class="mi">10</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0u</span><span class="p">;</span>
<span class="w">  </span><span class="n">secBuffer2</span><span class="p">[</span><span class="mi">11</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0u</span><span class="p">;</span>
<span class="w">  </span><span class="n">secBuffer2</span><span class="p">[</span><span class="mi">12</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0u</span><span class="p">;</span>
<span class="w">  </span><span class="n">secBuffer2</span><span class="p">[</span><span class="mi">13</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0u</span><span class="p">;</span>
<span class="w">  </span><span class="n">secBuffer2</span><span class="p">[</span><span class="mi">14</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0u</span><span class="p">;</span>
<span class="w">  </span><span class="o">*</span><span class="p">(</span><span class="n">_OWORD</span><span class="w"> </span><span class="o">*</span><span class="p">)((</span><span class="kt">char</span><span class="w"> </span><span class="o">*</span><span class="p">)</span><span class="n">secBuffer2</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">239</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0u</span><span class="p">;</span>

<span class="w">  </span><span class="n">sha2KeyBufArea</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">malloc</span><span class="p">(</span><span class="mh">0xFFu</span><span class="p">);</span>
<span class="w">  </span><span class="o">*</span><span class="n">sha2KeyBufArea</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0u</span><span class="p">;</span>
<span class="w">  </span><span class="n">sha2KeyBufArea</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0u</span><span class="p">;</span>
<span class="w">  </span><span class="n">sha2KeyBufArea</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0u</span><span class="p">;</span>
<span class="w">  </span><span class="n">sha2KeyBufArea</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0u</span><span class="p">;</span>
<span class="w">  </span><span class="n">sha2KeyBufArea</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0u</span><span class="p">;</span>
<span class="w">  </span><span class="n">sha2KeyBufArea</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0u</span><span class="p">;</span>
<span class="w">  </span><span class="n">sha2KeyBufArea</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0u</span><span class="p">;</span>
<span class="w">  </span><span class="n">sha2KeyBufArea</span><span class="p">[</span><span class="mi">7</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0u</span><span class="p">;</span>
<span class="w">  </span><span class="n">sha2KeyBufArea</span><span class="p">[</span><span class="mi">8</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0u</span><span class="p">;</span>
<span class="w">  </span><span class="n">sha2KeyBufArea</span><span class="p">[</span><span class="mi">9</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0u</span><span class="p">;</span>
<span class="w">  </span><span class="n">sha2KeyBufArea</span><span class="p">[</span><span class="mi">10</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0u</span><span class="p">;</span>
<span class="w">  </span><span class="n">sha2KeyBufArea</span><span class="p">[</span><span class="mi">11</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0u</span><span class="p">;</span>
<span class="w">  </span><span class="n">sha2KeyBufArea</span><span class="p">[</span><span class="mi">12</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0u</span><span class="p">;</span>
<span class="w">  </span><span class="n">sha2KeyBufArea</span><span class="p">[</span><span class="mi">13</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0u</span><span class="p">;</span>
<span class="w">  </span><span class="n">sha2KeyBufArea</span><span class="p">[</span><span class="mi">14</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0u</span><span class="p">;</span>
<span class="w">  </span><span class="o">*</span><span class="p">(</span><span class="n">_OWORD</span><span class="w"> </span><span class="o">*</span><span class="p">)((</span><span class="kt">char</span><span class="w"> </span><span class="o">*</span><span class="p">)</span><span class="n">sha2KeyBufArea</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">239</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0u</span><span class="p">;</span>

<span class="w">  </span><span class="n">sha2KeyCStr</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="k">const</span><span class="w"> </span><span class="kt">char</span><span class="w"> </span><span class="o">*</span><span class="p">)</span><span class="n">sha2KeyBufArea</span><span class="p">;</span>

<span class="w">  </span><span class="n">clsAB_1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="o">*</span><span class="n">env</span><span class="p">)</span><span class="o">-&gt;</span><span class="n">FindClass</span><span class="p">(</span><span class="n">env</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;a/b&quot;</span><span class="p">);</span>
<span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="o">!</span><span class="n">clsAB_1</span><span class="w"> </span><span class="p">)</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="mf">0L</span><span class="n">L</span><span class="p">;</span>
<span class="w">  </span><span class="n">clsAB_ref1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">clsAB_1</span><span class="p">;</span>

<span class="w">  </span><span class="n">clsAB_2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="o">*</span><span class="n">env</span><span class="p">)</span><span class="o">-&gt;</span><span class="n">FindClass</span><span class="p">(</span><span class="n">env</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;a/b&quot;</span><span class="p">);</span>
<span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="o">!</span><span class="n">clsAB_2</span><span class="w"> </span><span class="p">)</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="mf">0L</span><span class="n">L</span><span class="p">;</span>

<span class="w">  </span><span class="n">clsAB_3</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="o">*</span><span class="n">env</span><span class="p">)</span><span class="o">-&gt;</span><span class="n">FindClass</span><span class="p">(</span><span class="n">env</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;a/b&quot;</span><span class="p">);</span>
<span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="o">!</span><span class="n">clsAB_3</span><span class="w"> </span><span class="p">)</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="mf">0L</span><span class="n">L</span><span class="p">;</span>

<span class="w">  </span><span class="n">__android_log_print</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;QDReader_Jni&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;JNI:0&quot;</span><span class="p">);</span>
<span class="w">  </span><span class="n">imeiCStr</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="o">*</span><span class="n">env</span><span class="p">)</span><span class="o">-&gt;</span><span class="n">GetStringUTFChars</span><span class="p">(</span><span class="n">env</span><span class="p">,</span><span class="w"> </span><span class="n">imei</span><span class="p">,</span><span class="w"> </span><span class="mf">0L</span><span class="n">L</span><span class="p">);</span>
<span class="w">  </span><span class="n">__android_log_print</span><span class="p">(</span>
<span class="w">    </span><span class="mi">3</span><span class="p">,</span>
<span class="w">    </span><span class="s">&quot;QDReader_Jni&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="s">&quot;bookid: %s,chapterid: %s,userid: %s,imei: %s&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="n">bookIdCStr</span><span class="p">,</span>
<span class="w">    </span><span class="n">chapterIdCStr</span><span class="p">,</span>
<span class="w">    </span><span class="n">userIdCStr</span><span class="p">,</span>
<span class="w">    </span><span class="n">imeiCStr</span><span class="p">);</span>
<span class="w">  </span><span class="n">__android_log_print</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;QDReader_Jni&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;JNI:1&quot;</span><span class="p">);</span>

<span class="w">  </span><span class="n">__strcpy_chk</span><span class="p">(</span><span class="n">secBuffer1</span><span class="p">,</span><span class="w"> </span><span class="n">userIdCStr</span><span class="p">,</span><span class="w"> </span><span class="mf">255L</span><span class="n">L</span><span class="p">);</span>
<span class="w">  </span><span class="n">imeiCStrRef</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">imeiCStr</span><span class="p">;</span>
<span class="w">  </span><span class="n">ptrAfterFirstConcat</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="kt">char</span><span class="w"> </span><span class="o">*</span><span class="p">)</span><span class="n">__strcat_chk</span><span class="p">(</span><span class="n">secBuffer1</span><span class="p">,</span><span class="w"> </span><span class="n">imeiCStr</span><span class="p">,</span><span class="w"> </span><span class="mf">255L</span><span class="n">L</span><span class="p">);</span>
<span class="w">  </span><span class="n">ptrAfterChapterConcat</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">strcat</span><span class="p">(</span><span class="n">ptrAfterFirstConcat</span><span class="p">,</span><span class="w"> </span><span class="n">chapterIdCStr</span><span class="p">);</span>
<span class="w">  </span><span class="n">strcpy</span><span class="p">(</span><span class="o">&amp;</span><span class="n">ptrAfterFirstConcat</span><span class="p">[</span><span class="n">strlen</span><span class="p">(</span><span class="n">ptrAfterChapterConcat</span><span class="p">)],</span><span class="w"> </span><span class="s">&quot;2EEE1433A152E84B3756301D8FA3E69A&quot;</span><span class="p">);</span>
<span class="w">  </span><span class="n">__android_log_print</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;QDReader_Jni&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;JNI:2&quot;</span><span class="p">);</span>

<span class="w">  </span><span class="n">jSec1Str</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="o">*</span><span class="n">env</span><span class="p">)</span><span class="o">-&gt;</span><span class="n">NewStringUTF</span><span class="p">(</span><span class="n">env</span><span class="p">,</span><span class="w"> </span><span class="n">secBuffer1</span><span class="p">);</span>
<span class="w">  </span><span class="n">__android_log_print</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;QDReader_Jni&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;JNI:3&quot;</span><span class="p">);</span>

<span class="w">  </span><span class="n">mid_s</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="o">*</span><span class="n">env</span><span class="p">)</span><span class="o">-&gt;</span><span class="n">GetStaticMethodID</span><span class="p">(</span><span class="n">env</span><span class="p">,</span><span class="w"> </span><span class="n">clsAB_ref1</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;s&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;(Ljava/lang/String;Ljava/lang/String;)Ljava/lang/String;&quot;</span><span class="p">);</span>
<span class="w">  </span><span class="n">__android_log_print</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;QDReader_Jni&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;JNI:4&quot;</span><span class="p">);</span>
<span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="o">!</span><span class="n">mid_s</span><span class="w"> </span><span class="p">)</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="mf">0L</span><span class="n">L</span><span class="p">;</span>
<span class="w">  </span><span class="n">__android_log_print</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;QDReader_Jni&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;sha1id:%d&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">mid_s</span><span class="p">);</span>
<span class="w">  </span><span class="n">__android_log_print</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;QDReader_Jni&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;JNI:5&quot;</span><span class="p">);</span>

<span class="w">  </span><span class="n">jSha1Key1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="o">*</span><span class="n">env</span><span class="p">)</span><span class="o">-&gt;</span><span class="n">CallStaticObjectMethod</span><span class="p">(</span><span class="n">env</span><span class="p">,</span><span class="w"> </span><span class="n">clsAB_ref1</span><span class="p">,</span><span class="w"> </span><span class="n">mid_s</span><span class="p">,</span><span class="w"> </span><span class="n">imei</span><span class="p">,</span><span class="w"> </span><span class="n">jSec1Str</span><span class="p">);</span>
<span class="w">  </span><span class="p">(</span><span class="o">*</span><span class="n">env</span><span class="p">)</span><span class="o">-&gt;</span><span class="n">ReleaseStringUTFChars</span><span class="p">(</span><span class="n">env</span><span class="p">,</span><span class="w"> </span><span class="n">jSec1Str</span><span class="p">,</span><span class="w"> </span><span class="p">(</span><span class="k">const</span><span class="w"> </span><span class="kt">char</span><span class="w"> </span><span class="o">*</span><span class="p">)</span><span class="n">secBuffer1</span><span class="p">);</span>
<span class="w">  </span><span class="n">__android_log_print</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;QDReader_Jni&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;JNI:6&quot;</span><span class="p">);</span>

<span class="w">  </span><span class="n">sha1Key1CStr</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="o">*</span><span class="n">env</span><span class="p">)</span><span class="o">-&gt;</span><span class="n">GetStringUTFChars</span><span class="p">(</span><span class="n">env</span><span class="p">,</span><span class="w"> </span><span class="n">jSha1Key1</span><span class="p">,</span><span class="w"> </span><span class="mf">0L</span><span class="n">L</span><span class="p">);</span>
<span class="w">  </span><span class="n">__android_log_print</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;QDReader_Jni&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;sha1key1 = %s&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">sha1Key1CStr</span><span class="p">);</span>
<span class="w">  </span><span class="n">__android_log_print</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;QDReader_Jni&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;JNI:7&quot;</span><span class="p">);</span>

<span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">strlen</span><span class="p">(</span><span class="n">sha1Key1CStr</span><span class="p">)</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mh">0x18uLL</span><span class="w"> </span><span class="p">)</span>
<span class="w">  </span><span class="p">{</span>
<span class="w">    </span><span class="n">memset</span><span class="p">(</span><span class="n">gShaKeyBuf</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="k">sizeof</span><span class="p">(</span><span class="n">gShaKeyBuf</span><span class="p">));</span>
<span class="w">    </span><span class="n">strncpy</span><span class="p">(</span><span class="n">gShaKeyBuf</span><span class="p">,</span><span class="w"> </span><span class="n">sha1Key1CStr</span><span class="p">,</span><span class="w"> </span><span class="mh">0x18u</span><span class="p">);</span>
<span class="w">  </span><span class="p">}</span>
<span class="w">  </span><span class="n">__android_log_print</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;QDReader_Jni&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;JNI:8 sha1key2:%s sha1key1:%s&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">gShaKeyBuf</span><span class="p">,</span><span class="w"> </span><span class="n">sha1Key1CStr</span><span class="p">);</span>
<span class="w">  </span><span class="p">(</span><span class="o">*</span><span class="n">env</span><span class="p">)</span><span class="o">-&gt;</span><span class="n">ReleaseStringUTFChars</span><span class="p">(</span><span class="n">env</span><span class="p">,</span><span class="w"> </span><span class="n">jSha1Key1</span><span class="p">,</span><span class="w"> </span><span class="n">sha1Key1CStr</span><span class="p">);</span>

<span class="w">  </span><span class="n">jSha1Key1FinalStr</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="o">*</span><span class="n">env</span><span class="p">)</span><span class="o">-&gt;</span><span class="n">NewStringUTF</span><span class="p">(</span><span class="n">env</span><span class="p">,</span><span class="w"> </span><span class="n">gShaKeyBuf</span><span class="p">);</span>
<span class="w">  </span><span class="n">__android_log_print</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;QDReader_Jni&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;JNI:9&quot;</span><span class="p">);</span>

<span class="w">  </span><span class="n">__strcpy_chk</span><span class="p">(</span><span class="n">secBuffer2</span><span class="p">,</span><span class="w"> </span><span class="n">gShaKeyBuf</span><span class="p">,</span><span class="w"> </span><span class="mf">255L</span><span class="n">L</span><span class="p">);</span>
<span class="w">  </span><span class="n">__strcat_chk</span><span class="p">(</span><span class="n">secBuffer2</span><span class="p">,</span><span class="w"> </span><span class="n">imeiCStrRef</span><span class="p">,</span><span class="w"> </span><span class="mf">255L</span><span class="n">L</span><span class="p">);</span>
<span class="w">  </span><span class="n">__android_log_print</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;QDReader_Jni&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;JNI:10&quot;</span><span class="p">);</span>

<span class="w">  </span><span class="n">jSec2Str</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="o">*</span><span class="n">env</span><span class="p">)</span><span class="o">-&gt;</span><span class="n">NewStringUTF</span><span class="p">(</span><span class="n">env</span><span class="p">,</span><span class="w"> </span><span class="n">secBuffer2</span><span class="p">);</span>
<span class="w">  </span><span class="n">__android_log_print</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;QDReader_Jni&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;JNI:11&quot;</span><span class="p">);</span>

<span class="w">  </span><span class="n">mid_m</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="o">*</span><span class="n">env</span><span class="p">)</span><span class="o">-&gt;</span><span class="n">GetStaticMethodID</span><span class="p">(</span><span class="n">env</span><span class="p">,</span><span class="w"> </span><span class="n">clsAB_2</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;m&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;(Ljava/lang/String;Ljava/lang/String;)Ljava/lang/String;&quot;</span><span class="p">);</span>
<span class="w">  </span><span class="n">__android_log_print</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;QDReader_Jni&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;JNI:12&quot;</span><span class="p">);</span>
<span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="o">!</span><span class="n">mid_m</span><span class="w"> </span><span class="p">)</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="mf">0L</span><span class="n">L</span><span class="p">;</span>
<span class="w">  </span><span class="n">__android_log_print</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;QDReader_Jni&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;JNI:13&quot;</span><span class="p">);</span>

<span class="w">  </span><span class="n">jUserIdJStr</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="o">*</span><span class="n">env</span><span class="p">)</span><span class="o">-&gt;</span><span class="n">NewStringUTF</span><span class="p">(</span><span class="n">env</span><span class="p">,</span><span class="w"> </span><span class="n">userIdCStr</span><span class="p">);</span>
<span class="w">  </span><span class="n">clsAB_ref2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">clsAB_2</span><span class="p">;</span>
<span class="w">  </span><span class="n">jUserIdJStrRef</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">jUserIdJStr</span><span class="p">;</span>
<span class="w">  </span><span class="n">jSha1Key2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="o">*</span><span class="n">env</span><span class="p">)</span><span class="o">-&gt;</span><span class="n">CallStaticObjectMethod</span><span class="p">(</span><span class="n">env</span><span class="p">,</span><span class="w"> </span><span class="n">clsAB_ref2</span><span class="p">,</span><span class="w"> </span><span class="n">mid_m</span><span class="p">);</span>
<span class="w">  </span><span class="p">(</span><span class="o">*</span><span class="n">env</span><span class="p">)</span><span class="o">-&gt;</span><span class="n">ReleaseStringUTFChars</span><span class="p">(</span><span class="n">env</span><span class="p">,</span><span class="w"> </span><span class="n">jSec2Str</span><span class="p">,</span><span class="w"> </span><span class="p">(</span><span class="k">const</span><span class="w"> </span><span class="kt">char</span><span class="w"> </span><span class="o">*</span><span class="p">)</span><span class="n">secBuffer2</span><span class="p">);</span>
<span class="w">  </span><span class="n">__android_log_print</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;QDReader_Jni&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;JNI:14&quot;</span><span class="p">);</span>

<span class="w">  </span><span class="n">sha1Key2CStr</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="o">*</span><span class="n">env</span><span class="p">)</span><span class="o">-&gt;</span><span class="n">GetStringUTFChars</span><span class="p">(</span><span class="n">env</span><span class="p">,</span><span class="w"> </span><span class="n">jSha1Key2</span><span class="p">,</span><span class="w"> </span><span class="mf">0L</span><span class="n">L</span><span class="p">);</span>
<span class="w">  </span><span class="n">__android_log_print</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;QDReader_Jni&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;JNI:15&quot;</span><span class="p">);</span>

<span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">strlen</span><span class="p">(</span><span class="n">sha1Key2CStr</span><span class="p">)</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mh">0x19uLL</span><span class="w"> </span><span class="p">)</span>
<span class="w">  </span><span class="p">{</span>
<span class="w">    </span><span class="n">__strcpy_chk</span><span class="p">(</span><span class="n">sha2KeyCStr</span><span class="p">,</span><span class="w"> </span><span class="n">sha1Key2CStr</span><span class="p">,</span><span class="w"> </span><span class="mf">255L</span><span class="n">L</span><span class="p">);</span>
<span class="w">  </span><span class="p">}</span>
<span class="w">  </span><span class="k">else</span>
<span class="w">  </span><span class="p">{</span>
<span class="w">    </span><span class="n">sha2KeyCStr</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">gShaKeyBuf</span><span class="p">;</span>
<span class="w">    </span><span class="n">memset</span><span class="p">(</span><span class="n">gShaKeyBuf</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="k">sizeof</span><span class="p">(</span><span class="n">gShaKeyBuf</span><span class="p">));</span>
<span class="w">    </span><span class="n">strncpy</span><span class="p">(</span><span class="n">gShaKeyBuf</span><span class="p">,</span><span class="w"> </span><span class="n">sha1Key2CStr</span><span class="p">,</span><span class="w"> </span><span class="mh">0x18u</span><span class="p">);</span>
<span class="w">  </span><span class="p">}</span>
<span class="w">  </span><span class="p">(</span><span class="o">*</span><span class="n">env</span><span class="p">)</span><span class="o">-&gt;</span><span class="n">ReleaseStringUTFChars</span><span class="p">(</span><span class="n">env</span><span class="p">,</span><span class="w"> </span><span class="n">jSha1Key2</span><span class="p">,</span><span class="w"> </span><span class="n">sha1Key2CStr</span><span class="p">);</span>
<span class="w">  </span><span class="n">__android_log_print</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;QDReader_Jni&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;JNI:16&quot;</span><span class="p">);</span>

<span class="w">  </span><span class="n">jSha2KeyJStr</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="o">*</span><span class="n">env</span><span class="p">)</span><span class="o">-&gt;</span><span class="n">NewStringUTF</span><span class="p">(</span><span class="n">env</span><span class="p">,</span><span class="w"> </span><span class="n">sha2KeyCStr</span><span class="p">);</span>
<span class="w">  </span><span class="n">__android_log_print</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;QDReader_Jni&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;JNI:17&quot;</span><span class="p">);</span>

<span class="w">  </span><span class="n">mid_d</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="o">*</span><span class="n">env</span><span class="p">)</span><span class="o">-&gt;</span><span class="n">GetStaticMethodID</span><span class="p">(</span><span class="n">env</span><span class="p">,</span><span class="w"> </span><span class="n">clsAB_3</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;d&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;([BLjava/lang/String;)[B&quot;</span><span class="p">);</span>
<span class="w">  </span><span class="n">__android_log_print</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;QDReader_Jni&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;JNI:18&quot;</span><span class="p">);</span>
<span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="o">!</span><span class="n">mid_d</span><span class="w"> </span><span class="p">)</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="mf">0L</span><span class="n">L</span><span class="p">;</span>
<span class="w">  </span><span class="n">__android_log_print</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;QDReader_Jni&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;JNI:19&quot;</span><span class="p">);</span>

<span class="w">  </span><span class="n">intermediateData1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="o">*</span><span class="n">env</span><span class="p">)</span><span class="o">-&gt;</span><span class="n">CallStaticObjectMethod</span><span class="p">(</span><span class="n">env</span><span class="p">,</span><span class="w"> </span><span class="n">clsAB_3</span><span class="p">,</span><span class="w"> </span><span class="n">mid_d</span><span class="p">,</span><span class="w"> </span><span class="n">dataArray</span><span class="p">,</span><span class="w"> </span><span class="n">jSha2KeyJStr</span><span class="p">);</span>
<span class="w">  </span><span class="n">__android_log_print</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;QDReader_Jni&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;JNI:20&quot;</span><span class="p">);</span>

<span class="w">  </span><span class="n">finalData</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="o">*</span><span class="n">env</span><span class="p">)</span><span class="o">-&gt;</span><span class="n">CallStaticObjectMethod</span><span class="p">(</span><span class="n">env</span><span class="p">,</span><span class="w"> </span><span class="n">clsAB_3</span><span class="p">,</span><span class="w"> </span><span class="n">mid_d</span><span class="p">,</span><span class="w"> </span><span class="n">intermediateData1</span><span class="p">,</span><span class="w"> </span><span class="n">jSha1Key1FinalStr</span><span class="p">);</span>
<span class="w">  </span><span class="n">__android_log_print</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;QDReader_Jni&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;JNI:21&quot;</span><span class="p">);</span>

<span class="w">  </span><span class="p">(</span><span class="o">*</span><span class="n">env</span><span class="p">)</span><span class="o">-&gt;</span><span class="n">ReleaseStringUTFChars</span><span class="p">(</span><span class="n">env</span><span class="p">,</span><span class="w"> </span><span class="n">imei</span><span class="p">,</span><span class="w"> </span><span class="n">imeiCStrRef</span><span class="p">);</span>
<span class="w">  </span><span class="n">__android_log_print</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;QDReader_Jni&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;JNI:22 %s&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">gShaKeyBuf</span><span class="p">);</span>
<span class="w">  </span><span class="n">__android_log_print</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;QDReader_Jni&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;JNI:23&quot;</span><span class="p">);</span>

<span class="w">  </span><span class="p">(</span><span class="o">*</span><span class="n">env</span><span class="p">)</span><span class="o">-&gt;</span><span class="n">ReleaseStringUTFChars</span><span class="p">(</span><span class="n">env</span><span class="p">,</span><span class="w"> </span><span class="n">jSha2KeyJStr</span><span class="p">,</span><span class="w"> </span><span class="n">sha2KeyCStr</span><span class="p">);</span>
<span class="w">  </span><span class="n">__android_log_print</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;QDReader_Jni&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;JNI:24&quot;</span><span class="p">);</span>

<span class="w">  </span><span class="p">(</span><span class="o">*</span><span class="n">env</span><span class="p">)</span><span class="o">-&gt;</span><span class="n">ReleaseStringUTFChars</span><span class="p">(</span><span class="n">env</span><span class="p">,</span><span class="w"> </span><span class="n">jUserIdJStrRef</span><span class="p">,</span><span class="w"> </span><span class="n">userIdCStr</span><span class="p">);</span>
<span class="w">  </span><span class="n">__android_log_print</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;QDReader_Jni&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;JNI:25&quot;</span><span class="p">);</span>

<span class="w">  </span><span class="n">free</span><span class="p">(</span><span class="n">bookIdCStr</span><span class="p">);</span>
<span class="w">  </span><span class="n">__android_log_print</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;QDReader_Jni&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;JNI:26&quot;</span><span class="p">);</span>

<span class="w">  </span><span class="n">free</span><span class="p">(</span><span class="n">chapterIdCStr</span><span class="p">);</span>
<span class="w">  </span><span class="n">__android_log_print</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;QDReader_Jni&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;JNI:27&quot;</span><span class="p">);</span>

<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="n">finalData</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div>
<p><code>package a</code>:</p>
<div class="highlight"><pre><span></span><code><span class="kn">package</span><span class="w"> </span><span class="nn">a</span><span class="p">;</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">android.content.Context</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">android.util.Base64</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">bf.cihai</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">com.qidian.QDReader.autotracker.bean.AutoTrackerItem</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">com.qidian.common.lib.Logger</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">com.qidian.common.lib.util.q0</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">java.security.NoSuchAlgorithmException</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">javax.crypto.Mac</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">javax.crypto.spec.SecretKeySpec</span><span class="p">;</span>

<span class="kd">public</span><span class="w"> </span><span class="kd">class</span> <span class="nc">b</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="kd">static</span><span class="w"> </span><span class="kd">final</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="n">CHARSET_ASCII</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;ascii&quot;</span><span class="p">;</span>
<span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="kd">static</span><span class="w"> </span><span class="kd">final</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="n">MAC_SHA1_NAME</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;HmacSHA1&quot;</span><span class="p">;</span>

<span class="w">    </span><span class="kd">static</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">try</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="n">System</span><span class="p">.</span><span class="na">loadLibrary</span><span class="p">(</span><span class="s">&quot;load-jni&quot;</span><span class="p">);</span>
<span class="w">        </span><span class="p">}</span><span class="w"> </span><span class="k">catch</span><span class="w"> </span><span class="p">(</span><span class="n">Exception</span><span class="w"> </span><span class="n">e10</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="n">e10</span><span class="p">.</span><span class="na">printStackTrace</span><span class="p">();</span>
<span class="w">        </span><span class="p">}</span><span class="w"> </span><span class="k">catch</span><span class="w"> </span><span class="p">(</span><span class="n">UnsatisfiedLinkError</span><span class="w"> </span><span class="n">e11</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="n">e11</span><span class="p">.</span><span class="na">printStackTrace</span><span class="p">();</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kd">static</span><span class="w"> </span><span class="kd">native</span><span class="w"> </span><span class="kt">byte</span><span class="o">[]</span><span class="w"> </span><span class="nf">b</span><span class="p">(</span><span class="kt">long</span><span class="w"> </span><span class="n">j10</span><span class="p">,</span><span class="w"> </span><span class="kt">long</span><span class="w"> </span><span class="n">j11</span><span class="p">,</span><span class="w"> </span><span class="kt">byte</span><span class="o">[]</span><span class="w"> </span><span class="n">bArr</span><span class="p">,</span><span class="w"> </span><span class="kt">long</span><span class="w"> </span><span class="n">j12</span><span class="p">,</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="n">str</span><span class="p">);</span>

<span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kd">static</span><span class="w"> </span><span class="kd">native</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="n">Context</span><span class="w"> </span><span class="n">context</span><span class="p">);</span>

<span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kd">static</span><span class="w"> </span><span class="kt">byte</span><span class="o">[]</span><span class="w"> </span><span class="nf">d</span><span class="p">(</span><span class="kt">byte</span><span class="o">[]</span><span class="w"> </span><span class="n">bArr</span><span class="p">,</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="n">str</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">try</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="k">return</span><span class="w"> </span><span class="n">cihai</span><span class="p">.</span><span class="na">search</span><span class="p">(</span><span class="n">bArr</span><span class="p">,</span><span class="w"> </span><span class="n">str</span><span class="p">);</span>
<span class="w">        </span><span class="p">}</span><span class="w"> </span><span class="k">catch</span><span class="w"> </span><span class="p">(</span><span class="n">Exception</span><span class="w"> </span><span class="n">e10</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="n">Logger</span><span class="p">.</span><span class="na">exception</span><span class="p">(</span><span class="n">e10</span><span class="p">);</span>
<span class="w">            </span><span class="k">return</span><span class="w"> </span><span class="kc">null</span><span class="p">;</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="kd">static</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="nf">encryptToSHA1</span><span class="p">(</span><span class="n">String</span><span class="w"> </span><span class="n">str</span><span class="p">,</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="n">str2</span><span class="p">)</span><span class="w"> </span><span class="kd">throws</span><span class="w"> </span><span class="n">Exception</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">SecretKeySpec</span><span class="w"> </span><span class="n">secretKeySpec</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">SecretKeySpec</span><span class="p">(</span><span class="n">str</span><span class="p">.</span><span class="na">getBytes</span><span class="p">(</span><span class="n">CHARSET_ASCII</span><span class="p">),</span><span class="w"> </span><span class="n">MAC_SHA1_NAME</span><span class="p">);</span>
<span class="w">        </span><span class="n">Mac</span><span class="w"> </span><span class="n">mac</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Mac</span><span class="p">.</span><span class="na">getInstance</span><span class="p">(</span><span class="n">MAC_SHA1_NAME</span><span class="p">);</span>
<span class="w">        </span><span class="n">mac</span><span class="p">.</span><span class="na">init</span><span class="p">(</span><span class="n">secretKeySpec</span><span class="p">);</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">String</span><span class="p">(</span><span class="n">Base64</span><span class="p">.</span><span class="na">encode</span><span class="p">(</span><span class="n">mac</span><span class="p">.</span><span class="na">doFinal</span><span class="p">(</span><span class="n">str2</span><span class="p">.</span><span class="na">getBytes</span><span class="p">(</span><span class="n">CHARSET_ASCII</span><span class="p">)),</span><span class="w"> </span><span class="mi">0</span><span class="p">));</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kd">static</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="nf">m</span><span class="p">(</span><span class="n">String</span><span class="w"> </span><span class="n">str</span><span class="p">,</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="n">str2</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">String</span><span class="w"> </span><span class="n">str3</span><span class="p">;</span>
<span class="w">        </span><span class="k">try</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="n">str3</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bf</span><span class="p">.</span><span class="na">a</span><span class="p">.</span><span class="na">judian</span><span class="p">(</span><span class="n">str</span><span class="p">,</span><span class="w"> </span><span class="n">str2</span><span class="p">);</span>
<span class="w">        </span><span class="p">}</span><span class="w"> </span><span class="k">catch</span><span class="w"> </span><span class="p">(</span><span class="n">NoSuchAlgorithmException</span><span class="w"> </span><span class="n">e10</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="n">e</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">e10</span><span class="p">;</span>
<span class="w">            </span><span class="n">str3</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">null</span><span class="p">;</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">        </span><span class="k">try</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">str3</span><span class="p">.</span><span class="na">length</span><span class="p">()</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="mi">24</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">                </span><span class="n">d5</span><span class="p">.</span><span class="na">cihai</span><span class="p">.</span><span class="na">p</span><span class="p">(</span><span class="k">new</span><span class="w"> </span><span class="n">AutoTrackerItem</span><span class="p">.</span><span class="na">Builder</span><span class="p">().</span><span class="na">setPn</span><span class="p">(</span><span class="s">&quot;OKR_b_m&quot;</span><span class="p">).</span><span class="na">setEx1</span><span class="p">(</span><span class="n">String</span><span class="p">.</span><span class="na">valueOf</span><span class="p">(</span><span class="n">str3</span><span class="p">.</span><span class="na">length</span><span class="p">())).</span><span class="na">setEx2</span><span class="p">(</span><span class="n">str</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s">&quot;/&quot;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">str2</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s">&quot;/&quot;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">str3</span><span class="p">).</span><span class="na">buildCol</span><span class="p">());</span>
<span class="w">            </span><span class="p">}</span>
<span class="w">        </span><span class="p">}</span><span class="w"> </span><span class="k">catch</span><span class="w"> </span><span class="p">(</span><span class="n">NoSuchAlgorithmException</span><span class="w"> </span><span class="n">e11</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="n">e</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">e11</span><span class="p">;</span>
<span class="w">            </span><span class="n">Logger</span><span class="p">.</span><span class="na">exception</span><span class="p">(</span><span class="n">e</span><span class="p">);</span>
<span class="w">            </span><span class="k">return</span><span class="w"> </span><span class="n">str3</span><span class="p">;</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">str3</span><span class="p">;</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kd">static</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="nf">s</span><span class="p">(</span><span class="n">String</span><span class="w"> </span><span class="n">str</span><span class="p">,</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="n">str2</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">String</span><span class="w"> </span><span class="n">str3</span><span class="p">;</span>
<span class="w">        </span><span class="k">try</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="n">str3</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">encryptToSHA1</span><span class="p">(</span><span class="n">str</span><span class="p">,</span><span class="w"> </span><span class="n">str2</span><span class="p">);</span>
<span class="w">            </span><span class="k">try</span><span class="w"> </span><span class="p">{</span>
<span class="w">                </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">str3</span><span class="p">.</span><span class="na">length</span><span class="p">()</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">24</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">                    </span><span class="k">return</span><span class="w"> </span><span class="n">str3</span><span class="p">;</span>
<span class="w">                </span><span class="p">}</span>
<span class="w">                </span><span class="n">d5</span><span class="p">.</span><span class="na">cihai</span><span class="p">.</span><span class="na">p</span><span class="p">(</span><span class="k">new</span><span class="w"> </span><span class="n">AutoTrackerItem</span><span class="p">.</span><span class="na">Builder</span><span class="p">().</span><span class="na">setPn</span><span class="p">(</span><span class="s">&quot;OKR_b_s&quot;</span><span class="p">).</span><span class="na">setEx1</span><span class="p">(</span><span class="n">String</span><span class="p">.</span><span class="na">valueOf</span><span class="p">(</span><span class="n">str3</span><span class="p">.</span><span class="na">length</span><span class="p">())).</span><span class="na">setEx2</span><span class="p">(</span><span class="n">str</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s">&quot;/&quot;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">str2</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s">&quot;/&quot;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">str3</span><span class="p">).</span><span class="na">buildCol</span><span class="p">());</span>
<span class="w">                </span><span class="k">return</span><span class="w"> </span><span class="n">q0</span><span class="p">.</span><span class="na">m</span><span class="p">(</span><span class="n">str3</span><span class="p">,</span><span class="w"> </span><span class="mi">24</span><span class="p">,</span><span class="w"> </span><span class="p">(</span><span class="kt">char</span><span class="p">)</span><span class="w"> </span><span class="mi">0</span><span class="p">);</span>
<span class="w">            </span><span class="p">}</span><span class="w"> </span><span class="k">catch</span><span class="w"> </span><span class="p">(</span><span class="n">Exception</span><span class="w"> </span><span class="n">e10</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">                </span><span class="n">e</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">e10</span><span class="p">;</span>
<span class="w">                </span><span class="n">Logger</span><span class="p">.</span><span class="na">exception</span><span class="p">(</span><span class="n">e</span><span class="p">);</span>
<span class="w">                </span><span class="k">return</span><span class="w"> </span><span class="n">str3</span><span class="p">;</span>
<span class="w">            </span><span class="p">}</span>
<span class="w">        </span><span class="p">}</span><span class="w"> </span><span class="k">catch</span><span class="w"> </span><span class="p">(</span><span class="n">Exception</span><span class="w"> </span><span class="n">e11</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="n">e</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">e11</span><span class="p">;</span>
<span class="w">            </span><span class="n">str3</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">null</span><span class="p">;</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div>
<p><code>q0.m</code>:</p>
<div class="highlight"><pre><span></span><code><span class="kd">public</span><span class="w"> </span><span class="kd">static</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="nf">m</span><span class="p">(</span><span class="n">String</span><span class="w"> </span><span class="n">str</span><span class="p">,</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">i10</span><span class="p">,</span><span class="w"> </span><span class="kt">char</span><span class="w"> </span><span class="n">c10</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">StringBuilder</span><span class="w"> </span><span class="n">sb</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">StringBuilder</span><span class="p">();</span>
<span class="w">    </span><span class="n">sb</span><span class="p">.</span><span class="na">append</span><span class="p">(</span><span class="n">str</span><span class="p">);</span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">length</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">i10</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">str</span><span class="p">.</span><span class="na">length</span><span class="p">();</span>
<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">i11</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">i11</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">length</span><span class="p">;</span><span class="w"> </span><span class="n">i11</span><span class="o">++</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">sb</span><span class="p">.</span><span class="na">append</span><span class="p">(</span><span class="n">c10</span><span class="p">);</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">sb</span><span class="p">.</span><span class="na">toString</span><span class="p">();</span>
<span class="p">}</span>
</code></pre></div>
<p><code>package bf</code>:</p>
<div class="highlight"><pre><span></span><code><span class="kn">package</span><span class="w"> </span><span class="nn">bf</span><span class="p">;</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">com.qidian.QDReader.qmethod.pandoraex.monitor.c</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">com.qidian.common.lib.Logger</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">java.nio.charset.StandardCharsets</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">javax.crypto.Cipher</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">javax.crypto.spec.IvParameterSpec</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">javax.crypto.spec.SecretKeySpec</span><span class="p">;</span>

<span class="kd">public</span><span class="w"> </span><span class="kd">class</span> <span class="nc">cihai</span><span class="w"> </span><span class="p">{</span>

<span class="w">    </span><span class="cm">/* renamed from: search, reason: collision with root package name */</span>
<span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="kd">static</span><span class="w"> </span><span class="kd">final</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="n">f1806search</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;bf.cihai&quot;</span><span class="p">;</span>

<span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kd">static</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="nf">cihai</span><span class="p">(</span><span class="n">String</span><span class="w"> </span><span class="n">str</span><span class="p">,</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="n">str2</span><span class="p">)</span><span class="w"> </span><span class="kd">throws</span><span class="w"> </span><span class="n">Exception</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">IvParameterSpec</span><span class="w"> </span><span class="n">ivParameterSpec</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">IvParameterSpec</span><span class="p">(</span><span class="k">new</span><span class="w"> </span><span class="kt">byte</span><span class="o">[</span><span class="mi">8</span><span class="o">]</span><span class="p">);</span>
<span class="w">        </span><span class="kt">byte</span><span class="o">[]</span><span class="w"> </span><span class="n">bytes</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">str2</span><span class="p">.</span><span class="na">getBytes</span><span class="p">(</span><span class="s">&quot;UTF-8&quot;</span><span class="p">);</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">bytes</span><span class="p">.</span><span class="na">length</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">16</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="kt">byte</span><span class="o">[]</span><span class="w"> </span><span class="n">bArr</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="kt">byte</span><span class="o">[</span><span class="mi">24</span><span class="o">]</span><span class="p">;</span>
<span class="w">            </span><span class="n">System</span><span class="p">.</span><span class="na">arraycopy</span><span class="p">(</span><span class="n">bytes</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="n">bArr</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">16</span><span class="p">);</span>
<span class="w">            </span><span class="n">System</span><span class="p">.</span><span class="na">arraycopy</span><span class="p">(</span><span class="n">bytes</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="n">bArr</span><span class="p">,</span><span class="w"> </span><span class="mi">16</span><span class="p">,</span><span class="w"> </span><span class="mi">8</span><span class="p">);</span>
<span class="w">            </span><span class="n">bytes</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bArr</span><span class="p">;</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">        </span><span class="n">SecretKeySpec</span><span class="w"> </span><span class="n">secretKeySpec</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">SecretKeySpec</span><span class="p">(</span><span class="n">bytes</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;DESede&quot;</span><span class="p">);</span>
<span class="w">        </span><span class="n">Cipher</span><span class="w"> </span><span class="n">cipher</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Cipher</span><span class="p">.</span><span class="na">getInstance</span><span class="p">(</span><span class="s">&quot;DESede/CBC/PKCS5Padding&quot;</span><span class="p">);</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">cipher</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="kc">null</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="k">return</span><span class="w"> </span><span class="s">&quot;&quot;</span><span class="p">;</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">        </span><span class="n">cipher</span><span class="p">.</span><span class="na">init</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">secretKeySpec</span><span class="p">,</span><span class="w"> </span><span class="n">ivParameterSpec</span><span class="p">);</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">search</span><span class="p">.</span><span class="na">judian</span><span class="p">(</span><span class="n">c</span><span class="p">.</span><span class="na">search</span><span class="p">(</span><span class="n">cipher</span><span class="p">,</span><span class="w"> </span><span class="n">str</span><span class="p">.</span><span class="na">getBytes</span><span class="p">()));</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kd">static</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="nf">judian</span><span class="p">(</span><span class="kt">byte</span><span class="o">[]</span><span class="w"> </span><span class="n">bArr</span><span class="p">,</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="n">str</span><span class="p">)</span><span class="w"> </span><span class="kd">throws</span><span class="w"> </span><span class="n">Exception</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">IvParameterSpec</span><span class="w"> </span><span class="n">ivParameterSpec</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">IvParameterSpec</span><span class="p">(</span><span class="s">&quot;01234567&quot;</span><span class="p">.</span><span class="na">getBytes</span><span class="p">(</span><span class="n">StandardCharsets</span><span class="p">.</span><span class="na">UTF_8</span><span class="p">));</span>
<span class="w">        </span><span class="kt">byte</span><span class="o">[]</span><span class="w"> </span><span class="n">bytes</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">str</span><span class="p">.</span><span class="na">getBytes</span><span class="p">(</span><span class="s">&quot;UTF-8&quot;</span><span class="p">);</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">bytes</span><span class="p">.</span><span class="na">length</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">16</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="kt">byte</span><span class="o">[]</span><span class="w"> </span><span class="n">bArr2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="kt">byte</span><span class="o">[</span><span class="mi">24</span><span class="o">]</span><span class="p">;</span>
<span class="w">            </span><span class="n">System</span><span class="p">.</span><span class="na">arraycopy</span><span class="p">(</span><span class="n">bytes</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="n">bArr2</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">16</span><span class="p">);</span>
<span class="w">            </span><span class="n">System</span><span class="p">.</span><span class="na">arraycopy</span><span class="p">(</span><span class="n">bytes</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="n">bArr2</span><span class="p">,</span><span class="w"> </span><span class="mi">16</span><span class="p">,</span><span class="w"> </span><span class="mi">8</span><span class="p">);</span>
<span class="w">            </span><span class="n">bytes</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bArr2</span><span class="p">;</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">        </span><span class="n">SecretKeySpec</span><span class="w"> </span><span class="n">secretKeySpec</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">SecretKeySpec</span><span class="p">(</span><span class="n">bytes</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;DESede&quot;</span><span class="p">);</span>
<span class="w">        </span><span class="n">Cipher</span><span class="w"> </span><span class="n">cipher</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Cipher</span><span class="p">.</span><span class="na">getInstance</span><span class="p">(</span><span class="s">&quot;DESede/CBC/PKCS5Padding&quot;</span><span class="p">);</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">cipher</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="kc">null</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="k">return</span><span class="w"> </span><span class="s">&quot;&quot;</span><span class="p">;</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">        </span><span class="n">cipher</span><span class="p">.</span><span class="na">init</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">secretKeySpec</span><span class="p">,</span><span class="w"> </span><span class="n">ivParameterSpec</span><span class="p">);</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">search</span><span class="p">.</span><span class="na">judian</span><span class="p">(</span><span class="n">c</span><span class="p">.</span><span class="na">search</span><span class="p">(</span><span class="n">cipher</span><span class="p">,</span><span class="w"> </span><span class="n">bArr</span><span class="p">));</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kd">static</span><span class="w"> </span><span class="kt">byte</span><span class="o">[]</span><span class="w"> </span><span class="nf">search</span><span class="p">(</span><span class="kt">byte</span><span class="o">[]</span><span class="w"> </span><span class="n">bArr</span><span class="p">,</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="n">str</span><span class="p">)</span><span class="w"> </span><span class="kd">throws</span><span class="w"> </span><span class="n">Exception</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">bArr</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="kc">null</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">str</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="kc">null</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="n">IvParameterSpec</span><span class="w"> </span><span class="n">ivParameterSpec</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">IvParameterSpec</span><span class="p">(</span><span class="k">new</span><span class="w"> </span><span class="kt">byte</span><span class="o">[</span><span class="mi">8</span><span class="o">]</span><span class="p">);</span>
<span class="w">            </span><span class="kt">byte</span><span class="o">[]</span><span class="w"> </span><span class="n">bytes</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">str</span><span class="p">.</span><span class="na">getBytes</span><span class="p">(</span><span class="s">&quot;UTF-8&quot;</span><span class="p">);</span>
<span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">bytes</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="kc">null</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">bytes</span><span class="p">.</span><span class="na">length</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">                </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">bytes</span><span class="p">.</span><span class="na">length</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">16</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">                    </span><span class="kt">byte</span><span class="o">[]</span><span class="w"> </span><span class="n">bArr2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="kt">byte</span><span class="o">[</span><span class="mi">24</span><span class="o">]</span><span class="p">;</span>
<span class="w">                    </span><span class="n">System</span><span class="p">.</span><span class="na">arraycopy</span><span class="p">(</span><span class="n">bytes</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="n">bArr2</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">16</span><span class="p">);</span>
<span class="w">                    </span><span class="n">System</span><span class="p">.</span><span class="na">arraycopy</span><span class="p">(</span><span class="n">bytes</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="n">bArr2</span><span class="p">,</span><span class="w"> </span><span class="mi">16</span><span class="p">,</span><span class="w"> </span><span class="mi">8</span><span class="p">);</span>
<span class="w">                    </span><span class="n">bytes</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bArr2</span><span class="p">;</span>
<span class="w">                </span><span class="p">}</span>
<span class="w">                </span><span class="n">Cipher</span><span class="w"> </span><span class="n">cipher</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Cipher</span><span class="p">.</span><span class="na">getInstance</span><span class="p">(</span><span class="s">&quot;DESede/CBC/PKCS5Padding&quot;</span><span class="p">);</span>
<span class="w">                </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">cipher</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="kc">null</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">                    </span><span class="n">Logger</span><span class="p">.</span><span class="na">e</span><span class="p">(</span><span class="n">f1806search</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;cipher is null&quot;</span><span class="p">);</span>
<span class="w">                    </span><span class="k">return</span><span class="w"> </span><span class="kc">null</span><span class="p">;</span>
<span class="w">                </span><span class="p">}</span>
<span class="w">                </span><span class="n">cipher</span><span class="p">.</span><span class="na">init</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">SecretKeySpec</span><span class="p">(</span><span class="n">bytes</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;DESede&quot;</span><span class="p">),</span><span class="w"> </span><span class="n">ivParameterSpec</span><span class="p">);</span>
<span class="w">                </span><span class="k">try</span><span class="w"> </span><span class="p">{</span>
<span class="w">                    </span><span class="k">return</span><span class="w"> </span><span class="n">c</span><span class="p">.</span><span class="na">search</span><span class="p">(</span><span class="n">cipher</span><span class="p">,</span><span class="w"> </span><span class="n">bArr</span><span class="p">);</span>
<span class="w">                </span><span class="p">}</span><span class="w"> </span><span class="k">catch</span><span class="w"> </span><span class="p">(</span><span class="n">Exception</span><span class="w"> </span><span class="n">e10</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">                    </span><span class="n">e10</span><span class="p">.</span><span class="na">printStackTrace</span><span class="p">();</span>
<span class="w">                    </span><span class="kt">int</span><span class="w"> </span><span class="n">length</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bArr</span><span class="p">.</span><span class="na">length</span><span class="p">;</span>
<span class="w">                    </span><span class="n">Logger</span><span class="p">.</span><span class="na">e</span><span class="p">(</span><span class="n">f1806search</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;decryptDES失败：&quot;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">str</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s">&quot;,&quot;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">length</span><span class="p">);</span>
<span class="w">                    </span><span class="k">return</span><span class="w"> </span><span class="kc">null</span><span class="p">;</span>
<span class="w">                </span><span class="p">}</span>
<span class="w">            </span><span class="p">}</span>
<span class="w">            </span><span class="n">Logger</span><span class="p">.</span><span class="na">e</span><span class="p">(</span><span class="n">f1806search</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;keyBytes is illegal&quot;</span><span class="p">);</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="kc">null</span><span class="p">;</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div>
<div class="highlight"><pre><span></span><code><span class="kn">package</span><span class="w"> </span><span class="nn">bf</span><span class="p">;</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">com.tencent.qcloud.core.util.IOUtils</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">java.security.MessageDigest</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">java.security.NoSuchAlgorithmException</span><span class="p">;</span>

<span class="kd">public</span><span class="w"> </span><span class="kd">class</span> <span class="nc">a</span><span class="w"> </span><span class="p">{</span>

<span class="w">    </span><span class="cm">/* renamed from: search, reason: collision with root package name */</span>
<span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="kd">static</span><span class="w"> </span><span class="kt">char</span><span class="o">[]</span><span class="w"> </span><span class="n">f1805search</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="sc">&#39;A&#39;</span><span class="p">,</span><span class="w"> </span><span class="sc">&#39;B&#39;</span><span class="p">,</span><span class="w"> </span><span class="sc">&#39;C&#39;</span><span class="p">,</span><span class="w"> </span><span class="sc">&#39;D&#39;</span><span class="p">,</span><span class="w"> </span><span class="sc">&#39;E&#39;</span><span class="p">,</span><span class="w"> </span><span class="sc">&#39;F&#39;</span><span class="p">,</span><span class="w"> </span><span class="sc">&#39;G&#39;</span><span class="p">,</span><span class="w"> </span><span class="sc">&#39;H&#39;</span><span class="p">,</span><span class="w"> </span><span class="sc">&#39;I&#39;</span><span class="p">,</span><span class="w"> </span><span class="sc">&#39;J&#39;</span><span class="p">,</span><span class="w"> </span><span class="sc">&#39;K&#39;</span><span class="p">,</span><span class="w"> </span><span class="sc">&#39;L&#39;</span><span class="p">,</span><span class="w"> </span><span class="sc">&#39;M&#39;</span><span class="p">,</span><span class="w"> </span><span class="sc">&#39;N&#39;</span><span class="p">,</span><span class="w"> </span><span class="sc">&#39;O&#39;</span><span class="p">,</span><span class="w"> </span><span class="sc">&#39;P&#39;</span><span class="p">,</span><span class="w"> </span><span class="sc">&#39;Q&#39;</span><span class="p">,</span><span class="w"> </span><span class="sc">&#39;R&#39;</span><span class="p">,</span><span class="w"> </span><span class="sc">&#39;S&#39;</span><span class="p">,</span><span class="w"> </span><span class="sc">&#39;T&#39;</span><span class="p">,</span><span class="w"> </span><span class="sc">&#39;U&#39;</span><span class="p">,</span><span class="w"> </span><span class="sc">&#39;V&#39;</span><span class="p">,</span><span class="w"> </span><span class="sc">&#39;W&#39;</span><span class="p">,</span><span class="w"> </span><span class="sc">&#39;X&#39;</span><span class="p">,</span><span class="w"> </span><span class="sc">&#39;Y&#39;</span><span class="p">,</span><span class="w"> </span><span class="sc">&#39;Z&#39;</span><span class="p">,</span><span class="w"> </span><span class="sc">&#39;a&#39;</span><span class="p">,</span><span class="w"> </span><span class="sc">&#39;b&#39;</span><span class="p">,</span><span class="w"> </span><span class="sc">&#39;c&#39;</span><span class="p">,</span><span class="w"> </span><span class="sc">&#39;d&#39;</span><span class="p">,</span><span class="w"> </span><span class="sc">&#39;e&#39;</span><span class="p">,</span><span class="w"> </span><span class="sc">&#39;f&#39;</span><span class="p">,</span><span class="w"> </span><span class="sc">&#39;g&#39;</span><span class="p">,</span><span class="w"> </span><span class="sc">&#39;h&#39;</span><span class="p">,</span><span class="w"> </span><span class="sc">&#39;i&#39;</span><span class="p">,</span><span class="w"> </span><span class="sc">&#39;j&#39;</span><span class="p">,</span><span class="w"> </span><span class="sc">&#39;k&#39;</span><span class="p">,</span><span class="w"> </span><span class="sc">&#39;l&#39;</span><span class="p">,</span><span class="w"> </span><span class="sc">&#39;m&#39;</span><span class="p">,</span><span class="w"> </span><span class="sc">&#39;n&#39;</span><span class="p">,</span><span class="w"> </span><span class="sc">&#39;o&#39;</span><span class="p">,</span><span class="w"> </span><span class="sc">&#39;p&#39;</span><span class="p">,</span><span class="w"> </span><span class="sc">&#39;q&#39;</span><span class="p">,</span><span class="w"> </span><span class="sc">&#39;r&#39;</span><span class="p">,</span><span class="w"> </span><span class="sc">&#39;s&#39;</span><span class="p">,</span><span class="w"> </span><span class="sc">&#39;t&#39;</span><span class="p">,</span><span class="w"> </span><span class="sc">&#39;u&#39;</span><span class="p">,</span><span class="w"> </span><span class="sc">&#39;v&#39;</span><span class="p">,</span><span class="w"> </span><span class="sc">&#39;w&#39;</span><span class="p">,</span><span class="w"> </span><span class="sc">&#39;x&#39;</span><span class="p">,</span><span class="w"> </span><span class="sc">&#39;y&#39;</span><span class="p">,</span><span class="w"> </span><span class="sc">&#39;z&#39;</span><span class="p">,</span><span class="w"> </span><span class="sc">&#39;0&#39;</span><span class="p">,</span><span class="w"> </span><span class="sc">&#39;1&#39;</span><span class="p">,</span><span class="w"> </span><span class="sc">&#39;2&#39;</span><span class="p">,</span><span class="w"> </span><span class="sc">&#39;3&#39;</span><span class="p">,</span><span class="w"> </span><span class="sc">&#39;4&#39;</span><span class="p">,</span><span class="w"> </span><span class="sc">&#39;5&#39;</span><span class="p">,</span><span class="w"> </span><span class="sc">&#39;6&#39;</span><span class="p">,</span><span class="w"> </span><span class="sc">&#39;7&#39;</span><span class="p">,</span><span class="w"> </span><span class="sc">&#39;8&#39;</span><span class="p">,</span><span class="w"> </span><span class="sc">&#39;9&#39;</span><span class="p">,</span><span class="w"> </span><span class="sc">&#39;+&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">IOUtils</span><span class="p">.</span><span class="na">DIR_SEPARATOR_UNIX</span><span class="p">};</span>

<span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kd">static</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="nf">a</span><span class="p">(</span><span class="n">String</span><span class="w"> </span><span class="n">str</span><span class="p">)</span><span class="w"> </span><span class="kd">throws</span><span class="w"> </span><span class="n">Exception</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="kt">byte</span><span class="o">[]</span><span class="w"> </span><span class="n">digest</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">MessageDigest</span><span class="p">.</span><span class="na">getInstance</span><span class="p">(</span><span class="s">&quot;MD5&quot;</span><span class="p">).</span><span class="na">digest</span><span class="p">(</span><span class="n">str</span><span class="p">.</span><span class="na">getBytes</span><span class="p">(</span><span class="s">&quot;UTF-8&quot;</span><span class="p">));</span>
<span class="w">        </span><span class="n">StringBuilder</span><span class="w"> </span><span class="n">sb</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">StringBuilder</span><span class="p">(</span><span class="n">digest</span><span class="p">.</span><span class="na">length</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mi">2</span><span class="p">);</span>
<span class="w">        </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">byte</span><span class="w"> </span><span class="n">b10</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">digest</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="kt">int</span><span class="w"> </span><span class="n">i10</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">b10</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="mi">255</span><span class="p">;</span>
<span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">i10</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">16</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">                </span><span class="n">sb</span><span class="p">.</span><span class="na">append</span><span class="p">(</span><span class="s">&quot;0&quot;</span><span class="p">);</span>
<span class="w">            </span><span class="p">}</span>
<span class="w">            </span><span class="n">sb</span><span class="p">.</span><span class="na">append</span><span class="p">(</span><span class="n">Integer</span><span class="p">.</span><span class="na">toHexString</span><span class="p">(</span><span class="n">i10</span><span class="p">));</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">sb</span><span class="p">.</span><span class="na">toString</span><span class="p">();</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="kd">static</span><span class="w"> </span><span class="kt">byte</span><span class="o">[]</span><span class="w"> </span><span class="nf">b</span><span class="p">(</span><span class="kt">byte</span><span class="o">[]</span><span class="w"> </span><span class="n">bArr</span><span class="p">)</span><span class="w"> </span><span class="kd">throws</span><span class="w"> </span><span class="n">NoSuchAlgorithmException</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">MessageDigest</span><span class="w"> </span><span class="n">messageDigest</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">MessageDigest</span><span class="p">.</span><span class="na">getInstance</span><span class="p">(</span><span class="s">&quot;MD5&quot;</span><span class="p">);</span>
<span class="w">        </span><span class="n">messageDigest</span><span class="p">.</span><span class="na">update</span><span class="p">(</span><span class="n">bArr</span><span class="p">);</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">messageDigest</span><span class="p">.</span><span class="na">digest</span><span class="p">();</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="kd">static</span><span class="w"> </span><span class="kt">byte</span><span class="o">[]</span><span class="w"> </span><span class="nf">cihai</span><span class="p">(</span><span class="kt">byte</span><span class="o">[]</span><span class="w"> </span><span class="n">bArr</span><span class="p">,</span><span class="w"> </span><span class="kt">byte</span><span class="o">[]</span><span class="w"> </span><span class="n">bArr2</span><span class="p">)</span><span class="w"> </span><span class="kd">throws</span><span class="w"> </span><span class="n">NoSuchAlgorithmException</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="kt">byte</span><span class="o">[]</span><span class="w"> </span><span class="n">bArr3</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="kt">byte</span><span class="o">[</span><span class="mi">64</span><span class="o">]</span><span class="p">;</span>
<span class="w">        </span><span class="kt">byte</span><span class="o">[]</span><span class="w"> </span><span class="n">bArr4</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="kt">byte</span><span class="o">[</span><span class="mi">64</span><span class="o">]</span><span class="p">;</span>
<span class="w">        </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">i10</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">i10</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">64</span><span class="p">;</span><span class="w"> </span><span class="n">i10</span><span class="o">++</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="n">bArr3</span><span class="o">[</span><span class="n">i10</span><span class="o">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">54</span><span class="p">;</span>
<span class="w">            </span><span class="n">bArr4</span><span class="o">[</span><span class="n">i10</span><span class="o">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">92</span><span class="p">;</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">        </span><span class="kt">byte</span><span class="o">[]</span><span class="w"> </span><span class="n">bArr5</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="kt">byte</span><span class="o">[</span><span class="mi">64</span><span class="o">]</span><span class="p">;</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">bArr</span><span class="p">.</span><span class="na">length</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">64</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="n">bArr</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">b</span><span class="p">(</span><span class="n">bArr</span><span class="p">);</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">        </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">i11</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">i11</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">bArr</span><span class="p">.</span><span class="na">length</span><span class="p">;</span><span class="w"> </span><span class="n">i11</span><span class="o">++</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="n">bArr5</span><span class="o">[</span><span class="n">i11</span><span class="o">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bArr</span><span class="o">[</span><span class="n">i11</span><span class="o">]</span><span class="p">;</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">bArr</span><span class="p">.</span><span class="na">length</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">64</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">length</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bArr</span><span class="p">.</span><span class="na">length</span><span class="p">;</span><span class="w"> </span><span class="n">length</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">64</span><span class="p">;</span><span class="w"> </span><span class="n">length</span><span class="o">++</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">                </span><span class="n">bArr5</span><span class="o">[</span><span class="n">length</span><span class="o">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<span class="w">            </span><span class="p">}</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">        </span><span class="kt">byte</span><span class="o">[]</span><span class="w"> </span><span class="n">bArr6</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="kt">byte</span><span class="o">[</span><span class="mi">64</span><span class="o">]</span><span class="p">;</span>
<span class="w">        </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">i12</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">i12</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">64</span><span class="p">;</span><span class="w"> </span><span class="n">i12</span><span class="o">++</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="n">bArr6</span><span class="o">[</span><span class="n">i12</span><span class="o">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="kt">byte</span><span class="p">)</span><span class="w"> </span><span class="p">(</span><span class="n">bArr5</span><span class="o">[</span><span class="n">i12</span><span class="o">]</span><span class="w"> </span><span class="o">^</span><span class="w"> </span><span class="n">bArr3</span><span class="o">[</span><span class="n">i12</span><span class="o">]</span><span class="p">);</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">        </span><span class="kt">byte</span><span class="o">[]</span><span class="w"> </span><span class="n">bArr7</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="kt">byte</span><span class="o">[</span><span class="n">bArr2</span><span class="p">.</span><span class="na">length</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">64</span><span class="o">]</span><span class="p">;</span>
<span class="w">        </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">i13</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">i13</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">64</span><span class="p">;</span><span class="w"> </span><span class="n">i13</span><span class="o">++</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="n">bArr7</span><span class="o">[</span><span class="n">i13</span><span class="o">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bArr6</span><span class="o">[</span><span class="n">i13</span><span class="o">]</span><span class="p">;</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">        </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">i14</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">i14</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">bArr2</span><span class="p">.</span><span class="na">length</span><span class="p">;</span><span class="w"> </span><span class="n">i14</span><span class="o">++</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="n">bArr7</span><span class="o">[</span><span class="n">i14</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">64</span><span class="o">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bArr2</span><span class="o">[</span><span class="n">i14</span><span class="o">]</span><span class="p">;</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">        </span><span class="kt">byte</span><span class="o">[]</span><span class="w"> </span><span class="n">b10</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">b</span><span class="p">(</span><span class="n">bArr7</span><span class="p">);</span>
<span class="w">        </span><span class="kt">byte</span><span class="o">[]</span><span class="w"> </span><span class="n">bArr8</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="kt">byte</span><span class="o">[</span><span class="mi">64</span><span class="o">]</span><span class="p">;</span>
<span class="w">        </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">i15</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">i15</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">64</span><span class="p">;</span><span class="w"> </span><span class="n">i15</span><span class="o">++</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="n">bArr8</span><span class="o">[</span><span class="n">i15</span><span class="o">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="kt">byte</span><span class="p">)</span><span class="w"> </span><span class="p">(</span><span class="n">bArr5</span><span class="o">[</span><span class="n">i15</span><span class="o">]</span><span class="w"> </span><span class="o">^</span><span class="w"> </span><span class="n">bArr4</span><span class="o">[</span><span class="n">i15</span><span class="o">]</span><span class="p">);</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">        </span><span class="kt">byte</span><span class="o">[]</span><span class="w"> </span><span class="n">bArr9</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="kt">byte</span><span class="o">[</span><span class="n">b10</span><span class="p">.</span><span class="na">length</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">64</span><span class="o">]</span><span class="p">;</span>
<span class="w">        </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">i16</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">i16</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">64</span><span class="p">;</span><span class="w"> </span><span class="n">i16</span><span class="o">++</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="n">bArr9</span><span class="o">[</span><span class="n">i16</span><span class="o">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bArr8</span><span class="o">[</span><span class="n">i16</span><span class="o">]</span><span class="p">;</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">        </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">i17</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">i17</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">b10</span><span class="p">.</span><span class="na">length</span><span class="p">;</span><span class="w"> </span><span class="n">i17</span><span class="o">++</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="n">bArr9</span><span class="o">[</span><span class="n">i17</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">64</span><span class="o">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">b10</span><span class="o">[</span><span class="n">i17</span><span class="o">]</span><span class="p">;</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">b</span><span class="p">(</span><span class="n">bArr9</span><span class="p">);</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kd">static</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="nf">judian</span><span class="p">(</span><span class="n">String</span><span class="w"> </span><span class="n">str</span><span class="p">,</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="n">str2</span><span class="p">)</span><span class="w"> </span><span class="kd">throws</span><span class="w"> </span><span class="n">NoSuchAlgorithmException</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">search</span><span class="p">(</span><span class="n">cihai</span><span class="p">(</span><span class="n">str</span><span class="p">.</span><span class="na">getBytes</span><span class="p">(),</span><span class="w"> </span><span class="n">str2</span><span class="p">.</span><span class="na">getBytes</span><span class="p">()));</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kd">static</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="nf">search</span><span class="p">(</span><span class="kt">byte</span><span class="o">[]</span><span class="w"> </span><span class="n">bArr</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">StringBuffer</span><span class="w"> </span><span class="n">stringBuffer</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">StringBuffer</span><span class="p">();</span>
<span class="w">        </span><span class="kt">int</span><span class="w"> </span><span class="n">length</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bArr</span><span class="p">.</span><span class="na">length</span><span class="p">;</span>
<span class="w">        </span><span class="kt">int</span><span class="w"> </span><span class="n">i10</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<span class="w">        </span><span class="k">while</span><span class="w"> </span><span class="p">(</span><span class="kc">true</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">i10</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="n">length</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">                </span><span class="k">break</span><span class="p">;</span>
<span class="w">            </span><span class="p">}</span>
<span class="w">            </span><span class="kt">int</span><span class="w"> </span><span class="n">i11</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">i10</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span>
<span class="w">            </span><span class="kt">int</span><span class="w"> </span><span class="n">i12</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bArr</span><span class="o">[</span><span class="n">i10</span><span class="o">]</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="mi">255</span><span class="p">;</span>
<span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">i11</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">length</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">                </span><span class="n">stringBuffer</span><span class="p">.</span><span class="na">append</span><span class="p">(</span><span class="n">f1805search</span><span class="o">[</span><span class="n">i12</span><span class="w"> </span><span class="o">&gt;&gt;&gt;</span><span class="w"> </span><span class="mi">2</span><span class="o">]</span><span class="p">);</span>
<span class="w">                </span><span class="n">stringBuffer</span><span class="p">.</span><span class="na">append</span><span class="p">(</span><span class="n">f1805search</span><span class="o">[</span><span class="p">(</span><span class="n">i12</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="mi">3</span><span class="p">)</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="mi">4</span><span class="o">]</span><span class="p">);</span>
<span class="w">                </span><span class="n">stringBuffer</span><span class="p">.</span><span class="na">append</span><span class="p">(</span><span class="s">&quot;==&quot;</span><span class="p">);</span>
<span class="w">                </span><span class="k">break</span><span class="p">;</span>
<span class="w">            </span><span class="p">}</span>
<span class="w">            </span><span class="kt">int</span><span class="w"> </span><span class="n">i13</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">i11</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span>
<span class="w">            </span><span class="kt">int</span><span class="w"> </span><span class="n">i14</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bArr</span><span class="o">[</span><span class="n">i11</span><span class="o">]</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="mi">255</span><span class="p">;</span>
<span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">i13</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">length</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">                </span><span class="n">stringBuffer</span><span class="p">.</span><span class="na">append</span><span class="p">(</span><span class="n">f1805search</span><span class="o">[</span><span class="n">i12</span><span class="w"> </span><span class="o">&gt;&gt;&gt;</span><span class="w"> </span><span class="mi">2</span><span class="o">]</span><span class="p">);</span>
<span class="w">                </span><span class="n">stringBuffer</span><span class="p">.</span><span class="na">append</span><span class="p">(</span><span class="n">f1805search</span><span class="o">[</span><span class="p">((</span><span class="n">i12</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="mi">3</span><span class="p">)</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="mi">4</span><span class="p">)</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="p">((</span><span class="n">i14</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="mi">240</span><span class="p">)</span><span class="w"> </span><span class="o">&gt;&gt;&gt;</span><span class="w"> </span><span class="mi">4</span><span class="p">)</span><span class="o">]</span><span class="p">);</span>
<span class="w">                </span><span class="n">stringBuffer</span><span class="p">.</span><span class="na">append</span><span class="p">(</span><span class="n">f1805search</span><span class="o">[</span><span class="p">(</span><span class="n">i14</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="mi">15</span><span class="p">)</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="mi">2</span><span class="o">]</span><span class="p">);</span>
<span class="w">                </span><span class="n">stringBuffer</span><span class="p">.</span><span class="na">append</span><span class="p">(</span><span class="s">&quot;=&quot;</span><span class="p">);</span>
<span class="w">                </span><span class="k">break</span><span class="p">;</span>
<span class="w">            </span><span class="p">}</span>
<span class="w">            </span><span class="kt">int</span><span class="w"> </span><span class="n">i15</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">i13</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span>
<span class="w">            </span><span class="kt">int</span><span class="w"> </span><span class="n">i16</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bArr</span><span class="o">[</span><span class="n">i13</span><span class="o">]</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="mi">255</span><span class="p">;</span>
<span class="w">            </span><span class="n">stringBuffer</span><span class="p">.</span><span class="na">append</span><span class="p">(</span><span class="n">f1805search</span><span class="o">[</span><span class="n">i12</span><span class="w"> </span><span class="o">&gt;&gt;&gt;</span><span class="w"> </span><span class="mi">2</span><span class="o">]</span><span class="p">);</span>
<span class="w">            </span><span class="n">stringBuffer</span><span class="p">.</span><span class="na">append</span><span class="p">(</span><span class="n">f1805search</span><span class="o">[</span><span class="p">((</span><span class="n">i12</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="mi">3</span><span class="p">)</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="mi">4</span><span class="p">)</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="p">((</span><span class="n">i14</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="mi">240</span><span class="p">)</span><span class="w"> </span><span class="o">&gt;&gt;&gt;</span><span class="w"> </span><span class="mi">4</span><span class="p">)</span><span class="o">]</span><span class="p">);</span>
<span class="w">            </span><span class="n">stringBuffer</span><span class="p">.</span><span class="na">append</span><span class="p">(</span><span class="n">f1805search</span><span class="o">[</span><span class="p">((</span><span class="n">i14</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="mi">15</span><span class="p">)</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="mi">2</span><span class="p">)</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="p">((</span><span class="n">i16</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="mi">192</span><span class="p">)</span><span class="w"> </span><span class="o">&gt;&gt;&gt;</span><span class="w"> </span><span class="mi">6</span><span class="p">)</span><span class="o">]</span><span class="p">);</span>
<span class="w">            </span><span class="n">stringBuffer</span><span class="p">.</span><span class="na">append</span><span class="p">(</span><span class="n">f1805search</span><span class="o">[</span><span class="n">i16</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="mi">63</span><span class="o">]</span><span class="p">);</span>
<span class="w">            </span><span class="n">i10</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">i15</span><span class="p">;</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">stringBuffer</span><span class="p">.</span><span class="na">toString</span><span class="p">();</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div>
<p><code>package com.qidian.QDReader.qmethod.pandoraex.monitor</code>:</p>
<div class="highlight"><pre><span></span><code><span class="kn">package</span><span class="w"> </span><span class="nn">com.qidian.QDReader.qmethod.pandoraex.monitor</span><span class="p">;</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">j</span><span class="n">$</span><span class="p">.</span><span class="na">util</span><span class="p">.</span><span class="na">concurrent</span><span class="p">.</span><span class="na">ConcurrentHashMap</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">java.security.MessageDigest</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">java.security.NoSuchAlgorithmException</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">javax.crypto.BadPaddingException</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">javax.crypto.Cipher</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">javax.crypto.IllegalBlockSizeException</span><span class="p">;</span>

<span class="kd">public</span><span class="w"> </span><span class="kd">class</span> <span class="nc">c</span><span class="w"> </span><span class="p">{</span>

<span class="w">    </span><span class="cm">/* renamed from: search, reason: collision with root package name */</span>
<span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="kd">static</span><span class="w"> </span><span class="n">ConcurrentHashMap</span><span class="o">&lt;</span><span class="n">String</span><span class="p">,</span><span class="w"> </span><span class="kt">byte</span><span class="o">[]&gt;</span><span class="w"> </span><span class="n">f26010search</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">ConcurrentHashMap</span><span class="o">&lt;&gt;</span><span class="p">();</span>

<span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kd">static</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">a</span><span class="p">(</span><span class="kt">byte</span><span class="o">[]</span><span class="w"> </span><span class="n">bArr</span><span class="p">,</span><span class="w"> </span><span class="kt">byte</span><span class="o">[]</span><span class="w"> </span><span class="n">bArr2</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">f26010search</span><span class="p">.</span><span class="na">put</span><span class="p">(</span><span class="n">judian</span><span class="p">(</span><span class="n">bArr</span><span class="p">),</span><span class="w"> </span><span class="n">bArr2</span><span class="p">);</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kd">static</span><span class="w"> </span><span class="kt">byte</span><span class="o">[]</span><span class="w"> </span><span class="nf">cihai</span><span class="p">(</span><span class="kt">byte</span><span class="o">[]</span><span class="w"> </span><span class="n">bArr</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="kt">byte</span><span class="o">[]</span><span class="w"> </span><span class="n">bArr2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">null</span><span class="p">;</span>
<span class="w">        </span><span class="k">while</span><span class="w"> </span><span class="p">(</span><span class="n">bArr</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="kc">null</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="n">bArr</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">f26010search</span><span class="p">.</span><span class="na">get</span><span class="p">(</span><span class="n">judian</span><span class="p">(</span><span class="n">bArr</span><span class="p">));</span>
<span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">bArr</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="kc">null</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">                </span><span class="n">bArr2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bArr</span><span class="p">;</span>
<span class="w">            </span><span class="p">}</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">bArr2</span><span class="p">;</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kd">static</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="nf">judian</span><span class="p">(</span><span class="kt">byte</span><span class="o">[]</span><span class="w"> </span><span class="n">bArr</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">try</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="kt">byte</span><span class="o">[]</span><span class="w"> </span><span class="n">digest</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">MessageDigest</span><span class="p">.</span><span class="na">getInstance</span><span class="p">(</span><span class="s">&quot;MD5&quot;</span><span class="p">).</span><span class="na">digest</span><span class="p">(</span><span class="n">bArr</span><span class="p">);</span>
<span class="w">            </span><span class="n">StringBuilder</span><span class="w"> </span><span class="n">sb</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">StringBuilder</span><span class="p">();</span>
<span class="w">            </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">byte</span><span class="w"> </span><span class="n">b10</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">digest</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">                </span><span class="n">sb</span><span class="p">.</span><span class="na">append</span><span class="p">(</span><span class="n">String</span><span class="p">.</span><span class="na">format</span><span class="p">(</span><span class="s">&quot;%02x&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">Byte</span><span class="p">.</span><span class="na">valueOf</span><span class="p">(</span><span class="n">b10</span><span class="p">)));</span>
<span class="w">            </span><span class="p">}</span>
<span class="w">            </span><span class="k">return</span><span class="w"> </span><span class="n">sb</span><span class="p">.</span><span class="na">toString</span><span class="p">();</span>
<span class="w">        </span><span class="p">}</span><span class="w"> </span><span class="k">catch</span><span class="w"> </span><span class="p">(</span><span class="n">NoSuchAlgorithmException</span><span class="w"> </span><span class="n">e10</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="k">throw</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">RuntimeException</span><span class="p">(</span><span class="s">&quot;MD5 algorithm is not available&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">e10</span><span class="p">);</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kd">static</span><span class="w"> </span><span class="kt">byte</span><span class="o">[]</span><span class="w"> </span><span class="nf">search</span><span class="p">(</span><span class="n">Cipher</span><span class="w"> </span><span class="n">cipher</span><span class="p">,</span><span class="w"> </span><span class="kt">byte</span><span class="o">[]</span><span class="w"> </span><span class="n">bArr</span><span class="p">)</span><span class="w"> </span><span class="kd">throws</span><span class="w"> </span><span class="n">IllegalBlockSizeException</span><span class="p">,</span><span class="w"> </span><span class="n">BadPaddingException</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="kt">byte</span><span class="o">[]</span><span class="w"> </span><span class="n">doFinal</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">cipher</span><span class="p">.</span><span class="na">doFinal</span><span class="p">(</span><span class="n">bArr</span><span class="p">);</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">com</span><span class="p">.</span><span class="na">qidian</span><span class="p">.</span><span class="na">QDReader</span><span class="p">.</span><span class="na">qmethod</span><span class="p">.</span><span class="na">pandoraex</span><span class="p">.</span><span class="na">core</span><span class="p">.</span><span class="na">ext</span><span class="p">.</span><span class="na">netcap</span><span class="p">.</span><span class="na">g</span><span class="p">.</span><span class="na">a</span><span class="p">())</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="n">a</span><span class="p">(</span><span class="n">doFinal</span><span class="p">,</span><span class="w"> </span><span class="n">bArr</span><span class="p">);</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">doFinal</span><span class="p">;</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div>
</details>
<p>在函数中意外发现该方法内部大量调用了 <code>__android_log_print</code> 打印中间变量 (如解密参数 / 密钥等)。</p>
<p>这使得不需要额外 Hook 函数, 也可以直接通过 logcat 查看解密过程中涉及的关键信息。</p>
<p>于是回头检查之前导出的 <code>logs.txt</code>, 使用关键词快速定位到相关日志内容:</p>
<div class="highlight"><pre><span></span><code>06-01 12:00:00.000  1234  4321 D QDReader_Jni: bookid: ****,chapterid: ***,userid: **,imei: ****
...
06-01 12:00:00.000  1234  4321 D QDReader_Jni: sha1id:****
...
06-01 12:00:00.000  1234  4321 D QDReader_Jni: sha1key1 = ****base64-key****
...
06-01 12:00:00.000  1234  4321 D QDReader_Jni: JNI:8 sha1key2:****key2**** sha1key1:****key1****
...
06-01 12:00:00.000  1234  4321 D QDReader_Jni: JNI:22 ****
</code></pre></div>
<p>结合日志输出与 Ghidra 中对 <code>Java_a_b_b</code> 的分析. 可以还原出等价的 Python 解密逻辑如下:</p>
<div class="highlight"><pre><span></span><code><span class="kn">import</span><span class="w"> </span><span class="nn">hashlib</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">hmac</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">base64</span><span class="w"> </span><span class="kn">import</span> <span class="n">b64encode</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">Crypto.Cipher</span><span class="w"> </span><span class="kn">import</span> <span class="n">DES3</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">Crypto.Util.Padding</span><span class="w"> </span><span class="kn">import</span> <span class="n">unpad</span>

<span class="n">_MAGIC</span> <span class="o">=</span> <span class="s2">&quot;2EEE1433A152E84B3756301D8FA3E69A&quot;</span>

<span class="k">def</span><span class="w"> </span><span class="nf">_pad_to_24</span><span class="p">(</span><span class="n">s</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Ensure the given string is exactly 24 characters long.</span>

<span class="sd">    :param s: Input string.</span>
<span class="sd">    :return: 24-character string.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">s</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="mi">24</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">s</span><span class="p">[:</span><span class="mi">24</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">s</span> <span class="o">+</span> <span class="p">(</span><span class="s2">&quot;</span><span class="se">\x00</span><span class="s2">&quot;</span> <span class="o">*</span> <span class="p">(</span><span class="mi">24</span> <span class="o">-</span> <span class="nb">len</span><span class="p">(</span><span class="n">s</span><span class="p">)))</span>

<span class="k">def</span><span class="w"> </span><span class="nf">_hmac_sha1</span><span class="p">(</span><span class="n">key</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">data</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Compute HMAC-SHA1 over `data` using `key`, Base64-encode the result,</span>
<span class="sd">    then truncate/pad to 24 characters.</span>

<span class="sd">    :param key: ASCII key string.</span>
<span class="sd">    :param data: ASCII data string.</span>
<span class="sd">    :return: 24-character Base64 HMAC-SHA1 string.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">digest</span> <span class="o">=</span> <span class="n">hmac</span><span class="o">.</span><span class="n">new</span><span class="p">(</span><span class="n">key</span><span class="o">.</span><span class="n">encode</span><span class="p">(),</span> <span class="n">data</span><span class="o">.</span><span class="n">encode</span><span class="p">(),</span> <span class="n">hashlib</span><span class="o">.</span><span class="n">sha1</span><span class="p">)</span><span class="o">.</span><span class="n">digest</span><span class="p">()</span>
    <span class="n">b64</span> <span class="o">=</span> <span class="n">b64encode</span><span class="p">(</span><span class="n">digest</span><span class="p">)</span><span class="o">.</span><span class="n">decode</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">_pad_to_24</span><span class="p">(</span><span class="n">b64</span><span class="p">)</span>

<span class="k">def</span><span class="w"> </span><span class="nf">_hmac_md5</span><span class="p">(</span><span class="n">key</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">data</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Compute HMAC-MD5 over `data` using `key`, Base64-encode the result,</span>
<span class="sd">    then truncate/pad to 24 characters.</span>

<span class="sd">    :param key: UTF-8 key string.</span>
<span class="sd">    :param data: UTF-8 data string.</span>
<span class="sd">    :return: 24-character Base64 HMAC-MD5 string.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">digest</span> <span class="o">=</span> <span class="n">hmac</span><span class="o">.</span><span class="n">new</span><span class="p">(</span><span class="n">key</span><span class="o">.</span><span class="n">encode</span><span class="p">(),</span> <span class="n">data</span><span class="o">.</span><span class="n">encode</span><span class="p">(),</span> <span class="n">hashlib</span><span class="o">.</span><span class="n">md5</span><span class="p">)</span><span class="o">.</span><span class="n">digest</span><span class="p">()</span>
    <span class="n">b64</span> <span class="o">=</span> <span class="n">b64encode</span><span class="p">(</span><span class="n">digest</span><span class="p">)</span><span class="o">.</span><span class="n">decode</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">_pad_to_24</span><span class="p">(</span><span class="n">b64</span><span class="p">)</span>

<span class="k">def</span><span class="w"> </span><span class="nf">_des3_decrypt</span><span class="p">(</span><span class="n">data</span><span class="p">:</span> <span class="nb">bytes</span><span class="p">,</span> <span class="n">secret</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bytes</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Decrypt `data` using 3DES (DES-EDE/CBC/PKCS5Padding) with a zero IV.</span>
<span class="sd">    If `secret` is 16 bytes long, its first 8 bytes are appended to make 24.</span>

<span class="sd">    :param data: Ciphertext bytes.</span>
<span class="sd">    :param secret: Key string (will be .encode(&#39;utf-8&#39;)).</span>
<span class="sd">    :return: Plaintext bytes (PKCS#5 padding removed).</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">key_bytes</span> <span class="o">=</span> <span class="n">secret</span><span class="o">.</span><span class="n">encode</span><span class="p">()</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">key_bytes</span><span class="p">)</span> <span class="o">==</span> <span class="mi">16</span><span class="p">:</span>
        <span class="n">key_bytes</span> <span class="o">+=</span> <span class="n">key_bytes</span><span class="p">[:</span><span class="mi">8</span><span class="p">]</span>
    <span class="n">cipher</span> <span class="o">=</span> <span class="n">DES3</span><span class="o">.</span><span class="n">new</span><span class="p">(</span><span class="n">key_bytes</span><span class="p">,</span> <span class="n">DES3</span><span class="o">.</span><span class="n">MODE_CBC</span><span class="p">,</span> <span class="n">iv</span><span class="o">=</span><span class="sa">b</span><span class="s1">&#39;</span><span class="se">\x00</span><span class="s1">&#39;</span> <span class="o">*</span> <span class="mi">8</span><span class="p">)</span>
    <span class="n">decrypted</span> <span class="o">=</span> <span class="n">cipher</span><span class="o">.</span><span class="n">decrypt</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">unpad</span><span class="p">(</span><span class="n">decrypted</span><span class="p">,</span> <span class="n">block_size</span><span class="o">=</span><span class="mi">8</span><span class="p">)</span>

<span class="k">def</span><span class="w"> </span><span class="nf">decrypt_content</span><span class="p">(</span>
    <span class="n">cid</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">data</span><span class="p">:</span> <span class="nb">bytes</span><span class="p">,</span>
    <span class="n">uid</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">imei</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Perform the two-stage DES3 decryption matching the native `b(...)`:</span>

<span class="sd">      1. sec1 = uid + imei + cid + _MAGIC</span>
<span class="sd">      2. sha1_key1 = HMAC-SHA1_Base64(imei, sec1) -&gt; 24 chars</span>
<span class="sd">      3. sec2 = sha1_key1 + imei</span>
<span class="sd">      4. sha1_key2 = HMAC-MD5_Base64(uid, sec2) -&gt; 24 chars</span>
<span class="sd">      5. step1 = DES3_CBC_DECRYPT(data, key=sha1_key2)</span>
<span class="sd">      6. step2 = DES3_CBC_DECRYPT(step1,   key=sha1_key1)</span>
<span class="sd">      7. UTF-8 decode step2 (ignore errors)</span>

<span class="sd">    :param cid: Chapter ID string.</span>
<span class="sd">    :param data: Encrypted bytes to decrypt.</span>
<span class="sd">    :param uid: User ID string.</span>
<span class="sd">    :param imei: Device IMEI string.</span>
<span class="sd">    :return: Decrypted plaintext as a UTF-8 string.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># 1) build the two &quot;sec&quot; buffers and derive two keys</span>
    <span class="n">sec1</span> <span class="o">=</span> <span class="n">uid</span> <span class="o">+</span> <span class="n">imei</span> <span class="o">+</span> <span class="n">cid</span> <span class="o">+</span> <span class="n">_MAGIC</span>
    <span class="n">sha1_key1</span> <span class="o">=</span> <span class="n">_hmac_sha1</span><span class="p">(</span><span class="n">imei</span><span class="p">,</span> <span class="n">sec1</span><span class="p">)</span>
    <span class="n">sec2</span> <span class="o">=</span> <span class="n">sha1_key1</span> <span class="o">+</span> <span class="n">imei</span>
    <span class="n">sha1_key2</span> <span class="o">=</span> <span class="n">_hmac_md5</span><span class="p">(</span><span class="n">uid</span><span class="p">,</span> <span class="n">sec2</span><span class="p">)</span>

    <span class="c1"># 2) two-pass 3DES decryption</span>
    <span class="n">step1</span> <span class="o">=</span> <span class="n">_des3_decrypt</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">sha1_key2</span><span class="p">)</span>
    <span class="n">step2</span> <span class="o">=</span> <span class="n">_des3_decrypt</span><span class="p">(</span><span class="n">step1</span><span class="p">,</span> <span class="n">sha1_key1</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">step2</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="s2">&quot;utf-8&quot;</span><span class="p">,</span> <span class="n">errors</span><span class="o">=</span><span class="s2">&quot;ignore&quot;</span><span class="p">)</span>  <span class="c1"># or &quot;replace&quot;</span>
</code></pre></div>
<h5 id="353-fockutilunlock">3.5.3 <code>fockUtil.unlock</code> 函数<a class="headerlink" href="#353-fockutilunlock" title="Permanent link">&para;</a></h5>
<p>在分析 <code>unlock</code> 函数时, 发现这又是一个 native 函数:</p>
<details>
<summary>`com.yuewen.fock` (点击展开)</summary>

<div class="highlight"><pre><span></span><code><span class="kn">package</span><span class="w"> </span><span class="nn">com.yuewen.fock</span><span class="p">;</span>

<span class="kd">public</span><span class="w"> </span><span class="kd">class</span> <span class="nc">Fock</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kd">static</span><span class="w"> </span><span class="kd">class</span> <span class="nc">FockResult</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="kd">public</span><span class="w"> </span><span class="kd">static</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">STATUS_BAD_DATA</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">-</span><span class="mi">1</span><span class="p">;</span>
<span class="w">        </span><span class="kd">public</span><span class="w"> </span><span class="kd">static</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">STATUS_EMPTY_USER_KEY</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">-</span><span class="mi">3</span><span class="p">;</span>
<span class="w">        </span><span class="kd">public</span><span class="w"> </span><span class="kd">static</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">STATUS_MISSING_KEY_POOL</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">-</span><span class="mi">2</span><span class="p">;</span>
<span class="w">        </span><span class="kd">public</span><span class="w"> </span><span class="kd">static</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">STATUS_SUCCESS</span><span class="p">;</span>
<span class="w">        </span><span class="kd">public</span><span class="w"> </span><span class="kd">final</span><span class="w"> </span><span class="kt">byte</span><span class="o">[]</span><span class="w"> </span><span class="n">data</span><span class="p">;</span>
<span class="w">        </span><span class="kd">public</span><span class="w"> </span><span class="kd">final</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">dataSize</span><span class="p">;</span>
<span class="w">        </span><span class="kd">public</span><span class="w"> </span><span class="kd">final</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">status</span><span class="p">;</span>

<span class="w">        </span><span class="kd">public</span><span class="w"> </span><span class="nf">FockResult</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">i10</span><span class="p">,</span><span class="w"> </span><span class="kt">byte</span><span class="o">[]</span><span class="w"> </span><span class="n">bArr</span><span class="p">,</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">i11</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="k">this</span><span class="p">.</span><span class="na">status</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">i10</span><span class="p">;</span>
<span class="w">            </span><span class="k">this</span><span class="p">.</span><span class="na">data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bArr</span><span class="p">;</span>
<span class="w">            </span><span class="k">this</span><span class="p">.</span><span class="na">dataSize</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">i11</span><span class="p">;</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="kd">static</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">System</span><span class="p">.</span><span class="na">loadLibrary</span><span class="p">(</span><span class="s">&quot;fock&quot;</span><span class="p">);</span>
<span class="w">        </span><span class="n">ignoreBlockPattern</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Pattern</span><span class="p">.</span><span class="na">compile</span><span class="p">(</span><span class="n">ignoreBlockPatternString</span><span class="p">);</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kd">static</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">addKeys</span><span class="p">(</span><span class="n">String</span><span class="w"> </span><span class="n">str</span><span class="p">,</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="n">str2</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="kt">byte</span><span class="o">[]</span><span class="w"> </span><span class="n">bArrDecode</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Base64</span><span class="p">.</span><span class="na">decode</span><span class="p">(</span><span class="n">str</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">);</span>
<span class="w">        </span><span class="n">ReentrantLock</span><span class="w"> </span><span class="n">reentrantLock</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">lock</span><span class="p">;</span>
<span class="w">        </span><span class="n">reentrantLock</span><span class="p">.</span><span class="na">lock</span><span class="p">();</span>
<span class="w">        </span><span class="k">try</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="n">ak</span><span class="p">(</span><span class="n">bArrDecode</span><span class="p">,</span><span class="w"> </span><span class="n">bArrDecode</span><span class="p">.</span><span class="na">length</span><span class="p">,</span><span class="w"> </span><span class="n">str2</span><span class="p">.</span><span class="na">getBytes</span><span class="p">());</span>
<span class="w">            </span><span class="n">reentrantLock</span><span class="p">.</span><span class="na">unlock</span><span class="p">();</span>
<span class="w">        </span><span class="p">}</span><span class="w"> </span><span class="k">catch</span><span class="w"> </span><span class="p">(</span><span class="n">Throwable</span><span class="w"> </span><span class="n">th2</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="n">lock</span><span class="p">.</span><span class="na">unlock</span><span class="p">();</span>
<span class="w">            </span><span class="k">throw</span><span class="w"> </span><span class="n">th2</span><span class="p">;</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="kd">static</span><span class="w"> </span><span class="kd">native</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">ak</span><span class="p">(</span><span class="kt">byte</span><span class="o">[]</span><span class="w"> </span><span class="n">bArr</span><span class="p">,</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">i10</span><span class="p">,</span><span class="w"> </span><span class="kt">byte</span><span class="o">[]</span><span class="w"> </span><span class="n">bArr2</span><span class="p">);</span>

<span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kd">static</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">setup</span><span class="p">(</span><span class="n">String</span><span class="w"> </span><span class="n">str</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">ReentrantLock</span><span class="w"> </span><span class="n">reentrantLock</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">lock</span><span class="p">;</span>
<span class="w">        </span><span class="n">reentrantLock</span><span class="p">.</span><span class="na">lock</span><span class="p">();</span>
<span class="w">        </span><span class="k">try</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="n">it</span><span class="p">(</span><span class="n">str</span><span class="p">.</span><span class="na">getBytes</span><span class="p">(),</span><span class="w"> </span><span class="n">str</span><span class="p">.</span><span class="na">length</span><span class="p">());</span>
<span class="w">            </span><span class="n">reentrantLock</span><span class="p">.</span><span class="na">unlock</span><span class="p">();</span>
<span class="w">        </span><span class="p">}</span><span class="w"> </span><span class="k">catch</span><span class="w"> </span><span class="p">(</span><span class="n">Throwable</span><span class="w"> </span><span class="n">th2</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="n">lock</span><span class="p">.</span><span class="na">unlock</span><span class="p">();</span>
<span class="w">            </span><span class="k">throw</span><span class="w"> </span><span class="n">th2</span><span class="p">;</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="kd">static</span><span class="w"> </span><span class="kd">native</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="nf">it</span><span class="p">(</span><span class="kt">byte</span><span class="o">[]</span><span class="w"> </span><span class="n">bArr</span><span class="p">,</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">i10</span><span class="p">);</span>

<span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kd">static</span><span class="w"> </span><span class="n">FockResult</span><span class="w"> </span><span class="nf">unlock</span><span class="p">(</span><span class="n">String</span><span class="w"> </span><span class="n">str</span><span class="p">,</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="n">str2</span><span class="p">,</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="n">str3</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="kt">byte</span><span class="o">[]</span><span class="w"> </span><span class="n">bArrDecode</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Base64</span><span class="p">.</span><span class="na">decode</span><span class="p">(</span><span class="n">str</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">);</span>
<span class="w">        </span><span class="n">ReentrantLock</span><span class="w"> </span><span class="n">reentrantLock</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">lock</span><span class="p">;</span>
<span class="w">        </span><span class="n">reentrantLock</span><span class="p">.</span><span class="na">lock</span><span class="p">();</span>
<span class="w">        </span><span class="k">try</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="n">FockResult</span><span class="w"> </span><span class="n">fockResultUksf</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">uksf</span><span class="p">(</span><span class="n">bArrDecode</span><span class="p">,</span><span class="w"> </span><span class="n">bArrDecode</span><span class="p">.</span><span class="na">length</span><span class="p">,</span><span class="w"> </span><span class="n">str2</span><span class="p">.</span><span class="na">getBytes</span><span class="p">(),</span><span class="w"> </span><span class="n">str2</span><span class="p">.</span><span class="na">length</span><span class="p">(),</span><span class="w"> </span><span class="n">str3</span><span class="p">.</span><span class="na">getBytes</span><span class="p">());</span>
<span class="w">            </span><span class="n">reentrantLock</span><span class="p">.</span><span class="na">unlock</span><span class="p">();</span>
<span class="w">            </span><span class="k">return</span><span class="w"> </span><span class="n">fockResultUksf</span><span class="p">;</span>
<span class="w">        </span><span class="p">}</span><span class="w"> </span><span class="k">catch</span><span class="w"> </span><span class="p">(</span><span class="n">Throwable</span><span class="w"> </span><span class="n">th2</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="n">lock</span><span class="p">.</span><span class="na">unlock</span><span class="p">();</span>
<span class="w">            </span><span class="k">throw</span><span class="w"> </span><span class="n">th2</span><span class="p">;</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="kd">static</span><span class="w"> </span><span class="kd">native</span><span class="w"> </span><span class="n">FockResult</span><span class="w"> </span><span class="nf">uksf</span><span class="p">(</span><span class="kt">byte</span><span class="o">[]</span><span class="w"> </span><span class="n">bArr</span><span class="p">,</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">i10</span><span class="p">,</span><span class="w"> </span><span class="kt">byte</span><span class="o">[]</span><span class="w"> </span><span class="n">bArr2</span><span class="p">,</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">i11</span><span class="p">,</span><span class="w"> </span><span class="kt">byte</span><span class="o">[]</span><span class="w"> </span><span class="n">bArr3</span><span class="p">);</span>
<span class="p">}</span>
</code></pre></div>
</details>

<hr />
<p>方案 1. 使用 <code>Frida</code> 对相关方法进行 Hook</p>
<blockquote>
<p>说明: 此处演示的 Hook 方法为了方便展示, 假设目标类已在运行时加载完毕。</p>
<p>如果实际使用, 请确保 App 已进入能触发 Fock 等类初始化的页面, 例如打开任意 VIP 章节, 以确保目标类和方法 (如 <code>Fock</code> 等) 已加载并初始化, 否则 Hook 将无法生效。</p>
</blockquote>
<details>
<summary>`hook_fock.js` (点击展开)</summary>

<div class="highlight"><pre><span></span><code><span class="nx">rpc</span><span class="p">.</span><span class="nx">exports</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">unlock</span><span class="o">:</span><span class="w"> </span><span class="kd">function</span><span class="w"> </span><span class="p">(</span><span class="nx">arg1</span><span class="p">,</span><span class="w"> </span><span class="nx">arg2</span><span class="p">,</span><span class="w"> </span><span class="nx">arg3</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="nb">Promise</span><span class="p">(</span><span class="kd">function</span><span class="w"> </span><span class="p">(</span><span class="nx">resolve</span><span class="p">,</span><span class="w"> </span><span class="nx">reject</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="nx">Java</span><span class="p">.</span><span class="nx">perform</span><span class="p">(</span><span class="kd">function</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">                </span><span class="k">try</span><span class="w"> </span><span class="p">{</span>
<span class="w">                    </span><span class="kd">var</span><span class="w"> </span><span class="nx">TargetClass</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">Java</span><span class="p">.</span><span class="nx">use</span><span class="p">(</span><span class="s1">&#39;com.yuewen.fock.Fock&#39;</span><span class="p">);</span>
<span class="w">                    </span><span class="kd">var</span><span class="w"> </span><span class="nx">StringClass</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">Java</span><span class="p">.</span><span class="nx">use</span><span class="p">(</span><span class="s1">&#39;java.lang.String&#39;</span><span class="p">);</span>
<span class="w">                    </span><span class="kd">var</span><span class="w"> </span><span class="nx">CharsetClass</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">Java</span><span class="p">.</span><span class="nx">use</span><span class="p">(</span><span class="s1">&#39;java.nio.charset.Charset&#39;</span><span class="p">);</span>

<span class="w">                    </span><span class="kd">var</span><span class="w"> </span><span class="nx">result</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">TargetClass</span><span class="p">.</span><span class="nx">unlock</span><span class="p">(</span><span class="nx">arg1</span><span class="p">,</span><span class="w"> </span><span class="nx">arg2</span><span class="p">,</span><span class="w"> </span><span class="nx">arg3</span><span class="p">);</span>
<span class="w">                    </span><span class="kd">var</span><span class="w"> </span><span class="nx">status</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">result</span><span class="p">.</span><span class="nx">status</span><span class="p">.</span><span class="nx">value</span><span class="p">;</span>

<span class="w">                    </span><span class="kd">var</span><span class="w"> </span><span class="nx">utf8Charset</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">CharsetClass</span><span class="p">.</span><span class="nx">forName</span><span class="p">(</span><span class="s2">&quot;UTF-8&quot;</span><span class="p">);</span>
<span class="w">                    </span><span class="kd">var</span><span class="w"> </span><span class="nx">javaStr</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">StringClass</span><span class="p">.</span><span class="nx">$new</span><span class="p">(</span><span class="nx">result</span><span class="p">.</span><span class="nx">data</span><span class="p">.</span><span class="nx">value</span><span class="p">,</span><span class="w"> </span><span class="nx">utf8Charset</span><span class="p">);</span>
<span class="w">                    </span><span class="kd">var</span><span class="w"> </span><span class="nx">contentStr</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">javaStr</span><span class="p">.</span><span class="nx">toString</span><span class="p">();</span>

<span class="w">                    </span><span class="nx">resolve</span><span class="p">({</span>
<span class="w">                        </span><span class="nx">status</span><span class="o">:</span><span class="w"> </span><span class="nx">status</span><span class="p">,</span>
<span class="w">                        </span><span class="nx">content</span><span class="o">:</span><span class="w"> </span><span class="nx">contentStr</span>
<span class="w">                    </span><span class="p">});</span>
<span class="w">                </span><span class="p">}</span><span class="w"> </span><span class="k">catch</span><span class="w"> </span><span class="p">(</span><span class="nx">e</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">                    </span><span class="nx">resolve</span><span class="p">({</span>
<span class="w">                        </span><span class="nx">status</span><span class="o">:</span><span class="w"> </span><span class="o">-</span><span class="mf">999</span><span class="p">,</span>
<span class="w">                        </span><span class="nx">error</span><span class="o">:</span><span class="w"> </span><span class="nx">e</span><span class="p">.</span><span class="nx">toString</span><span class="p">()</span>
<span class="w">                    </span><span class="p">});</span>
<span class="w">                </span><span class="p">}</span>
<span class="w">            </span><span class="p">});</span>
<span class="w">        </span><span class="p">});</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">};</span>
</code></pre></div>
</details>

<p>至此即可在 Python 端通过 <code>Frida RPC</code> 同步调用 <code>unlock</code> 方法, 示例如下</p>
<div class="highlight"><pre><span></span><code><span class="kn">import</span><span class="w"> </span><span class="nn">frida</span>

<span class="k">def</span><span class="w"> </span><span class="nf">test</span><span class="p">():</span>
    <span class="n">book_id</span> <span class="o">=</span> <span class="s2">&quot;1111111111&quot;</span>
    <span class="n">chap_id</span> <span class="o">=</span> <span class="s2">&quot;2222222222&quot;</span>
    <span class="n">content</span> <span class="o">=</span> <span class="s2">&quot;xxx...&quot;</span> <span class="c1"># 需解密的加密内容</span>

    <span class="n">device</span> <span class="o">=</span> <span class="n">frida</span><span class="o">.</span><span class="n">get_device</span><span class="p">(</span><span class="s2">&quot;your.device.ip.address&quot;</span><span class="p">)</span>
    <span class="c1"># 也可使用 frida.get_usb_device()</span>
    <span class="n">session</span> <span class="o">=</span> <span class="n">device</span><span class="o">.</span><span class="n">attach</span><span class="p">(</span><span class="s2">&quot;起点读书&quot;</span><span class="p">)</span>

    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s2">&quot;hook_fock.js&quot;</span><span class="p">,</span> <span class="s2">&quot;r&quot;</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s2">&quot;utf-8&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
        <span class="n">jscode</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>

    <span class="n">script</span> <span class="o">=</span> <span class="n">session</span><span class="o">.</span><span class="n">create_script</span><span class="p">(</span><span class="n">jscode</span><span class="p">)</span>
    <span class="n">script</span><span class="o">.</span><span class="n">load</span><span class="p">()</span>

    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;[*] Script loaded. Starting unlock tasks...&quot;</span><span class="p">)</span>
    <span class="n">key_1</span> <span class="o">=</span> <span class="n">chap_id</span>
    <span class="n">key_2</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">book_id</span><span class="si">}</span><span class="s2">_</span><span class="si">{</span><span class="n">chap_id</span><span class="si">}</span><span class="s2">&quot;</span>
    <span class="c1"># 同步调用 Frida RPC</span>
    <span class="n">raw</span> <span class="o">=</span> <span class="n">script</span><span class="o">.</span><span class="n">exports_sync</span><span class="o">.</span><span class="n">unlock</span><span class="p">(</span><span class="n">content</span><span class="p">,</span> <span class="n">key_1</span><span class="p">,</span> <span class="n">key_2</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">raw</span><span class="p">)</span>

<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>
    <span class="n">test</span><span class="p">()</span>
</code></pre></div>
<hr />
<p>方案 2. 逆向并实现</p>
<p>TODO: 暂未完成</p>







  
  






                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg>
  Back to top
</button>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      
      <script id="__config" type="application/json">{"annotate": null, "base": "../..", "features": ["navigation.tabs", "navigation.top", "navigation.sections", "navigation.indexes", "search.highlight", "search.suggest", "content.code.copy", "content.action.edit", "toc.follow"], "search": "../../assets/javascripts/workers/search.7a47a382.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
    
    
      <script src="../../assets/javascripts/bundle.e71a0d61.min.js"></script>
      
        <script src="../../javascripts/mathjax.js"></script>
      
        <script src="https://unpkg.com/mathjax@3/es5/tex-mml-chtml.js"></script>
      
    
  </body>
</html>